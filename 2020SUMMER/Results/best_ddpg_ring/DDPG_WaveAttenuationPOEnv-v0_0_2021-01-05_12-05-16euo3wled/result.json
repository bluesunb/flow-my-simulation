{"episode_reward_max": -3839.1905239557054, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": -3839.1905239557054, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3839.1905239557054], "episode_lengths": [3000]}, "sampler_perf": {"mean_env_wait_ms": 5.014394053376861, "mean_processing_ms": 1.1732192962656653, "mean_inference_ms": 0.365477806327741}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 3000, "timers": {"learn_time_ms": 34.63, "learn_throughput": 1848.131, "update_time_ms": 1.084}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": 0.015002516098320484, "critic_loss": 1.397159218788147, "mean_q": -0.00484562199562788, "max_q": 0.09865818917751312, "min_q": -0.13164784014225006, "mean_td_error": 1.2548887729644775, "td_error": "[ 1.9529063   2.3166492   1.1870445   0.9479951   2.1844714   0.7465266\n  2.538832    1.142467    1.8209428  -0.14950931  0.18835236  2.514436\n  0.32497138 -0.20181213 -0.47058132  0.7915955  -0.8315632   2.6060956\n  0.07095356  1.9015816   0.9900802   0.7782785   1.8541508  -0.4939471\n -0.11169182  2.4187493   3.1939168   1.7751719   1.1453587   2.6080391\n  0.825356    1.6310854  -0.43816674  2.1058068   2.471455    2.4498708\n  0.2627191   2.880763    0.7845147   3.182773    2.6262147   2.9447522\n  0.46621162  2.0610628   3.1757514   0.6286421   0.80413306  0.19609053\n -0.42613044  0.34535357  1.4968845   1.7288823   0.09596594  0.2429885\n  1.4698198   1.5610167   1.347788    1.376222    0.8940903  -0.7100265\n  2.456188    0.58107275  2.7992136   0.2540555 ]"}}, "num_steps_sampled": 3000, "num_steps_trained": 64, "last_target_update_ts": 3000, "num_target_updates": 1}, "done": false, "episodes_total": 1, "training_iteration": 1, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-05-44", "timestamp": 1609815944, "time_this_iter_s": 25.108254432678223, "time_total_s": 25.108254432678223, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f598>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 25.108254432678223, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 8.447222222222223, "ram_util_percent": 27.874999999999996}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 1715.5862666758464, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": -1061.8021286399294, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1715.5862666758464, -3839.1905239557054], "episode_lengths": [3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.229433028762019, "mean_processing_ms": 1.2051031395549674, "mean_inference_ms": 0.43535290301104357}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 6000, "timers": {"learn_time_ms": 3.88, "learn_throughput": 16495.554, "update_time_ms": 0.761}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -1.562705636024475, "critic_loss": 0.0012724380940198898, "mean_q": 0.6110835671424866, "max_q": 1.7139321565628052, "min_q": -2.518589973449707, "mean_td_error": -0.015443967655301094, "td_error": "[ 0.01214159 -0.07812452  0.02039647  0.02484477  0.04511726 -0.01045322\n -0.18112688  0.03330803  0.01184523  0.12359118  0.03172863 -0.0550496\n  0.01603436 -0.04242802  0.01735568 -0.03027348  0.00157785 -0.01104152\n  0.02304316 -0.00385225  0.04141319 -0.03004009  0.02162921 -0.06673509\n -0.09956056 -0.05042982 -0.01225238  0.00291896 -0.0298717  -0.01492\n -0.01104152 -0.03363609 -0.03241456 -0.03725767 -0.03009212  0.02397203\n  0.00672698 -0.05630827  0.00152159 -0.03711855  0.0571292  -0.05575645\n  0.022663   -0.05900741  0.00536132  0.00583804 -0.00121105  0.02126443\n -0.01019561  0.02220333  0.04437137 -0.07922161 -0.11404502  0.00551856\n -0.04677927  0.02355194 -0.02055237 -0.0314573  -0.05453551 -0.12369528\n -0.00384295 -0.03590029 -0.02860022 -0.03665301]"}}, "num_steps_sampled": 6000, "num_steps_trained": 192064, "last_target_update_ts": 6000, "num_target_updates": 3001}, "done": false, "episodes_total": 2, "training_iteration": 2, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-06-34", "timestamp": 1609815994, "time_this_iter_s": 50.43580174446106, "time_total_s": 75.54405617713928, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f048>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 75.54405617713928, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 8.761111111111111, "ram_util_percent": 27.912500000000005}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 1715.5862666758464, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": -232.66759079895664, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1425.6014848829889, -3839.1905239557054, 1715.5862666758464], "episode_lengths": [3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.3455618804811875, "mean_processing_ms": 1.2262374121705877, "mean_inference_ms": 0.47753514031474253}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 9000, "timers": {"learn_time_ms": 4.055, "learn_throughput": 15784.657, "update_time_ms": 0.75}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -3.361133337020874, "critic_loss": 0.000803545059170574, "mean_q": 2.9675662517547607, "max_q": 3.837614059448242, "min_q": -0.42669031023979187, "mean_td_error": -0.013078125193715096, "td_error": "[ 0.0040586  -0.00482798 -0.01693344 -0.01553613 -0.01035738  0.03139043\n -0.02554202 -0.01239991  0.00284624  0.02715874 -0.00043631 -0.09108663\n  0.03861189 -0.05511522  0.01130867  0.03526545  0.0104301  -0.08171582\n  0.01383042 -0.04343462 -0.05915233 -0.0488503   0.04806399 -0.03085613\n  0.04046178 -0.04186702 -0.03395581  0.02151871  0.03016973 -0.02556467\n -0.0212326  -0.02587509  0.00333571  0.01314783  0.00738502 -0.06621468\n -0.01440978  0.01021624 -0.03407693  0.06023812  0.01613879  0.02402949\n -0.03172612 -0.11982167  0.01504254 -0.06720734 -0.00834942 -0.00717998\n  0.00754523 -0.01686859 -0.05313301 -0.02998853 -0.01031685 -0.0480051\n -0.06657839  0.01955715  0.01644301 -0.0909664  -0.00423455 -0.03746319\n  0.01372242 -0.008847   -0.00992417  0.01113486]"}}, "num_steps_sampled": 9000, "num_steps_trained": 384064, "last_target_update_ts": 9000, "num_target_updates": 6001}, "done": false, "episodes_total": 3, "training_iteration": 3, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-07-26", "timestamp": 1609816046, "time_this_iter_s": 51.64256834983826, "time_total_s": 127.18662452697754, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fd90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 127.18662452697754, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 8.185135135135134, "ram_util_percent": 27.924324324324324}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 1715.5862666758464, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 106.90438619123017, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1125.6203171617908, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889], "episode_lengths": [3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.423859329357752, "mean_processing_ms": 1.2393742589612993, "mean_inference_ms": 0.5065401803378561}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 12000, "timers": {"learn_time_ms": 3.369, "learn_throughput": 18998.228, "update_time_ms": 0.662}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -4.9342522621154785, "critic_loss": 0.0007149808225221932, "mean_q": 4.091765880584717, "max_q": 5.901894569396973, "min_q": 0.2663677930831909, "mean_td_error": 0.007110791280865669, "td_error": "[ 0.03609276 -0.04100895  0.0505228   0.04329228 -0.03780222  0.02136278\n  0.03952169 -0.00493479 -0.03000152 -0.00341988 -0.01825666 -0.08716297\n -0.05794621  0.0038408   0.0241189  -0.08716297  0.02779055  0.05293322\n  0.01553583  0.07024956 -0.03725326  0.05116308 -0.03502131 -0.04117179\n -0.0229845   0.01563406  0.04904699 -0.02577317  0.04187727 -0.00526619\n  0.00579309 -0.04650354  0.01361227 -0.01830387  0.0575037   0.01107502\n  0.00973892  0.01226234 -0.02522993  0.03702116  0.02734947  0.01320481\n  0.0100193  -0.00088453  0.00734997  0.00840664  0.05200911  0.04610586\n  0.02220523  0.0924964   0.03312683  0.00365543  0.01744008  0.00373554\n -0.00989032  0.0348773   0.03337812  0.00729823 -0.00351846 -0.00943041\n -0.00401211 -0.02069092 -0.02182555  0.04789925]"}}, "num_steps_sampled": 12000, "num_steps_trained": 576064, "last_target_update_ts": 12000, "num_target_updates": 9001}, "done": false, "episodes_total": 4, "training_iteration": 4, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-08-18", "timestamp": 1609816098, "time_this_iter_s": 52.2785484790802, "time_total_s": 179.46517300605774, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f7b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 179.46517300605774, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 9.213333333333335, "ram_util_percent": 28.0}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 1715.5862666758464, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 309.3636320179897, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1119.2006153250275, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908], "episode_lengths": [3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.483651484128641, "mean_processing_ms": 1.248846253576178, "mean_inference_ms": 0.5277326941502115}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 15000, "timers": {"learn_time_ms": 3.457, "learn_throughput": 18511.13, "update_time_ms": 0.649}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -6.841086387634277, "critic_loss": 0.00045307475375011563, "mean_q": 6.428011894226074, "max_q": 7.979918956756592, "min_q": 2.203876495361328, "mean_td_error": 0.006676290184259415, "td_error": "[-0.01263762 -0.01453352  0.03964186 -0.02259779  0.0252614   0.01005697\n -0.03002882 -0.00714016 -0.01059532 -0.01012707  0.03332281 -0.01838255\n  0.03941393  0.0529418   0.01933384  0.04012537  0.00185966 -0.00801706\n  0.02272224  0.0219779   0.00203085 -0.02759886 -0.00858259  0.04095888\n -0.00529218  0.03482771  0.04828978  0.03984308  0.02273607 -0.01768255\n  0.02891159  0.01208544  0.02047396 -0.00955391  0.01792431  0.05177879\n  0.02763176 -0.01632881 -0.00862694  0.00173235 -0.00673485  0.01759887\n  0.0325737   0.05147123 -0.03263426  0.01499701 -0.00457907 -0.01517773\n  0.02242184 -0.02692461  0.03131485 -0.03520966 -0.00902748  0.02198458\n -0.04125571 -0.0250721  -0.000453   -0.02006531 -0.06780958  0.03490019\n -0.01827049  0.00058985  0.024858    0.04962969]"}}, "num_steps_sampled": 15000, "num_steps_trained": 768064, "last_target_update_ts": 15000, "num_target_updates": 12001}, "done": false, "episodes_total": 5, "training_iteration": 5, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-09-11", "timestamp": 1609816151, "time_this_iter_s": 52.808308601379395, "time_total_s": 232.27348160743713, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5852f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 232.27348160743713, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 9.377333333333333, "ram_util_percent": 28.02666666666666}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 1715.5862666758464, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 510.24216946071675, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1514.6348566743522, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.531811561439697, "mean_processing_ms": 1.2561209338554669, "mean_inference_ms": 0.5442384297067694}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 18000, "timers": {"learn_time_ms": 3.6, "learn_throughput": 17779.066, "update_time_ms": 0.657}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -8.106689453125, "critic_loss": 0.0006483725155703723, "mean_q": 7.520459175109863, "max_q": 9.962035179138184, "min_q": 2.827314853668213, "mean_td_error": 0.001357194036245346, "td_error": "[-0.02186871 -0.01984787 -0.00919247  0.00592184  0.00900555 -0.04016781\n -0.01445961 -0.01643276  0.01410198  0.02651262 -0.01514721  0.03198385\n  0.04465866  0.03932428  0.02003384 -0.01428413 -0.00187588 -0.07361698\n  0.01670647 -0.0296793   0.05654716 -0.06183815 -0.03516293 -0.03253078\n -0.00924206  0.01804352  0.00518751  0.03189564 -0.01221657  0.04243922\n  0.04351807 -0.00766039 -0.01319504 -0.05449009  0.01711082  0.01647949\n  0.00878429  0.00845623  0.04559231  0.01557875 -0.09376431  0.05674648\n  0.00509548  0.01093006  0.02550888 -0.00675106 -0.03224945  0.0103941\n  0.03078365 -0.03652    -0.02579403  0.1003437   0.00607204  0.04307747\n -0.01417637  0.01037598 -0.06714725  0.0100975  -0.02116871  0.04046869\n -0.00618267  0.00535583  0.01357555 -0.01318455]"}}, "num_steps_sampled": 18000, "num_steps_trained": 960064, "last_target_update_ts": 18000, "num_target_updates": 15001}, "done": false, "episodes_total": 6, "training_iteration": 6, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-10-04", "timestamp": 1609816204, "time_this_iter_s": 53.163893699645996, "time_total_s": 285.43737530708313, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5856a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 285.43737530708313, "timesteps_since_restore": 0, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 9.552631578947368, "ram_util_percent": 28.263157894736842}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 1715.5862666758464, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 554.1363947959386, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [817.5017468072697, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.567589991311392, "mean_processing_ms": 1.2623227381993993, "mean_inference_ms": 0.5573413515608165}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 21000, "timers": {"learn_time_ms": 3.707, "learn_throughput": 17265.284, "update_time_ms": 0.634}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -9.971839904785156, "critic_loss": 0.001086399075575173, "mean_q": 9.481156349182129, "max_q": 12.017183303833008, "min_q": 4.656171798706055, "mean_td_error": -0.00792432576417923, "td_error": "[ 0.01439667 -0.02803993  0.11930561 -0.00515079 -0.00630331  0.0125103\n -0.03959846 -0.00280905 -0.05099297  0.06915283 -0.03791046 -0.01788712\n -0.05722523  0.01465797 -0.03221893 -0.01611423  0.0016222  -0.04465389\n -0.02756119 -0.04763317  0.00116253 -0.04624367  0.04187202 -0.05301285\n  0.0386405  -0.03934956  0.11343145  0.062006    0.02100658 -0.01887226\n -0.05019093  0.04165936 -0.01398277  0.04261494  0.00120354 -0.01124334\n -0.02216148 -0.0858078  -0.00566578 -0.03113604  0.01615334 -0.01024532\n -0.01566792 -0.01534653 -0.01421213  0.15283585 -0.03901768  0.00813961\n  0.03970957 -0.04656219 -0.03132248 -0.06079483 -0.03468037 -0.0896883\n -0.02314472 -0.04669809 -0.0315733  -0.01935339  0.00558472 -0.01688766\n  0.02368307 -0.03332901 -0.0174284  -0.01078796]"}}, "num_steps_sampled": 21000, "num_steps_trained": 1152064, "last_target_update_ts": 21000, "num_target_updates": 18001}, "done": false, "episodes_total": 7, "training_iteration": 7, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-10-56", "timestamp": 1609816256, "time_this_iter_s": 52.10553455352783, "time_total_s": 337.54290986061096, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc585ae8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 337.54290986061096, "timesteps_since_restore": 0, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 10.889189189189189, "ram_util_percent": 28.5}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 1715.5862666758464, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 643.7129721921599, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1270.749013965709, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.59595766550296, "mean_processing_ms": 1.267461178349363, "mean_inference_ms": 0.5678499910309378}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 24000, "timers": {"learn_time_ms": 3.556, "learn_throughput": 17997.684, "update_time_ms": 0.677}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -11.229737281799316, "critic_loss": 0.003326048841699958, "mean_q": 10.876845359802246, "max_q": 13.604575157165527, "min_q": 5.204761505126953, "mean_td_error": -0.06933780759572983, "td_error": "[-0.02375031 -0.09072685 -0.08716488 -0.0867939  -0.06339455 -0.10500145\n -0.08222246 -0.10746574 -0.09195709 -0.05894566  0.00729561 -0.07871914\n  0.00185204  0.02266026 -0.14870739 -0.07500601 -0.02742577 -0.06793213\n -0.06741714  0.0184927  -0.04783726 -0.08104134 -0.03838444 -0.09346867\n -0.08067989 -0.12129354 -0.09134674 -0.12573814 -0.11076641  0.0078125\n -0.08493567 -0.09645653 -0.10607624 -0.12504101  0.02804756 -0.10318947\n -0.05128288 -0.03740883 -0.07041645 -0.08043289 -0.07892799 -0.08125401\n -0.10900402 -0.07834148 -0.0335598  -0.09317017 -0.08508301 -0.0750227\n -0.08966732 -0.07239103  0.00778866 -0.11296082  0.00771999 -0.11900234\n -0.06226063 -0.10263252 -0.08535671 -0.06453609 -0.08945465 -0.09052467\n -0.05438805 -0.00761032 -0.02798843 -0.11772537]"}}, "num_steps_sampled": 24000, "num_steps_trained": 1344064, "last_target_update_ts": 24000, "num_target_updates": 21001}, "done": false, "episodes_total": 8, "training_iteration": 8, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-11-49", "timestamp": 1609816309, "time_this_iter_s": 52.18177652359009, "time_total_s": 389.72468638420105, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc599048>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 389.72468638420105, "timesteps_since_restore": 0, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 9.310666666666668, "ram_util_percent": 28.377333333333322}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 1788.2859632752227, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 770.8877489791669, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1788.2859632752227, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.621153873378182, "mean_processing_ms": 1.2718431138719541, "mean_inference_ms": 0.5764966035012076}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 27000, "timers": {"learn_time_ms": 3.582, "learn_throughput": 17869.251, "update_time_ms": 0.67}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -13.172329902648926, "critic_loss": 0.0008301468333229423, "mean_q": 12.821280479431152, "max_q": 15.965577125549316, "min_q": 6.872668266296387, "mean_td_error": -0.0006270334124565125, "td_error": "[-0.08173943  0.00472832  0.07770824 -0.01387215  0.00192738  0.01838303\n -0.0257988   0.02401638  0.06066895 -0.02967453 -0.03178501  0.02337265\n -0.08061886 -0.00945377  0.01211739 -0.01347733 -0.01031971 -0.03291607\n  0.06633568 -0.03234005 -0.03668404  0.02684879 -0.02724743  0.0155077\n  0.05540657 -0.03403139 -0.0256052   0.03632545 -0.02136707 -0.03458977\n  0.00641155  0.02137852 -0.00153923 -0.00287914  0.01119423  0.01623297\n -0.00566387 -0.05003548 -0.00582218  0.01246357 -0.0534277   0.08156729\n -0.06706715  0.09611797  0.07021141 -0.04736423  0.00371361 -0.01834869\n -0.00375462 -0.01745605  0.04237175 -0.00691795 -0.0120697  -0.08487606\n  0.0368042  -0.01795292 -0.00495052 -0.01796246  0.02933025  0.03342342\n  0.00454998 -0.00904942  0.00327396  0.03613663]"}}, "num_steps_sampled": 27000, "num_steps_trained": 1536064, "last_target_update_ts": 27000, "num_target_updates": 24001}, "done": false, "episodes_total": 9, "training_iteration": 9, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-12-41", "timestamp": 1609816361, "time_this_iter_s": 52.841490030288696, "time_total_s": 442.56617641448975, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc599400>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 442.56617641448975, "timesteps_since_restore": 0, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 8.999999999999998, "ram_util_percent": 28.20266666666666}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 1788.2859632752227, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 774.5584375128019, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [807.5946343155173, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.640629238892954, "mean_processing_ms": 1.2753449509896881, "mean_inference_ms": 0.5835463977035701}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 30000, "timers": {"learn_time_ms": 3.994, "learn_throughput": 16025.136, "update_time_ms": 0.722}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -14.558589935302734, "critic_loss": 0.0010523556265980005, "mean_q": 14.199660301208496, "max_q": 18.121681213378906, "min_q": 6.72075891494751, "mean_td_error": -0.0046705156564712524, "td_error": "[ 0.06012249  0.01463127  0.02079773  0.07192802  0.05726433 -0.05075073\n -0.00042629 -0.01859474 -0.06839752  0.0302887  -0.00108337 -0.05347633\n  0.05758381  0.00996208  0.01132393  0.04779148 -0.00244331 -0.00869656\n -0.09376431 -0.0046711  -0.02338028 -0.00749588 -0.02610302 -0.0555439\n  0.08014154  0.0828166  -0.03525448  0.00871944 -0.01388931  0.00425911\n  0.08336258 -0.08127975 -0.03702545  0.08843327 -0.02217865  0.05819416\n  0.07642651 -0.05009079 -0.03145027 -0.01832771 -0.02827644 -0.03766918\n -0.01988411 -0.03070068 -0.05234909 -0.03442001  0.01755619 -0.02035713\n -0.05439758  0.01142693 -0.04407406 -0.00492573  0.00732231  0.03754234\n -0.03722858 -0.00710392 -0.05106449 -0.04508877  0.01156235 -0.00647449\n  0.04436398 -0.03690624 -0.05514908 -0.02234077]"}}, "num_steps_sampled": 30000, "num_steps_trained": 1728064, "last_target_update_ts": 30000, "num_target_updates": 27001}, "done": false, "episodes_total": 10, "training_iteration": 10, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-13-33", "timestamp": 1609816413, "time_this_iter_s": 51.28564739227295, "time_total_s": 493.8518238067627, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc599840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 493.8518238067627, "timesteps_since_restore": 0, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 8.126027397260275, "ram_util_percent": 28.232876712328775}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 1788.2859632752227, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 834.5342486588349, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1434.2923601191646, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.65691146601355, "mean_processing_ms": 1.2781402345681272, "mean_inference_ms": 0.5894488321721213}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 33000, "timers": {"learn_time_ms": 4.049, "learn_throughput": 15806.965, "update_time_ms": 0.691}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -16.435548782348633, "critic_loss": 0.001010873238556087, "mean_q": 15.974855422973633, "max_q": 19.672298431396484, "min_q": 7.596856117248535, "mean_td_error": -0.01767779141664505, "td_error": "[ 0.01126862 -0.06323051  0.01356506 -0.02455902 -0.0181427  -0.05754662\n -0.09514809  0.01078224 -0.05681229  0.02076817 -0.00690079  0.03748894\n -0.03994942 -0.03613472 -0.03952217 -0.02841377  0.03757286 -0.01407242\n  0.00037003  0.04709768 -0.02974796 -0.02491951 -0.02496433  0.01934147\n  0.00708771 -0.00596046  0.00020981  0.00357056 -0.03708076 -0.09548473\n -0.02867889  0.07939434 -0.01321411 -0.00726318 -0.01673794 -0.13742447\n -0.0778513  -0.03319168 -0.01587296 -0.01204205  0.00627708 -0.01821423\n -0.06479645  0.00179482 -0.05471992 -0.00302315 -0.00698757 -0.02015495\n -0.05559158  0.04139042 -0.04965115  0.01441574  0.01040363 -0.08808899\n -0.00674629 -0.03444004  0.02859783  0.0248909  -0.05325699  0.05089092\n -0.02616119  0.00602531 -0.0680666  -0.01381683]"}}, "num_steps_sampled": 33000, "num_steps_trained": 1920064, "last_target_update_ts": 33000, "num_target_updates": 30001}, "done": false, "episodes_total": 11, "training_iteration": 11, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-14-24", "timestamp": 1609816464, "time_this_iter_s": 51.5279746055603, "time_total_s": 545.379798412323, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc585d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 545.379798412323, "timesteps_since_restore": 0, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 8.100000000000001, "ram_util_percent": 28.23108108108108}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 1788.2859632752227, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 900.1869925981678, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1622.3671759308284, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.670812509011131, "mean_processing_ms": 1.2803444899441299, "mean_inference_ms": 0.5944589100273526}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 36000, "timers": {"learn_time_ms": 3.933, "learn_throughput": 16271.971, "update_time_ms": 0.727}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -17.73283576965332, "critic_loss": 0.0015147060621529818, "mean_q": 17.226577758789062, "max_q": 21.377830505371094, "min_q": 9.372702598571777, "mean_td_error": -0.028418824076652527, "td_error": "[-0.04138851 -0.01812172 -0.01774883 -0.01654243  0.01697159 -0.00569725\n -0.0537796  -0.00719261 -0.02590561 -0.0125761   0.02023315 -0.10704803\n -0.02311325 -0.05179787 -0.09081173 -0.05442047 -0.10035896 -0.11240005\n  0.01047516  0.04871368 -0.03198051 -0.02191162 -0.04158401 -0.01995468\n -0.01836681 -0.03326797 -0.03936958  0.00336266 -0.08010292 -0.05716896\n -0.01275253 -0.03625107 -0.09475136 -0.02388191  0.02026367  0.05796051\n  0.02992439 -0.00579643 -0.02046204 -0.09244728  0.05706501 -0.02009964\n -0.09415054  0.02495003  0.01115227 -0.09357929 -0.05629158  0.04127312\n -0.00933075  0.03973961  0.00464821 -0.14878654  0.03969574 -0.05985641\n -0.02667999 -0.0676651  -0.07336998 -0.02122879 -0.02266884 -0.00407982\n -0.09305477 -0.0124979  -0.00776672 -0.0651741 ]"}}, "num_steps_sampled": 36000, "num_steps_trained": 2112064, "last_target_update_ts": 36000, "num_target_updates": 33001}, "done": false, "episodes_total": 12, "training_iteration": 12, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-15-16", "timestamp": 1609816516, "time_this_iter_s": 51.838613510131836, "time_total_s": 597.2184119224548, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc585268>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 597.2184119224548, "timesteps_since_restore": 0, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 7.883783783783784, "ram_util_percent": 28.30000000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2131.3394730921996, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 994.8910295592473, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2131.3394730921996, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.684191648965908, "mean_processing_ms": 1.2824207165375003, "mean_inference_ms": 0.5989441236267097}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 39000, "timers": {"learn_time_ms": 3.786, "learn_throughput": 16904.741, "update_time_ms": 0.727}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -19.40582275390625, "critic_loss": 0.0011440059170126915, "mean_q": 18.957012176513672, "max_q": 23.539018630981445, "min_q": 9.432319641113281, "mean_td_error": -0.012176185846328735, "td_error": "[-0.05197906  0.04694366 -0.09778023  0.02182198 -0.03085327 -0.05062294\n  0.03522873 -0.02525711 -0.02882957 -0.05854225  0.01941872  0.0889492\n  0.03315926 -0.01646996  0.02535057  0.01922035  0.02305031  0.0482769\n -0.05041122 -0.00293732 -0.02613831 -0.11888885 -0.00240517  0.0098362\n  0.02347946  0.0320015   0.01107121 -0.02795601 -0.06201172 -0.05764198\n  0.00497055 -0.09712601  0.02708817 -0.029356   -0.05057716  0.02451324\n -0.02946281  0.03703117 -0.08573914 -0.00172806 -0.03172684 -0.04531288\n -0.01398659 -0.04381752  0.03326893 -0.04666328  0.0041008   0.00726128\n -0.1301918  -0.01409721  0.05290222 -0.02885246 -0.04493523  0.02445793\n  0.0288353  -0.00244808 -0.05357933 -0.01290703 -0.00861931 -0.05815125\n  0.05660343  0.01226807  0.0093174  -0.00169945]"}}, "num_steps_sampled": 39000, "num_steps_trained": 2304064, "last_target_update_ts": 39000, "num_target_updates": 36001}, "done": false, "episodes_total": 13, "training_iteration": 13, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-16-10", "timestamp": 1609816570, "time_this_iter_s": 53.43538022041321, "time_total_s": 650.653792142868, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f7b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 650.653792142868, "timesteps_since_restore": 0, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 8.130263157894735, "ram_util_percent": 28.300000000000015}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2131.3394730921996, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1065.8105991174045, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1987.765003373451, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.696882588518834, "mean_processing_ms": 1.2842375460407354, "mean_inference_ms": 0.6029006007634466}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 42000, "timers": {"learn_time_ms": 3.749, "learn_throughput": 17071.703, "update_time_ms": 0.615}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -21.10292625427246, "critic_loss": 0.0016696895472705364, "mean_q": 20.598068237304688, "max_q": 25.65200424194336, "min_q": 11.72431468963623, "mean_td_error": -0.006011411547660828, "td_error": "[ 3.58200073e-03  1.30653381e-03 -1.12834930e-01  7.25460052e-02\n  1.39808655e-03 -8.43048096e-03  9.87110138e-02 -7.69996643e-02\n  1.68418884e-03 -6.36596680e-02 -2.44998932e-02 -3.85856628e-02\n -3.72581482e-02 -1.12247467e-03 -1.78527832e-02  7.20596313e-03\n -4.59632874e-02 -8.93688202e-02 -7.36618042e-03  5.25264740e-02\n -9.60350037e-03 -4.01878357e-03  3.19786072e-02  6.91261292e-02\n -5.79204559e-02  2.60181427e-02  5.97381592e-03 -1.83296204e-03\n  8.43162537e-02  4.48722839e-02 -9.05799866e-03 -9.45930481e-02\n -4.83779907e-02  3.62482071e-02  2.67200470e-02 -8.94165039e-02\n -4.08267975e-02  3.16028595e-02  1.02996826e-04  1.70085907e-01\n  4.55245972e-02  9.85202789e-02  1.62582397e-02 -2.40573883e-02\n -4.02679443e-02  1.62220001e-02 -2.63004303e-02 -6.70585632e-02\n -2.63957977e-02 -2.92301178e-02 -6.57920837e-02 -1.44121170e-01\n -4.82196808e-02  3.75556946e-03 -4.87565994e-02 -2.07214355e-02\n -3.78551483e-02  1.99766159e-02  3.22790146e-02  6.01768494e-03\n -1.25656128e-02  8.50906372e-02 -7.18574524e-02  6.84089661e-02]"}}, "num_steps_sampled": 42000, "num_steps_trained": 2496064, "last_target_update_ts": 42000, "num_target_updates": 39001}, "done": false, "episodes_total": 14, "training_iteration": 14, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-17-02", "timestamp": 1609816622, "time_this_iter_s": 52.823789834976196, "time_total_s": 703.4775819778442, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 703.4775819778442, "timesteps_since_restore": 0, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 8.073333333333332, "ram_util_percent": 28.380000000000006}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2131.3394730921996, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1070.8860455032288, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1141.9422949047678, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.707776870771048, "mean_processing_ms": 1.2859656012047884, "mean_inference_ms": 0.6064139709054855}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 45000, "timers": {"learn_time_ms": 3.642, "learn_throughput": 17573.516, "update_time_ms": 0.691}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -22.15886688232422, "critic_loss": 0.0015453135129064322, "mean_q": 21.767719268798828, "max_q": 27.663658142089844, "min_q": 10.27600383758545, "mean_td_error": 0.008543789386749268, "td_error": "[-0.08572769 -0.02292442  0.0040493  -0.08238602  0.00968647  0.04340363\n -0.05884933  0.07204628  0.01478767 -0.0690918   0.01708221 -0.03695869\n -0.00222969  0.08271217  0.03825951  0.01888847 -0.03229332 -0.02601624\n  0.02480698  0.01390076  0.06806564 -0.07923126 -0.08259964  0.01998901\n  0.03958511  0.03789711  0.0866642  -0.02638435  0.10355282 -0.03823853\n  0.02785683 -0.00691795  0.12650108 -0.06186485 -0.06036949 -0.01234818\n -0.00451469  0.02038002  0.04894829  0.04749489  0.07219696 -0.02934742\n -0.02345085 -0.04512405  0.01921177  0.00684547 -0.01115417  0.00600624\n  0.06287384  0.05758286  0.02033234  0.00436211 -0.02655983 -0.01299858\n  0.05838966  0.00078201 -0.00600815  0.03250313 -0.0281229   0.18268871\n -0.02451134 -0.02104759  0.09706306 -0.02332306]"}}, "num_steps_sampled": 45000, "num_steps_trained": 2688064, "last_target_update_ts": 45000, "num_target_updates": 42001}, "done": false, "episodes_total": 15, "training_iteration": 15, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-17-55", "timestamp": 1609816675, "time_this_iter_s": 52.05585765838623, "time_total_s": 755.5334396362305, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fd08>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 755.5334396362305, "timesteps_since_restore": 0, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 8.113513513513514, "ram_util_percent": 28.400000000000006}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2131.3394730921996, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1069.2844727895847, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1045.2608820849264, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.717171204815603, "mean_processing_ms": 1.287457121216999, "mean_inference_ms": 0.609506720837935}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 48000, "timers": {"learn_time_ms": 4.026, "learn_throughput": 15897.865, "update_time_ms": 0.722}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -22.702878952026367, "critic_loss": 0.001612846041098237, "mean_q": 22.390625, "max_q": 29.111652374267578, "min_q": 10.59241771697998, "mean_td_error": -0.019332244992256165, "td_error": "[-0.03038025  0.00609398  0.00546837 -0.00594521 -0.0236969  -0.05378532\n -0.09212112 -0.04396439  0.03384209 -0.03865623 -0.06123543  0.02882767\n  0.0233345  -0.07933998 -0.03121376 -0.16662025 -0.12915802  0.00907135\n -0.03806114  0.10210609 -0.03774643 -0.00852871 -0.03600502 -0.02365112\n  0.01053429 -0.08053017 -0.05578613 -0.02941322 -0.01905251 -0.05078506\n -0.07819366  0.02927017 -0.07234383 -0.0486145   0.02939034 -0.0658493\n  0.05314445 -0.05593872 -0.02860641 -0.04020119 -0.02019119  0.01641655\n -0.05446625 -0.01195526 -0.0111084   0.03614044  0.00997925  0.00245857\n -0.00576401  0.00508118 -0.04821205  0.15284157 -0.02482796  0.00256157\n -0.10679245 -0.00676346  0.01125336 -0.05491447  0.00584984  0.09448814\n -0.02685738 -0.04203415  0.02443314  0.00946045]"}}, "num_steps_sampled": 48000, "num_steps_trained": 2880064, "last_target_update_ts": 48000, "num_target_updates": 45001}, "done": false, "episodes_total": 16, "training_iteration": 16, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-18-46", "timestamp": 1609816726, "time_this_iter_s": 51.638774394989014, "time_total_s": 807.1722140312195, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc593048>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 807.1722140312195, "timesteps_since_restore": 0, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 8.213513513513513, "ram_util_percent": 28.429729729729733}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2131.3394730921996, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1017.4616722681698, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [188.29686392552995, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.724669323685075, "mean_processing_ms": 1.2888338489876576, "mean_inference_ms": 0.6122922043089425}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 51000, "timers": {"learn_time_ms": 3.375, "learn_throughput": 18962.261, "update_time_ms": 0.623}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -23.578393936157227, "critic_loss": 0.003045889316126704, "mean_q": 23.387325286865234, "max_q": 30.48715591430664, "min_q": 1.9085866212844849, "mean_td_error": -0.04889340698719025, "td_error": "[-0.15243721 -0.03212166 -0.03277588  0.05530262  0.02589607 -0.16798782\n -0.01137924 -0.02615547 -0.04888916 -0.09070206 -0.010952   -0.06847191\n -0.07347298 -0.05764008 -0.10664749 -0.02886581 -0.10826874 -0.04971123\n -0.06394005 -0.12400436 -0.02759552 -0.00193214 -0.07702827 -0.06277657\n -0.13315582  0.01698303 -0.0433445  -0.00238419 -0.00909615  0.01921272\n  0.04929161 -0.0481205  -0.06406212 -0.15307331 -0.07998466 -0.09475517\n -0.03129768 -0.01914215 -0.00770998 -0.03101158 -0.09960747  0.0178299\n -0.07019424 -0.13327026 -0.0784626  -0.16193962 -0.05827141 -0.03194618\n -0.04579163 -0.16428757  0.07990026 -0.0242939   0.00704384 -0.01909637\n  0.09531975 -0.02517319  0.03940392 -0.06178474 -0.12231255 -0.05997467\n -0.10144043 -0.09602928 -0.06099892  0.02040672]"}}, "num_steps_sampled": 51000, "num_steps_trained": 3072064, "last_target_update_ts": 51000, "num_target_updates": 48001}, "done": false, "episodes_total": 17, "training_iteration": 17, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-19-38", "timestamp": 1609816778, "time_this_iter_s": 51.52262210845947, "time_total_s": 858.694836139679, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc593400>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 858.694836139679, "timesteps_since_restore": 0, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 8.056756756756757, "ram_util_percent": 28.5}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2131.3394730921996, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1018.302406769181, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1032.594893286371, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.731352992038008, "mean_processing_ms": 1.2901320011008233, "mean_inference_ms": 0.6148485084983352}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 54000, "timers": {"learn_time_ms": 3.639, "learn_throughput": 17585.604, "update_time_ms": 0.718}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -24.570234298706055, "critic_loss": 0.0011314311996102333, "mean_q": 24.30501365661621, "max_q": 31.958148956298828, "min_q": 1.053601622581482, "mean_td_error": 0.02085297554731369, "td_error": "[ 0.00154686 -0.00219345  0.06900978  0.01558495  0.06607819  0.07403755\n -0.03649521  0.0015974  -0.02481079 -0.0018177   0.00650787  0.02217293\n  0.05487442 -0.00186348 -0.04196739  0.01496315  0.07413673  0.0358429\n  0.0661869  -0.04249382 -0.00892258  0.00044632  0.105896   -0.05953979\n  0.04771423  0.04663658 -0.01799965  0.00034332  0.02942848  0.02622604\n -0.01291084  0.05688477  0.06867218  0.05733109 -0.06399918  0.02377129\n -0.02532196 -0.0123024  -0.02044106  0.01909447  0.04854202  0.05944061\n  0.05975723 -0.01602077  0.00293159  0.03907967  0.01245308 -0.00980377\n -0.04018784  0.03931427  0.03727531  0.02284813  0.03256989  0.03476715\n  0.02799034  0.03757334  0.05602545 -0.01194954  0.03914452 -0.01892853\n -0.00409317  0.11778831  0.09485435  0.06131363]"}}, "num_steps_sampled": 54000, "num_steps_trained": 3264064, "last_target_update_ts": 54000, "num_target_updates": 51001}, "done": false, "episodes_total": 18, "training_iteration": 18, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-20-30", "timestamp": 1609816830, "time_this_iter_s": 52.57121706008911, "time_total_s": 911.2660531997681, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f598>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 911.2660531997681, "timesteps_since_restore": 0, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 8.072000000000001, "ram_util_percent": 28.5}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2131.3394730921996, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1016.733462443252, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [988.4924645765291, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.737244196034432, "mean_processing_ms": 1.2914105434235976, "mean_inference_ms": 0.6171914565897056}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 57000, "timers": {"learn_time_ms": 3.902, "learn_throughput": 16400.817, "update_time_ms": 0.691}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -25.961090087890625, "critic_loss": 0.004078340250998735, "mean_q": 25.663007736206055, "max_q": 33.18696594238281, "min_q": 1.204031229019165, "mean_td_error": -0.06586126238107681, "td_error": "[-0.12241364  0.04933262 -0.02078247 -0.00292778 -0.08056259 -0.03982925\n -0.10339546 -0.055233    0.00575066 -0.10391998  0.01197243  0.04572868\n -0.08506012 -0.08001328 -0.09366226 -0.08266449 -0.11406708 -0.02850723\n -0.07079697 -0.10693359 -0.13847291 -0.03891182 -0.12762642 -0.09770966\n -0.13088799 -0.13073349 -0.14806175 -0.12338161 -0.0535717  -0.05829048\n -0.13995361 -0.11558342 -0.12191391  0.01615334 -0.0745163   0.02792931\n -0.12121391 -0.09123039 -0.12875175 -0.02387619 -0.10910797 -0.09876633\n  0.02836227 -0.08636475 -0.01177406 -0.09606934 -0.09229851 -0.05565643\n -0.03170013  0.09104538 -0.05518532 -0.15923595 -0.10869217 -0.00925064\n -0.16657066 -0.05208206 -0.03579712  0.02058601 -0.13516426 -0.06779289\n -0.0996418   0.02986717  0.04805946 -0.06330109]"}}, "num_steps_sampled": 57000, "num_steps_trained": 3456064, "last_target_update_ts": 57000, "num_target_updates": 54001}, "done": false, "episodes_total": 19, "training_iteration": 19, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-21-23", "timestamp": 1609816883, "time_this_iter_s": 52.56365084648132, "time_total_s": 963.8297040462494, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f7b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 963.8297040462494, "timesteps_since_restore": 0, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 8.031999999999998, "ram_util_percent": 28.587999999999997}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2131.3394730921996, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1028.822020997655, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1258.5046335313136, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.742521738450118, "mean_processing_ms": 1.2925506247734495, "mean_inference_ms": 0.6193394207133348}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 60000, "timers": {"learn_time_ms": 3.574, "learn_throughput": 17909.428, "update_time_ms": 0.639}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -27.362239837646484, "critic_loss": 0.003003272693604231, "mean_q": 27.0105037689209, "max_q": 35.86618423461914, "min_q": 13.79869556427002, "mean_td_error": -0.00549587607383728, "td_error": "[ 7.15065002e-03 -1.81465149e-02  4.49943542e-02 -8.22830200e-03\n -7.77091980e-02 -3.00493240e-02  5.91583252e-02 -4.38594818e-02\n -3.10897827e-04 -6.08444214e-03 -1.06945038e-02 -3.29017639e-02\n -8.65745544e-03 -1.12525940e-01  1.05228424e-02  8.75854492e-03\n  1.03090286e-01 -7.43408203e-02  1.15604401e-02  4.56733704e-02\n  4.99973297e-02 -8.52375031e-02  4.12826538e-02  4.92668152e-02\n -3.14416885e-01 -1.06925964e-02 -1.00273132e-01 -6.97898865e-03\n  3.27224731e-02  3.75671387e-02  5.80787659e-03  3.46565247e-02\n  1.30102158e-01 -3.07044983e-02  1.41372681e-02 -3.89137268e-02\n  2.33116150e-02 -2.37197876e-02  2.78091431e-02  1.13162994e-01\n -1.89456940e-02 -5.90553284e-02  6.78367615e-02  7.55271912e-02\n  4.56733704e-02 -2.10990906e-02 -2.95524597e-02  1.17607117e-01\n -2.17132568e-02 -5.28087616e-02 -2.04761505e-01  1.09643936e-02\n  6.22444153e-02 -5.06401062e-03  1.97982788e-03 -4.32014465e-03\n -1.13716125e-02  3.08341980e-02  8.90731812e-02 -2.66647339e-03\n -7.41958618e-04  4.27894592e-02 -2.55104065e-01 -2.53486633e-02]"}}, "num_steps_sampled": 60000, "num_steps_trained": 3648064, "last_target_update_ts": 60000, "num_target_updates": 57001}, "done": false, "episodes_total": 20, "training_iteration": 20, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-22-15", "timestamp": 1609816935, "time_this_iter_s": 52.51583218574524, "time_total_s": 1016.3455362319946, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc59d2f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 1016.3455362319946, "timesteps_since_restore": 0, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 8.094666666666667, "ram_util_percent": 28.599999999999994}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2131.3394730921996, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 979.8878515998123, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.2044636429592133, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.746754155117054, "mean_processing_ms": 1.2935733531583835, "mean_inference_ms": 0.6213019071904282}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 63000, "timers": {"learn_time_ms": 3.476, "learn_throughput": 18412.6, "update_time_ms": 0.614}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -27.856914520263672, "critic_loss": 0.0018297088099643588, "mean_q": 27.462602615356445, "max_q": 36.40702438354492, "min_q": -0.9822681546211243, "mean_td_error": -0.006758061237633228, "td_error": "[ 0.03524971  0.00889969 -0.14184952  0.050951   -0.05389595  0.03068036\n  0.08163834  0.07726669 -0.00097656  0.02174377 -0.01612663 -0.00846481\n -0.01138306  0.00178337  0.11195755 -0.02417803  0.028965   -0.01050949\n  0.03688622 -0.12727928  0.09851074 -0.00029373  0.00724411 -0.03123856\n -0.09293747  0.0182457  -0.015728   -0.03474045 -0.01348686 -0.04217339\n  0.01186371 -0.14086533  0.11219215 -0.05607986 -0.03557587 -0.02499771\n -0.00547028 -0.1024704  -0.03611183 -0.00027275 -0.0467701  -0.00386047\n  0.00704956 -0.05542755 -0.02088547 -0.00440979 -0.07454872  0.07698631\n -0.05673599  0.03526306 -0.09502792 -0.02655411  0.03655815  0.05921555\n -0.03719711 -0.01220703 -0.09288025  0.0277977   0.0319252   0.10276222\n -0.04502296  0.08621788 -0.00246239 -0.02927399]"}}, "num_steps_sampled": 63000, "num_steps_trained": 3840064, "last_target_update_ts": 63000, "num_target_updates": 60001}, "done": false, "episodes_total": 21, "training_iteration": 21, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-23-07", "timestamp": 1609816987, "time_this_iter_s": 51.43209195137024, "time_total_s": 1067.7776281833649, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc59d6a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 1067.7776281833649, "timesteps_since_restore": 0, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 8.116438356164384, "ram_util_percent": 28.64794520547944}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2131.3394730921996, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1020.0748186494106, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1864.0011266909753, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.751014020962564, "mean_processing_ms": 1.2945306143157682, "mean_inference_ms": 0.6231450287936088}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 66000, "timers": {"learn_time_ms": 3.746, "learn_throughput": 17086.046, "update_time_ms": 0.732}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -28.739810943603516, "critic_loss": 0.0037975532468408346, "mean_q": 28.403045654296875, "max_q": 38.0433349609375, "min_q": -1.1462117433547974, "mean_td_error": 0.0405445396900177, "td_error": "[-0.10807419 -0.05767822  0.08994293  0.10084534  0.09911728  0.05772018\n  0.0196209   0.08914948  0.09755707 -0.01266861 -0.0634079   0.03627396\n  0.0126152   0.1023438  -0.02317429  0.07351875  0.0986042   0.01071167\n  0.1831379   0.0125885   0.1792903   0.03127289  0.07574081 -0.02490044\n  0.11111832 -0.16753769  0.01241302  0.07209015 -0.01265717  0.07566643\n -0.10962296  0.0257473  -0.11400223  0.03560638  0.10391998  0.12223625\n -0.01345062  0.06328011  0.07305908  0.05080223  0.11289042  0.1053142\n -0.09334564 -0.01281357  0.05514908  0.03038025  0.06231689  0.18620872\n -0.0532341   0.01076508  0.11792183  0.13045406  0.03817368  0.1189003\n  0.03600883 -0.00705338  0.08608437  0.02634048  0.0534687   0.10169601\n  0.11728096 -0.11200714  0.08147049 -0.00633621]"}}, "num_steps_sampled": 66000, "num_steps_trained": 4032064, "last_target_update_ts": 66000, "num_target_updates": 63001}, "done": false, "episodes_total": 22, "training_iteration": 22, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-24-00", "timestamp": 1609817040, "time_this_iter_s": 53.49221992492676, "time_total_s": 1121.2698481082916, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc59dae8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 1121.2698481082916, "timesteps_since_restore": 0, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 8.085526315789474, "ram_util_percent": 28.699999999999985}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2131.3394730921996, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1044.7792908219644, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1588.2776786181473, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.754969415564654, "mean_processing_ms": 1.2954004528783432, "mean_inference_ms": 0.6248284078175333}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 69000, "timers": {"learn_time_ms": 4.285, "learn_throughput": 14935.401, "update_time_ms": 0.71}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -30.154781341552734, "critic_loss": 0.0017404902027919888, "mean_q": 29.83966064453125, "max_q": 39.45606994628906, "min_q": 5.04751443862915, "mean_td_error": -0.02957337349653244, "td_error": "[-0.10030746  0.01220322  0.01910782  0.08734703 -0.03948212 -0.13728333\n -0.11071777 -0.05319977  0.07121849 -0.01569748  0.04728317  0.03116989\n -0.00466537  0.03205872 -0.04942322 -0.0409565  -0.02878952 -0.04431534\n -0.01445389 -0.02347755 -0.03659821 -0.02091217 -0.0258522  -0.0506649\n -0.0465126   0.05335617 -0.03754425 -0.0261097  -0.11894417 -0.10909986\n -0.02501869 -0.08008194 -0.05152321 -0.102911   -0.03887939 -0.01641083\n -0.01752281 -0.06168556  0.03384781 -0.05181503 -0.0100708  -0.00888443\n  0.0047245  -0.11657715 -0.04040146 -0.0294342  -0.07171822 -0.03738785\n -0.01606178 -0.02277374 -0.01790237 -0.09115982  0.03672028 -0.01582909\n  0.0128212  -0.1023674   0.02631378  0.06927681 -0.03720474 -0.02906418\n -0.03878021 -0.03518486 -0.06710052 -0.06138611]"}}, "num_steps_sampled": 69000, "num_steps_trained": 4224064, "last_target_update_ts": 69000, "num_target_updates": 66001}, "done": false, "episodes_total": 23, "training_iteration": 23, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-24-53", "timestamp": 1609817093, "time_this_iter_s": 52.40353870391846, "time_total_s": 1173.67338681221, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc58e048>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 1173.67338681221, "timesteps_since_restore": 0, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 8.196, "ram_util_percent": 28.71333333333334}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2131.3394730921996, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1085.608524413846, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2024.6808970271243, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.758942150786164, "mean_processing_ms": 1.2962077800965035, "mean_inference_ms": 0.6264217191686988}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 72000, "timers": {"learn_time_ms": 3.823, "learn_throughput": 16739.134, "update_time_ms": 0.698}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -30.377334594726562, "critic_loss": 0.001787519664503634, "mean_q": 30.090042114257812, "max_q": 41.467674255371094, "min_q": -0.4781620502471924, "mean_td_error": -0.006619756110012531, "td_error": "[ 0.05881882 -0.01483727 -0.04307175 -0.03922272  0.02006078 -0.02791977\n  0.02758026 -0.03787613  0.08995056 -0.01668549 -0.01581955 -0.07114601\n -0.01421356 -0.01268578 -0.07617891 -0.0507431  -0.02344704 -0.03335571\n -0.02369308 -0.04738045 -0.03900909 -0.04692841 -0.00176239 -0.0136261\n -0.02086449  0.0604496  -0.03501511  0.13170242  0.03260422 -0.05949783\n  0.08269119  0.00405121  0.11995077 -0.08829117 -0.06723022  0.01337433\n -0.06806564 -0.0729084   0.06912231 -0.07252884  0.06024742  0.0355835\n  0.05126572  0.06184006  0.06849861  0.05167961 -0.03841019 -0.09173203\n -0.0816288  -0.03353882  0.09562683  0.06884795 -0.04548645  0.01893425\n -0.14974594  0.00846863  0.03722382 -0.02793121  0.002388    0.04007912\n -0.06295776 -0.04862976 -0.0023365  -0.01830292]"}}, "num_steps_sampled": 72000, "num_steps_trained": 4416064, "last_target_update_ts": 72000, "num_target_updates": 69001}, "done": false, "episodes_total": 24, "training_iteration": 24, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-25-47", "timestamp": 1609817147, "time_this_iter_s": 53.98284649848938, "time_total_s": 1227.6562333106995, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc58e400>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 1227.6562333106995, "timesteps_since_restore": 0, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 8.21298701298701, "ram_util_percent": 28.800000000000015}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2131.3394730921996, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1044.9504010238347, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.15543966356044, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.762185738371647, "mean_processing_ms": 1.2969724446018767, "mean_inference_ms": 0.6279267927921982}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 75000, "timers": {"learn_time_ms": 3.911, "learn_throughput": 16363.925, "update_time_ms": 0.771}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -28.793188095092773, "critic_loss": 0.0017554445657879114, "mean_q": 28.543128967285156, "max_q": 42.16953659057617, "min_q": -1.5251442193984985, "mean_td_error": 0.0026290621608495712, "td_error": "[-0.00858116  0.05987358  0.04278183  0.02245677 -0.064394    0.05897903\n -0.06580353  0.0619753   0.04265976  0.01160002 -0.01810455 -0.03402138\n  0.01317596 -0.07514191 -0.1440525  -0.02879333  0.0398159  -0.03068924\n -0.01656723  0.15361214  0.00064087  0.01858711 -0.02563858 -0.14664459\n -0.03780937  0.02964783  0.06229973  0.0088253   0.08962822  0.04386902\n  0.07312393 -0.03098297 -0.03863716  0.04401779  0.07352066  0.02330971\n -0.0327301   0.00490189 -0.01552582 -0.04779416  0.05609131 -0.03886032\n  0.04779434  0.0159893  -0.06937027 -0.04485703 -0.00279212  0.08309937\n -0.06048965  0.05783463  0.05503845 -0.06202698  0.03045654  0.02793503\n -0.01477432  0.01163864  0.08072662 -0.04602051  0.070158   -0.00186157\n -0.01460648 -0.01534653  0.00863838 -0.12352562]"}}, "num_steps_sampled": 75000, "num_steps_trained": 4608064, "last_target_update_ts": 75000, "num_target_updates": 72001}, "done": false, "episodes_total": 25, "training_iteration": 25, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-26-39", "timestamp": 1609817199, "time_this_iter_s": 52.37480187416077, "time_total_s": 1280.0310351848602, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc58e840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 1280.0310351848602, "timesteps_since_restore": 0, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 8.124000000000002, "ram_util_percent": 28.80000000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2131.3394730921996, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1009.9095143308556, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [133.88734700637613, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.764851431613014, "mean_processing_ms": 1.2976946117495025, "mean_inference_ms": 0.6293284904699992}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 78000, "timers": {"learn_time_ms": 3.718, "learn_throughput": 17215.126, "update_time_ms": 0.708}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -29.253705978393555, "critic_loss": 0.003233670722693205, "mean_q": 29.034378051757812, "max_q": 43.92608642578125, "min_q": -2.0620925426483154, "mean_td_error": -0.008584188297390938, "td_error": "[-0.06324768  0.16946542  0.05877709  0.04426622  0.05376053 -0.0562706\n  0.08119154  0.02608871  0.13331985 -0.06346512 -0.07571793 -0.06945419\n -0.13614655  0.03251839 -0.05285263 -0.04376602  0.02329445 -0.1286354\n -0.02457047 -0.11390305 -0.01203728 -0.11755371  0.0520153   0.22494507\n -0.04920959 -0.08599091 -0.03435135  0.0402565   0.06266785 -0.09602737\n  0.00167084 -0.17337799 -0.01387405 -0.02937317 -0.01512337  0.01267815\n  0.01550674 -0.03944969  0.06153297 -0.12835693  0.01267242 -0.00214767\n  0.03842545 -0.09868622 -0.00486565  0.02620316  0.03924942 -0.03456116\n  0.01173019 -0.03911591  0.17466807 -0.00456238 -0.09473991  0.07582283\n -0.03316879 -0.08667374  0.138937    0.00187492 -0.03112793  0.03834152\n  0.01322937 -0.07073212  0.00527239 -0.09663391]"}}, "num_steps_sampled": 78000, "num_steps_trained": 4800064, "last_target_update_ts": 78000, "num_target_updates": 75001}, "done": false, "episodes_total": 26, "training_iteration": 26, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-27-32", "timestamp": 1609817252, "time_this_iter_s": 52.204216957092285, "time_total_s": 1332.2352521419525, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc59dd90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 1332.2352521419525, "timesteps_since_restore": 0, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 8.256756756756756, "ram_util_percent": 28.879729729729736}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2131.3394730921996, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1017.9390736075759, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1226.7076148023064, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.767204303796317, "mean_processing_ms": 1.2983680290101045, "mean_inference_ms": 0.630609295894937}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 81000, "timers": {"learn_time_ms": 3.933, "learn_throughput": 16272.958, "update_time_ms": 0.699}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -30.858524322509766, "critic_loss": 0.002228712197393179, "mean_q": 30.611724853515625, "max_q": 44.876487731933594, "min_q": -0.9515016078948975, "mean_td_error": 0.010980765335261822, "td_error": "[ 0.02737236  0.03104401 -0.03792572  0.06785774  0.0430336   0.04828072\n -0.03509521  0.03544998 -0.05545044  0.02368546 -0.16148376  0.10538864\n -0.02850151 -0.12241364  0.04677582  0.02116013 -0.0191803   0.03141403\n  0.05708504  0.10363388 -0.02180052  0.10388947  0.03074646  0.03463244\n -0.03989792 -0.09498215 -0.01394653  0.01636124  0.00262451  0.12977982\n  0.02222824  0.05417204  0.0144062   0.02144241 -0.01889038 -0.02806091\n  0.03252792  0.02694702 -0.0472374   0.03573036 -0.06176919  0.00343323\n  0.00799942  0.03369665  0.0755024   0.07420921  0.16348267 -0.06758499\n -0.1474495  -0.05191803  0.08857727 -0.01482201 -0.05185699 -0.05395973\n  0.03998566 -0.03468323  0.03994179  0.15374088  0.06047821  0.02468491\n  0.0483017  -0.02650833 -0.01359749 -0.02991867]"}}, "num_steps_sampled": 81000, "num_steps_trained": 4992064, "last_target_update_ts": 81000, "num_target_updates": 78001}, "done": false, "episodes_total": 27, "training_iteration": 27, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-28-23", "timestamp": 1609817303, "time_this_iter_s": 51.7977659702301, "time_total_s": 1384.0330181121826, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc59d1e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 1384.0330181121826, "timesteps_since_restore": 0, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 8.181081081081079, "ram_util_percent": 28.900000000000006}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2291.5854842340254, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1063.4264454156635, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2291.5854842340254, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.769678326387321, "mean_processing_ms": 1.2990151630221998, "mean_inference_ms": 0.6318120021719915}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 84000, "timers": {"learn_time_ms": 4.11, "learn_throughput": 15573.393, "update_time_ms": 0.637}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -33.24009704589844, "critic_loss": 0.0014771796995773911, "mean_q": 32.9635009765625, "max_q": 45.563026428222656, "min_q": -2.068838119506836, "mean_td_error": -0.013114726170897484, "td_error": "[-0.12477875 -0.04196167 -0.07799149 -0.04000568 -0.03861237  0.01716614\n -0.00107574  0.04117966 -0.02318573 -0.0300827   0.0220871   0.02988434\n -0.08119202 -0.01856232  0.02552795 -0.03751564  0.01275253  0.04391098\n -0.0200386  -0.01000214  0.06799698 -0.04836273 -0.00854111  0.05063248\n -0.00646973 -0.0054884   0.03673172 -0.04190445 -0.00030136 -0.00082779\n  0.05277634  0.02414703  0.08148003 -0.03840446 -0.03910828  0.07159042\n -0.01234627 -0.00684166  0.09028244 -0.02584457 -0.03518295 -0.00709534\n  0.07801437  0.00438309 -0.00792313 -0.06398773 -0.00239563 -0.06736755\n  0.02721786  0.0105896  -0.05839539 -0.03937721 -0.13282776 -0.10216904\n -0.00427246  0.02222061 -0.02617264 -0.07291031 -0.14060974 -0.07160032\n -0.02632523  0.01687241 -0.03286743  0.00413895]"}}, "num_steps_sampled": 84000, "num_steps_trained": 5184064, "last_target_update_ts": 84000, "num_target_updates": 81001}, "done": false, "episodes_total": 28, "training_iteration": 28, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-29-17", "timestamp": 1609817357, "time_this_iter_s": 53.49833083152771, "time_total_s": 1437.5313489437103, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f7b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 1437.5313489437103, "timesteps_since_restore": 0, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 8.216883116883118, "ram_util_percent": 28.935064935064936}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2291.5854842340254, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1031.3260069205817, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [132.51372905828967, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.771692574557588, "mean_processing_ms": 1.299615566255217, "mean_inference_ms": 0.6329400219775154}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 87000, "timers": {"learn_time_ms": 3.513, "learn_throughput": 18216.799, "update_time_ms": 0.648}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -32.1710319519043, "critic_loss": 0.003294198075309396, "mean_q": 31.917186737060547, "max_q": 48.80112838745117, "min_q": -1.2972098588943481, "mean_td_error": -0.05235796049237251, "td_error": "[-0.09918213 -0.04287338  0.03482056 -0.11003113  0.0768013  -0.01660728\n -0.01270676 -0.10629272 -0.11647415 -0.04227638 -0.09486008 -0.10643387\n  0.04677582 -0.14637756 -0.03466415 -0.06993103 -0.05014038 -0.03343964\n -0.01593399  0.08822632 -0.04627228 -0.02096176 -0.09393692 -0.00476456\n -0.05420303 -0.13074875 -0.14723206 -0.06626892 -0.06483078 -0.08204269\n -0.02398682 -0.12406158  0.02103806 -0.07663727 -0.04232788 -0.03708172\n  0.00214624 -0.04723358 -0.06192398  0.0168848  -0.1543808  -0.13989258\n -0.08790588 -0.07969284 -0.07588387 -0.0122322   0.00336838 -0.1255951\n -0.18005753 -0.08417511  0.01394844 -0.05555773 -0.02575684 -0.05008125\n -0.00267029  0.01986647 -0.12003136 -0.10189629 -0.08373642 -0.07709122\n  0.08890915 -0.0148567  -0.08321381  0.01375198]"}}, "num_steps_sampled": 87000, "num_steps_trained": 5376064, "last_target_update_ts": 87000, "num_target_updates": 84001}, "done": false, "episodes_total": 29, "training_iteration": 29, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-30-09", "timestamp": 1609817409, "time_this_iter_s": 51.734771728515625, "time_total_s": 1489.266120672226, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 1489.266120672226, "timesteps_since_restore": 0, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 8.14109589041096, "ram_util_percent": 29.0}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2291.5854842340254, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1031.6749604351423, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1041.794612357399, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.773502039240242, "mean_processing_ms": 1.3001638975424423, "mean_inference_ms": 0.6339986334162625}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 90000, "timers": {"learn_time_ms": 3.946, "learn_throughput": 16218.881, "update_time_ms": 0.701}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -36.185306549072266, "critic_loss": 0.002175790723413229, "mean_q": 35.828224182128906, "max_q": 48.13346481323242, "min_q": -0.06447012722492218, "mean_td_error": -0.008108952082693577, "td_error": "[-0.08182144 -0.11941528  0.02344131 -0.02220154 -0.01896667 -0.01446915\n  0.07003784  0.03486156 -0.03527451 -0.02212143 -0.05892181  0.00111961\n  0.01167679  0.01815987  0.06715012 -0.09038925 -0.08068848  0.08815384\n  0.03236008 -0.03629684 -0.02257538 -0.06964111 -0.03972626 -0.06149292\n -0.10938263  0.00587463  0.08923149 -0.06767654 -0.07564163  0.04440308\n -0.05521011  0.02229691  0.16384888  0.00611687 -0.03651047 -0.13819122\n  0.06747055  0.04075623  0.0466156   0.07726288 -0.00376892  0.01518631\n -0.00064087  0.02088928 -0.03006744  0.0673542  -0.10627747 -0.06443787\n -0.0030098   0.02412796  0.06297112 -0.11877441 -0.04402161 -0.02657277\n -0.11369705 -0.09246826 -0.00956726  0.00351334  0.03732872  0.10455322\n  0.03768539  0.06766129  0.01081467 -0.01197815]"}}, "num_steps_sampled": 90000, "num_steps_trained": 5568064, "last_target_update_ts": 90000, "num_target_updates": 87001}, "done": false, "episodes_total": 30, "training_iteration": 30, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-31-01", "timestamp": 1609817461, "time_this_iter_s": 52.303765535354614, "time_total_s": 1541.5698862075806, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f620>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 1541.5698862075806, "timesteps_since_restore": 0, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 7.9239999999999995, "ram_util_percent": 29.0}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2291.5854842340254, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1070.4376461495647, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2233.3182175822394, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.775413730744269, "mean_processing_ms": 1.3006738753172513, "mean_inference_ms": 0.6349919037646796}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 93000, "timers": {"learn_time_ms": 3.82, "learn_throughput": 16753.552, "update_time_ms": 0.644}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -34.27235794067383, "critic_loss": 14.563438415527344, "mean_q": 33.98936462402344, "max_q": 50.58156204223633, "min_q": -2.088906764984131, "mean_td_error": 0.6640415787696838, "td_error": "[-4.4155121e-02 -4.6514511e-02 -6.7890167e-02 -2.2102356e-02\n -2.2495270e-02 -2.3048401e-02 -3.2892227e-02  3.2649994e-02\n  1.4821243e-01 -4.7667742e-02  9.9678040e-03  2.7734756e-02\n -2.3799896e-02 -1.0206413e-01 -8.6372375e-02 -4.0054321e-04\n  6.0771942e-02  6.7230225e-02  1.7820358e-02 -1.8917084e-02\n -1.7463684e-02 -6.6860199e-02 -1.6432881e-02  5.8101654e-02\n  5.3356171e-02 -4.9880981e-02  8.6589813e-02  5.6610107e-02\n -3.3447266e-02 -1.4274299e-02 -1.3134384e-01  5.0075531e-02\n -6.3941956e-02 -5.2075863e-02  7.1353912e-02 -3.7494659e-02\n  4.3716431e-03  1.6283798e-01 -2.4299622e-02 -1.4755249e-02\n  6.5595627e-02  1.2020111e-02 -9.6702576e-03 -7.5321198e-02\n -4.4589996e-02 -2.3175240e-02  1.7391205e-02 -5.0197601e-02\n -4.7100067e-02  2.1499634e-02  2.8797150e-02  9.9411011e-02\n  4.3171597e+01  1.1621952e-02 -7.4848175e-02 -6.5231323e-02\n  1.6265869e-02  1.4129639e-02 -3.2608032e-01 -1.1524200e-02\n -2.3334503e-02  6.5212250e-02 -7.1426392e-02 -4.9476624e-02]"}}, "num_steps_sampled": 93000, "num_steps_trained": 5760064, "last_target_update_ts": 93000, "num_target_updates": 90001}, "done": false, "episodes_total": 31, "training_iteration": 31, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-31-54", "timestamp": 1609817514, "time_this_iter_s": 53.383061170578, "time_total_s": 1594.9529473781586, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fbf8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 1594.9529473781586, "timesteps_since_restore": 0, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 8.101315789473684, "ram_util_percent": 29.086842105263152}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2291.5854842340254, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1091.5096360717612, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1744.7413236598563, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.777341371718945, "mean_processing_ms": 1.3011428907151643, "mean_inference_ms": 0.6359367835993925}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 96000, "timers": {"learn_time_ms": 3.806, "learn_throughput": 16813.365, "update_time_ms": 0.608}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -36.03560256958008, "critic_loss": 0.003523579565808177, "mean_q": 35.77463912963867, "max_q": 51.72341537475586, "min_q": 1.454207181930542, "mean_td_error": 0.0029096081852912903, "td_error": "[-0.02364349  0.09617996  0.0075531  -0.1172142  -0.00173187 -0.00059319\n  0.03237915  0.05579758 -0.05195618  0.0196991  -0.0200882   0.04442453\n -0.03730774 -0.11107254 -0.0495882   0.00614548 -0.09827042  0.01602936\n -0.01297569  0.10413361  0.01675797 -0.10427666 -0.04845428  0.07737732\n -0.07040405  0.08600998  0.06742597  0.07847214  0.05282116  0.06546021\n  0.05355453  0.02074623  0.05004883 -0.07741547  0.01251602  0.10647202\n -0.03385162  0.00223541  0.11608887 -0.09880066  0.00240707  0.03917313\n  0.01664734 -0.11626816  0.07960129  0.08733368  0.01403809  0.14373398\n  0.03406906 -0.42593002 -0.07302094 -0.00629807  0.0437603   0.03356171\n -0.0316906   0.08284187 -0.02311325  0.01888657  0.05739212  0.00342178\n  0.04187393  0.00859833 -0.01594543 -0.05954289]"}}, "num_steps_sampled": 96000, "num_steps_trained": 5952064, "last_target_update_ts": 96000, "num_target_updates": 93001}, "done": false, "episodes_total": 32, "training_iteration": 32, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-32-48", "timestamp": 1609817568, "time_this_iter_s": 53.473625898361206, "time_total_s": 1648.4265732765198, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fb70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 1648.4265732765198, "timesteps_since_restore": 0, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 8.156578947368422, "ram_util_percent": 29.099999999999994}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2291.5854842340254, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1108.0909814779698, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1638.6940344766317, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.779233772717626, "mean_processing_ms": 1.3015663128234487, "mean_inference_ms": 0.636833710660968}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 99000, "timers": {"learn_time_ms": 4.01, "learn_throughput": 15960.725, "update_time_ms": 0.72}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -37.791168212890625, "critic_loss": 0.0031497087329626083, "mean_q": 37.58848571777344, "max_q": 53.694068908691406, "min_q": -0.9803262948989868, "mean_td_error": 0.04262612760066986, "td_error": "[ 0.07130051 -0.03694153  0.05119705  0.03591537  0.1148231  -0.00203705\n  0.06652451  0.04292297  0.07900453  0.13883209  0.0391922   0.10435867\n  0.04183578  0.02213287  0.11724472  0.15110397  0.02497482  0.02859116\n  0.01688766 -0.01796532  0.18536186  0.08872223  0.00135803 -0.02327347\n -0.01985931 -0.12423325 -0.05558777  0.03659058  0.06104279  0.04937363\n  0.00629044  0.04098129  0.10799026  0.07981169  0.03570938  0.01540232\n -0.01894379  0.06929016 -0.02110291 -0.0364151   0.07242203  0.19474792\n -0.03386307 -0.00114822 -0.0998764   0.03610992  0.1367836   0.04591179\n  0.02632904  0.13781166  0.09041977  0.10106659 -0.0446167   0.05425644\n -0.00988388  0.06019592  0.16072845  0.04277039  0.09661865  0.03355789\n  0.01699829  0.04018021 -0.06610489  0.0682497 ]"}}, "num_steps_sampled": 99000, "num_steps_trained": 6144064, "last_target_update_ts": 99000, "num_target_updates": 96001}, "done": false, "episodes_total": 33, "training_iteration": 33, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-33-41", "timestamp": 1609817621, "time_this_iter_s": 52.88605356216431, "time_total_s": 1701.312626838684, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fd90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 1701.312626838684, "timesteps_since_restore": 0, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 8.051315789473685, "ram_util_percent": 29.1486842105263}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2291.5854842340254, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1096.6387637072332, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [718.7155772729346, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.780928898205398, "mean_processing_ms": 1.30195519652769, "mean_inference_ms": 0.637685247924848}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 102000, "timers": {"learn_time_ms": 4.006, "learn_throughput": 15977.065, "update_time_ms": 0.69}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -40.303436279296875, "critic_loss": 0.002728778403252363, "mean_q": 40.09584045410156, "max_q": 54.47053527832031, "min_q": -2.1289708614349365, "mean_td_error": -0.005587223917245865, "td_error": "[ 0.04949951  0.08028412  0.04095459 -0.07471466 -0.07372284 -0.08472061\n -0.01699829 -0.02684402 -0.01153564 -0.03964233 -0.0859642   0.04843903\n  0.12249851 -0.02403641  0.0446701  -0.05632782 -0.00385284  0.00922394\n -0.01847076  0.01878166 -0.03001785  0.00699234 -0.02721405  0.00608444\n -0.13831234  0.05228424  0.0649395   0.11486053  0.03010559  0.02634811\n -0.06777978  0.09749985  0.05117226 -0.00273132  0.02320099 -0.13246155\n  0.0004921  -0.00844574 -0.19797134 -0.03327942 -0.00247192  0.11421967\n  0.09773827  0.05099869 -0.0455246   0.04521942  0.08333969  0.07949066\n -0.07289505 -0.10004807 -0.1374588   0.09949112  0.07120132  0.01491165\n -0.09332275  0.04402542  0.03583145 -0.10510635 -0.0705719  -0.08457184\n  0.01862144 -0.10136032 -0.06691933  0.03429222]"}}, "num_steps_sampled": 102000, "num_steps_trained": 6336064, "last_target_update_ts": 102000, "num_target_updates": 99001}, "done": false, "episodes_total": 34, "training_iteration": 34, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-34-33", "timestamp": 1609817673, "time_this_iter_s": 52.08358860015869, "time_total_s": 1753.3962154388428, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc537268>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 1753.3962154388428, "timesteps_since_restore": 0, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 8.037837837837838, "ram_util_percent": 29.19999999999999}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2291.5854842340254, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1121.9057809900353, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1980.9843686053077, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.782706474530245, "mean_processing_ms": 1.3023457443622466, "mean_inference_ms": 0.6385051193637622}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 105000, "timers": {"learn_time_ms": 3.725, "learn_throughput": 17180.969, "update_time_ms": 0.684}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -40.34449005126953, "critic_loss": 0.00173089315649122, "mean_q": 40.146339416503906, "max_q": 55.549400329589844, "min_q": 0.9990428686141968, "mean_td_error": -0.01253737322986126, "td_error": "[-2.72521973e-02 -2.77938843e-02  1.44119263e-02  1.37702942e-01\n  1.41830444e-02 -6.95533752e-02 -9.53674316e-05 -2.35538483e-02\n  2.34527588e-02  3.09791565e-02  6.38198853e-03 -3.07388306e-02\n -1.05651855e-01 -1.40733719e-02  3.86142731e-02 -1.16641998e-01\n  6.43424988e-02  1.41906738e-03 -1.38130188e-02  1.61018372e-02\n  4.11605835e-03 -1.42440796e-02  7.41844177e-02  2.14462280e-02\n -2.46925354e-02  1.74446106e-02 -3.45077515e-02  2.39715576e-02\n -2.21099854e-02  9.07897949e-04  6.04705811e-02  1.70402527e-02\n -2.66609192e-02 -4.08906937e-02 -8.42285156e-03  2.66151428e-02\n  1.07040405e-02 -1.98215485e-01  5.13648987e-02 -6.83441162e-02\n  1.15928650e-02  3.25565338e-02 -8.05168152e-02 -8.83865356e-03\n -7.74421692e-02  9.71221924e-03  4.29840088e-02 -1.51863098e-02\n -2.65569687e-02 -1.29623413e-02 -5.53665161e-02 -8.73926878e-02\n -2.18391418e-02 -9.86518860e-02 -1.65176392e-03 -7.87391663e-02\n  6.49528503e-02 -1.37340546e-01  1.80053711e-03  5.18531799e-02\n -1.53427124e-02 -1.65176392e-02 -3.64227295e-02 -3.56750488e-02]"}}, "num_steps_sampled": 105000, "num_steps_trained": 6528064, "last_target_update_ts": 105000, "num_target_updates": 102001}, "done": false, "episodes_total": 35, "training_iteration": 35, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-35-26", "timestamp": 1609817726, "time_this_iter_s": 53.49739933013916, "time_total_s": 1806.893614768982, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc537620>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 1806.893614768982, "timesteps_since_restore": 0, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 7.974025974025976, "ram_util_percent": 29.199999999999985}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2291.5854842340254, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1095.1990044928943, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [160.4618270929573, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.784266785488445, "mean_processing_ms": 1.3027270249592695, "mean_inference_ms": 0.6392945805219871}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 108000, "timers": {"learn_time_ms": 3.766, "learn_throughput": 16992.167, "update_time_ms": 0.638}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -39.175724029541016, "critic_loss": 0.004241284914314747, "mean_q": 38.99604797363281, "max_q": 55.90465545654297, "min_q": -1.7601488828659058, "mean_td_error": 0.010816404595971107, "td_error": "[ 0.12077332  0.43318176 -0.1830635  -0.0020504   0.0324111   0.07201958\n -0.02670288 -0.00931931 -0.17798233 -0.08007431 -0.05039978 -0.07687378\n  0.03102684  0.02392387 -0.07104874  0.11030197 -0.04150009 -0.06485367\n  0.02602005  0.10504341  0.10237503  0.0359726   0.05365753 -0.08707428\n  0.05614853 -0.04216003 -0.03231049  0.00951004 -0.01863098 -0.03036118\n -0.04044342 -0.00496292  0.0227623   0.02224731  0.09528923 -0.04286957\n  0.05245399  0.04705429  0.05391693  0.05125809  0.11544991 -0.01140213\n -0.03075409  0.11188126 -0.00151062 -0.07346344 -0.01225662 -0.08532715\n -0.00649261  0.08669281  0.00448227  0.06199837 -0.19034958  0.05234909\n  0.12196457 -0.07360458  0.05929184  0.03886795  0.00984573  0.03131104\n  0.01053619  0.03691864 -0.11581421  0.07696915]"}}, "num_steps_sampled": 108000, "num_steps_trained": 6720064, "last_target_update_ts": 108000, "num_target_updates": 105001}, "done": false, "episodes_total": 36, "training_iteration": 36, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-36-19", "timestamp": 1609817779, "time_this_iter_s": 52.57785511016846, "time_total_s": 1859.4714698791504, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc537a60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 1859.4714698791504, "timesteps_since_restore": 0, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 8.125333333333334, "ram_util_percent": 29.30000000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2291.5854842340254, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1109.8493969147169, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1637.2635241003345, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.7857707431569, "mean_processing_ms": 1.303089727574702, "mean_inference_ms": 0.640047144802523}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 111000, "timers": {"learn_time_ms": 3.616, "learn_throughput": 17697.369, "update_time_ms": 0.686}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -38.60369110107422, "critic_loss": 0.006066778674721718, "mean_q": 38.38349533081055, "max_q": 58.05100631713867, "min_q": 4.357426643371582, "mean_td_error": 0.06496823579072952, "td_error": "[ 0.05921555 -0.01646042  0.04691696  0.13211441  0.5095806   0.01287842\n  0.06585503  0.04317093  0.03120041  0.03784752  0.00167465  0.24930954\n  0.09894943  0.00175095  0.2577486   0.00782776  0.07961845 -0.01049805\n  0.09045696 -0.01105881  0.07564926  0.04337311  0.07967377  0.02160263\n  0.02818871 -0.05544662  0.010746    0.06898308  0.11852264  0.0818634\n  0.0666008   0.14387894  0.11058426  0.08976746  0.14530563 -0.0422821\n  0.17106009  0.03731918 -0.03478432  0.07758713  0.14598846  0.03423309\n  0.12044525  0.06804085  0.15059185  0.04449463  0.0755043  -0.01813126\n -0.00875473  0.01371384  0.0672493   0.10141754  0.06966782 -0.07534409\n  0.01170349  0.11442947 -0.06603241  0.00446892  0.07048416  0.12542725\n -0.01828575  0.07572937  0.11033249  0.0143013 ]"}}, "num_steps_sampled": 111000, "num_steps_trained": 6912064, "last_target_update_ts": 111000, "num_target_updates": 108001}, "done": false, "episodes_total": 37, "training_iteration": 37, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-37-12", "timestamp": 1609817832, "time_this_iter_s": 52.98119258880615, "time_total_s": 1912.4526624679565, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc537378>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 1912.4526624679565, "timesteps_since_restore": 0, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 8.201333333333334, "ram_util_percent": 29.30000000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2291.5854842340254, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1125.400580172329, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1700.7943607039717, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.787287262081295, "mean_processing_ms": 1.3034572380257508, "mean_inference_ms": 0.6407600791320615}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 114000, "timers": {"learn_time_ms": 3.622, "learn_throughput": 17670.225, "update_time_ms": 0.659}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -38.066890716552734, "critic_loss": 0.0023592549841850996, "mean_q": 37.769683837890625, "max_q": 57.896480560302734, "min_q": 0.17273549735546112, "mean_td_error": -0.010111507028341293, "td_error": "[ 0.03357697  0.02399826 -0.05071831  0.1272316  -0.02519608  0.01538467\n  0.11974141  0.07949781 -0.13147354 -0.01223755  0.05724335 -0.07908249\n -0.11684799  0.03100967  0.0308075  -0.04910278 -0.03627396  0.0342598\n -0.02713394  0.01117325 -0.10385132 -0.03734875  0.00163078  0.04561615\n -0.07246017  0.01107407 -0.05653763  0.13533401 -0.0231142  -0.03854752\n -0.10367966 -0.08759499  0.02459335 -0.08418465  0.00035477 -0.04169464\n -0.02526593 -0.06967354 -0.00952339 -0.01194    -0.0459938  -0.25346756\n  0.07749176  0.07928658  0.07153702  0.02430344  0.01655579  0.05925751\n -0.01534653 -0.00785828 -0.05971336  0.01651382  0.01772307 -0.03869247\n  0.01955414  0.009655    0.02453613 -0.05104828 -0.0153656   0.06659317\n -0.03589249 -0.04747009 -0.00679398 -0.04154587]"}}, "num_steps_sampled": 114000, "num_steps_trained": 7104064, "last_target_update_ts": 114000, "num_target_updates": 111001}, "done": false, "episodes_total": 38, "training_iteration": 38, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-38-05", "timestamp": 1609817885, "time_this_iter_s": 53.03851366043091, "time_total_s": 1965.4911761283875, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc549400>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 1965.4911761283875, "timesteps_since_restore": 0, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 8.088157894736844, "ram_util_percent": 29.361842105263158}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2291.5854842340254, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1153.300684277724, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2213.5046402827356, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.788893721472907, "mean_processing_ms": 1.3037838810054514, "mean_inference_ms": 0.641443810883188}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 117000, "timers": {"learn_time_ms": 4.129, "learn_throughput": 15500.015, "update_time_ms": 0.761}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -39.783573150634766, "critic_loss": 0.0025101627688854933, "mean_q": 39.55136489868164, "max_q": 59.23215103149414, "min_q": -0.13852858543395996, "mean_td_error": 0.015910590067505836, "td_error": "[-3.82156372e-02  4.65431213e-02 -1.23645782e-01  8.45031738e-02\n -4.32205200e-03  3.78837585e-02  2.48603821e-02  1.72805786e-02\n  7.53488541e-02  1.56810760e-01  8.54568481e-02 -4.90036011e-02\n -1.28768921e-01  6.58416748e-02  2.19631195e-01  6.10733032e-02\n  2.64472961e-02 -2.44865417e-02  8.19683075e-02  1.96113586e-02\n  4.00085449e-02  1.20265961e-01  2.11105347e-02 -1.32762909e-01\n  9.04464722e-03  5.52062988e-02  4.63104248e-02  2.02102661e-02\n  7.43865967e-05  9.38377380e-02 -9.11951065e-02  1.70188904e-01\n  9.74273682e-03 -6.78710938e-02 -3.69949341e-02  1.89342499e-02\n -2.13623047e-04 -5.37147522e-02 -7.20615387e-02  4.84046936e-02\n -2.58064270e-03 -1.60293579e-02  6.50460720e-02  1.49955750e-02\n -1.85165405e-02 -5.17425537e-02  9.61837769e-02 -5.44853210e-02\n  1.15661621e-02  1.01318359e-02  2.27355957e-03 -7.86590576e-02\n  8.80546570e-02  3.52478027e-02  3.00788879e-02  3.82099152e-02\n  3.33442688e-02  2.14653015e-02 -1.19132996e-02 -1.51596069e-02\n -1.46102905e-02  1.52359009e-02  1.51366368e-02 -2.83393860e-02]"}}, "num_steps_sampled": 117000, "num_steps_trained": 7296064, "last_target_update_ts": 117000, "num_target_updates": 114001}, "done": false, "episodes_total": 39, "training_iteration": 39, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-38-59", "timestamp": 1609817939, "time_this_iter_s": 54.08800220489502, "time_total_s": 2019.5791783332825, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc537730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 2019.5791783332825, "timesteps_since_restore": 0, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 8.006493506493506, "ram_util_percent": 29.40000000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2291.5854842340254, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1164.9922071246701, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1620.9615981555712, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.790477557199411, "mean_processing_ms": 1.304111905920918, "mean_inference_ms": 0.6420983245089381}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 120000, "timers": {"learn_time_ms": 3.746, "learn_throughput": 17083.437, "update_time_ms": 0.67}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -40.74118423461914, "critic_loss": 0.002047807676717639, "mean_q": 40.55921173095703, "max_q": 60.89466857910156, "min_q": -1.3148999214172363, "mean_td_error": 0.009306373074650764, "td_error": "[ 0.00367355 -0.00533581  0.04043198  0.06733322 -0.06461334 -0.00426865\n  0.0485611   0.00624084  0.02346802 -0.02932739 -0.04164696  0.03131866\n -0.0004425  -0.0687027   0.01740837 -0.10468388 -0.00933075  0.04203415\n  0.00745773 -0.04817581  0.00954056  0.04706955 -0.06914902 -0.02916336\n  0.0295372   0.00724792 -0.05688858  0.01837066  0.04803467  0.0512886\n -0.16598892 -0.01581955 -0.00391388  0.0335083  -0.02072525 -0.09451675\n -0.0295248   0.04987717  0.07718945  0.13585663 -0.00145388  0.20037842\n  0.09539413 -0.03008652 -0.08168602 -0.01212692 -0.11544418  0.04611206\n  0.09799957  0.05610275  0.11417389  0.03519058  0.02085876  0.05681229\n  0.04932785  0.00686264 -0.03123474 -0.00593376  0.04863167  0.01741374\n -0.01234055  0.02269363  0.04449463  0.04023743]"}}, "num_steps_sampled": 120000, "num_steps_trained": 7488064, "last_target_update_ts": 120000, "num_target_updates": 117001}, "done": false, "episodes_total": 40, "training_iteration": 40, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-39-53", "timestamp": 1609817993, "time_this_iter_s": 53.63318967819214, "time_total_s": 2073.2123680114746, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc537d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 2073.2123680114746, "timesteps_since_restore": 0, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 8.076315789473686, "ram_util_percent": 29.418421052631583}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2345.617331663643, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1193.7879418695231, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2345.617331663643, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.792138579877932, "mean_processing_ms": 1.3044080746927755, "mean_inference_ms": 0.6427302007808537}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 123000, "timers": {"learn_time_ms": 4.055, "learn_throughput": 15781.78, "update_time_ms": 0.712}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -45.64002990722656, "critic_loss": 0.0026357206515967846, "mean_q": 45.39650344848633, "max_q": 60.57417678833008, "min_q": 0.5058988332748413, "mean_td_error": 0.0001455903984606266, "td_error": "[-0.14123154 -0.04832458  0.2693863   0.00731277 -0.01811981 -0.01464844\n  0.02280426  0.09500313 -0.02819824 -0.00949478  0.04611969 -0.01678848\n -0.01106644  0.06423187  0.01026535  0.04272842 -0.08315277  0.01856995\n  0.00846481 -0.01909256  0.049366    0.06792068  0.05710602  0.00633621\n  0.17880106 -0.07401276  0.03621674  0.01893997  0.008358   -0.18502808\n  0.04294968  0.05324355  0.00910568 -0.08680344 -0.06199646  0.00817108\n -0.00547028 -0.0116539   0.04281998 -0.00258636 -0.04125595  0.02466965\n -0.13012314  0.01825714  0.00187302  0.02914047 -0.01832581 -0.0689621\n  0.01960754 -0.00619507  0.08887482 -0.08353043 -0.0789299  -0.02823639\n -0.04022598  0.01245117 -0.07453918  0.09795761  0.08237839 -0.06518936\n  0.00853348 -0.00028229 -0.0948143   0.00963211]"}}, "num_steps_sampled": 123000, "num_steps_trained": 7680064, "last_target_update_ts": 123000, "num_target_updates": 120001}, "done": false, "episodes_total": 41, "training_iteration": 41, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-40-47", "timestamp": 1609818047, "time_this_iter_s": 54.142735719680786, "time_total_s": 2127.3551037311554, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc537048>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 2127.3551037311554, "timesteps_since_restore": 0, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 8.162820512820511, "ram_util_percent": 29.5}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2345.617331663643, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1195.4610262726158, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1264.057486799418, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.793695593806238, "mean_processing_ms": 1.304703032187395, "mean_inference_ms": 0.6433347623731673}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 126000, "timers": {"learn_time_ms": 3.431, "learn_throughput": 18651.065, "update_time_ms": 0.633}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -46.70235824584961, "critic_loss": 0.003532689530402422, "mean_q": 46.43409729003906, "max_q": 62.53684616088867, "min_q": 3.4869930744171143, "mean_td_error": 0.014879312366247177, "td_error": "[ 7.6334000e-02 -4.7100067e-02  2.1167755e-02 -3.6716843e-01\n  6.0134888e-02  1.6838074e-02 -6.4102173e-02  4.6848297e-02\n  5.1280975e-02  2.9998779e-02  1.2129974e-01  3.1906128e-02\n  6.8393707e-02  9.1770172e-02 -2.2178650e-02 -7.3402405e-02\n  4.7336578e-02 -1.1215210e-03  1.5136719e-01  4.3529510e-02\n  2.9794693e-02 -1.5365601e-02 -7.4886322e-02  1.6083908e-01\n -5.7399750e-02  1.5784073e-01  1.1081696e-02  6.3222885e-02\n  1.5937805e-02  1.3080978e-01 -5.2543640e-02  2.1862030e-02\n  7.6293945e-05 -8.8806152e-03  5.5225372e-02  5.9589386e-02\n  6.1317205e-02  3.7261963e-02 -2.8953552e-02 -3.3039093e-02\n -1.0643005e-02 -6.9656372e-03  2.7309418e-02 -1.5777588e-02\n  3.9081573e-02 -1.6609192e-02  3.8661957e-02  1.8169785e-01\n  5.6972504e-02 -1.9786835e-02 -1.1211395e-01  3.1013489e-03\n  2.1495819e-02 -1.3175964e-02  4.0283203e-03  5.5622101e-02\n -1.6879654e-01  3.2272339e-02  1.2912750e-02 -9.7682953e-02\n  3.0414581e-02  8.8802338e-02  7.7819824e-04  3.7536621e-03]"}}, "num_steps_sampled": 126000, "num_steps_trained": 7872064, "last_target_update_ts": 126000, "num_target_updates": 123001}, "done": false, "episodes_total": 42, "training_iteration": 42, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-41-40", "timestamp": 1609818100, "time_this_iter_s": 52.56036925315857, "time_total_s": 2179.915472984314, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f9d8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 2179.915472984314, "timesteps_since_restore": 0, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 8.249333333333334, "ram_util_percent": 29.5}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2345.617331663643, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1213.1569718008145, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1956.3866839851619, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.795233075375453, "mean_processing_ms": 1.3049835372187806, "mean_inference_ms": 0.6439126273851556}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 129000, "timers": {"learn_time_ms": 4.115, "learn_throughput": 15551.559, "update_time_ms": 0.757}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -44.35162353515625, "critic_loss": 0.0018144468776881695, "mean_q": 44.11079406738281, "max_q": 63.36798858642578, "min_q": -1.0409653186798096, "mean_td_error": 0.01715475507080555, "td_error": "[-0.00321198 -0.00399017 -0.06361681 -0.00066948  0.0503006  -0.0488472\n  0.10253334  0.02495575 -0.04567719  0.0872612   0.0441761   0.11958885\n  0.05611801  0.03066826 -0.03727341  0.05310822 -0.01931381 -0.00988388\n -0.05747223 -0.03492355  0.0111084   0.1164608   0.07468033 -0.0238533\n  0.04571915  0.04113388 -0.01142502 -0.15004349  0.03458405  0.02885818\n  0.04933929  0.04206085  0.05058289  0.01410675 -0.07146931  0.00887299\n  0.04652786 -0.00608826 -0.00281143 -0.05309677  0.01605988  0.03706741\n -0.06292725  0.060215    0.01817322  0.02184677 -0.09160614 -0.01639557\n  0.01042175  0.01719284  0.063591    0.02232361 -0.08548528  0.02011871\n  0.11453629  0.03715515  0.07382965 -0.00354767  0.07154083  0.03750992\n  0.08716583  0.01482773  0.10623741  0.03897476]"}}, "num_steps_sampled": 129000, "num_steps_trained": 8064064, "last_target_update_ts": 129000, "num_target_updates": 126001}, "done": false, "episodes_total": 43, "training_iteration": 43, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-42-32", "timestamp": 1609818152, "time_this_iter_s": 52.68730068206787, "time_total_s": 2232.602773666382, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fbf8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 2232.602773666382, "timesteps_since_restore": 0, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 8.265333333333334, "ram_util_percent": 29.583999999999996}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2345.617331663643, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1203.2788828236266, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [778.5210568045561, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.796682762180969, "mean_processing_ms": 1.3052684801567407, "mean_inference_ms": 0.6444728672495784}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 132000, "timers": {"learn_time_ms": 3.673, "learn_throughput": 17425.782, "update_time_ms": 0.685}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -43.59919357299805, "critic_loss": 0.0015487994533032179, "mean_q": 43.38216781616211, "max_q": 63.77926254272461, "min_q": -1.885178804397583, "mean_td_error": -0.005121245048940182, "td_error": "[-5.78536987e-02 -5.44586182e-02 -2.95410156e-02  5.53550720e-02\n -6.58531189e-02  3.45382690e-02 -8.48731995e-02  2.76880264e-02\n -1.01928711e-02  5.68790436e-02 -5.76019287e-02  1.55119300e-02\n -3.42864990e-02  2.61840820e-02  1.18093491e-02 -2.72254944e-02\n  1.22513771e-02  2.15873718e-02 -2.28881836e-05 -4.33540344e-02\n  4.00581360e-02 -6.83879852e-03  8.49533081e-03  1.64566040e-02\n -7.34558105e-02  8.42285156e-03 -1.48773193e-02 -1.85394287e-02\n -2.57377625e-02 -1.15127563e-02 -5.95474243e-03  1.40209198e-01\n -6.35375977e-02 -4.18090820e-02 -8.44383240e-02 -8.69560242e-02\n -4.66766357e-02  8.11920166e-02  6.76326752e-02 -5.30242920e-03\n -5.05752563e-02  1.64146423e-02 -8.71849060e-02  7.30514526e-03\n  2.75650024e-02 -6.38694763e-02 -4.57839966e-02  5.50003052e-02\n  3.44734192e-02 -5.73730469e-03 -2.38647461e-02 -1.05091095e-01\n -1.20277405e-02 -7.98721313e-02 -2.38488913e-02  4.46281433e-02\n  7.99484253e-02  1.29800320e-01  3.27529907e-02  9.91821289e-05\n  2.56233215e-02  1.23329163e-02 -2.15797424e-02  5.23605347e-02]"}}, "num_steps_sampled": 132000, "num_steps_trained": 8256064, "last_target_update_ts": 132000, "num_target_updates": 129001}, "done": false, "episodes_total": 44, "training_iteration": 44, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-43-26", "timestamp": 1609818206, "time_this_iter_s": 53.31109046936035, "time_total_s": 2285.913864135742, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fc80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 2285.913864135742, "timesteps_since_restore": 0, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 8.080263157894738, "ram_util_percent": 29.599999999999994}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2345.617331663643, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1219.2494883283207, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1921.9561305348493, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.798132881327845, "mean_processing_ms": 1.3055354482488657, "mean_inference_ms": 0.6450091092047305}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 135000, "timers": {"learn_time_ms": 4.095, "learn_throughput": 15629.612, "update_time_ms": 0.77}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -47.132850646972656, "critic_loss": 0.006360420025885105, "mean_q": 46.91388702392578, "max_q": 64.79156494140625, "min_q": -1.137101411819458, "mean_td_error": 0.059815943241119385, "td_error": "[ 0.16440582 -0.0484581  -0.06314087  0.05854797 -0.02240372 -0.00647354\n  0.18830109 -0.08697128  0.1254425  -0.04340363  0.07855606  0.13064194\n  0.12459183  0.02648544  0.02618408  0.05446243 -0.16671371 -0.07580566\n  0.1379776   0.01294708  0.13448715  0.033535    0.09939957  0.06555557\n  0.09860611  0.0283699   0.13485527  0.12385941  0.03680038  0.09102631\n  0.1080513   0.17224503 -0.06242371  0.01203156 -0.06145859  0.12868881\n  0.02302551  0.06192017  0.00821304  0.12827075  0.14523792  0.1887885\n  0.05804443  0.1826973   0.09835815 -0.09076691 -0.07018661  0.17004395\n  0.16043472  0.12724304 -0.05346298  0.2343216   0.24433213  0.10751724\n  0.09734726  0.0255394   0.23640776  0.08255386 -0.00424194 -0.13700104\n -0.04452133  0.03029633 -0.01803589  0.07704163]"}}, "num_steps_sampled": 135000, "num_steps_trained": 8448064, "last_target_update_ts": 135000, "num_target_updates": 132001}, "done": false, "episodes_total": 45, "training_iteration": 45, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-44-19", "timestamp": 1609818259, "time_this_iter_s": 52.87074542045593, "time_total_s": 2338.784609556198, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc585400>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 2338.784609556198, "timesteps_since_restore": 0, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 8.049333333333333, "ram_util_percent": 29.631999999999994}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2345.617331663643, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1231.9755164248104, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1804.646780766845, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.799568485173281, "mean_processing_ms": 1.3057923038686388, "mean_inference_ms": 0.6455296761771796}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 138000, "timers": {"learn_time_ms": 4.041, "learn_throughput": 15839.423, "update_time_ms": 0.618}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -48.56002426147461, "critic_loss": 0.0032226373441517353, "mean_q": 48.364349365234375, "max_q": 65.60537719726562, "min_q": 8.324667930603027, "mean_td_error": 0.038352057337760925, "td_error": "[ 0.09202576  0.16508484  0.00056458 -0.01786041  0.04927635  0.1066246\n  0.00544739 -0.01277161  0.05455017  0.054142    0.129673    0.03547668\n -0.02308655  0.0282526  -0.04912186  0.04277802  0.04217529  0.03310776\n  0.00542068  0.03030014  0.13426876  0.02111816 -0.02300262  0.01979828\n  0.01973343  0.11792755 -0.00046539  0.01589584 -0.03669357  0.06736183\n -0.02204514 -0.02516174  0.01852798  0.03775406  0.05506897  0.04677582\n  0.00310135  0.04767227  0.12035751 -0.05700302  0.12757492  0.04521561\n -0.00684738 -0.06296158 -0.07315063 -0.01583862 -0.10191727  0.06508636\n  0.04245377  0.0588913   0.07397842  0.31193542  0.11075592  0.11280441\n  0.12176514  0.09700298  0.05016708  0.12556076  0.06896591  0.02633667\n -0.06518555 -0.00235748 -0.03489685  0.04614258]"}}, "num_steps_sampled": 138000, "num_steps_trained": 8640064, "last_target_update_ts": 138000, "num_target_updates": 135001}, "done": false, "episodes_total": 46, "training_iteration": 46, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-45-12", "timestamp": 1609818312, "time_this_iter_s": 53.59579157829285, "time_total_s": 2392.380401134491, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5857b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 2392.380401134491, "timesteps_since_restore": 0, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 8.042857142857144, "ram_util_percent": 29.699999999999985}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2345.617331663643, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1173.7432856527228, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1504.939329863299, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.800822362406309, "mean_processing_ms": 1.3060511377821222, "mean_inference_ms": 0.6460361560464306}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 141000, "timers": {"learn_time_ms": 4.02, "learn_throughput": 15920.022, "update_time_ms": 0.651}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -48.197635650634766, "critic_loss": 0.005159519612789154, "mean_q": 47.96580123901367, "max_q": 65.88723754882812, "min_q": 1.8549911975860596, "mean_td_error": 0.07139477133750916, "td_error": "[ 0.0706234   0.06119919  0.08189774  0.03929138  0.09548569  0.03027725\n  0.19890213  0.09906387  0.03407288 -0.13374329  0.08560181  0.07015991\n -0.05289459  0.11923981  0.03111649  0.18318939  0.05971146  0.07899094\n  0.0812912  -0.00088501  0.08124924  0.0150032   0.07387543  0.15751266\n  0.06581497  0.09726715  0.16486359  0.06106949  0.15530014  0.00954819\n  0.04576111  0.17380118 -0.02696228  0.00201416  0.09423065  0.01358414\n  0.06672668  0.12995148  0.05725479  0.0003643   0.01114273  0.03451538\n  0.242836    0.08654022  0.03638458  0.31596565  0.11257553  0.02486038\n  0.08860397  0.17839432  0.07575226  0.02643967  0.10495377  0.12226486\n  0.05235672  0.04721451  0.02544403 -0.0004425   0.10018921  0.07026863\n  0.03787422  0.0149765   0.02660751  0.06272507]"}}, "num_steps_sampled": 141000, "num_steps_trained": 8832064, "last_target_update_ts": 141000, "num_target_updates": 138001}, "done": false, "episodes_total": 47, "training_iteration": 47, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-46-05", "timestamp": 1609818365, "time_this_iter_s": 52.57158803939819, "time_total_s": 2444.951989173889, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f598>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 2444.951989173889, "timesteps_since_restore": 0, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 8.132, "ram_util_percent": 29.69999999999999}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2345.617331663643, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1197.6665216891163, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2322.0586153995982, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.802158992578867, "mean_processing_ms": 1.3063030880525153, "mean_inference_ms": 0.6465271310146893}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 144000, "timers": {"learn_time_ms": 3.875, "learn_throughput": 16516.462, "update_time_ms": 0.632}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -47.185829162597656, "critic_loss": 0.7485209107398987, "mean_q": 46.964134216308594, "max_q": 65.92145538330078, "min_q": -0.18851281702518463, "mean_td_error": 0.14217190444469452, "td_error": "[ 2.82592773e-02  8.65097046e-02 -6.15196228e-02 -1.94511414e-02\n  3.84140015e-02  8.13961029e-02 -3.64379883e-02  7.23342896e-02\n -3.68946195e-02  9.29522514e-03  2.76947021e-03  3.32870483e-02\n -8.74328613e-03  8.60137939e-02 -6.49642944e-03  2.17590332e-02\n  6.89315796e-03  9.77328777e+00  5.65261841e-02 -3.59687805e-02\n -1.67655945e-02  1.16157532e-02 -1.78031921e-02 -2.33764648e-02\n -9.94567871e-02  4.19044495e-02 -6.91146851e-02 -6.65283203e-03\n  1.09798431e-01 -1.17311716e-01 -7.56835938e-02 -8.49418640e-02\n -6.35910034e-03 -2.32200623e-02 -6.26029968e-02 -5.13839722e-02\n -1.43775940e-01 -6.15692139e-03  1.40342712e-02 -7.61413574e-02\n  7.90405273e-02 -1.18072510e-01  7.03430176e-02  3.75976562e-02\n -3.75061035e-02 -2.68516541e-02 -2.06413269e-02 -7.81440735e-02\n  8.11386108e-03  3.32031250e-02  1.21345520e-01 -5.32684326e-02\n -1.83486938e-03 -2.11688995e-01  1.74179077e-02 -8.52966309e-03\n  6.31942749e-02  1.10626221e-03 -1.23523712e-01  4.13284302e-02\n -8.40759277e-02  3.02658081e-02  1.27601624e-02 -4.04167175e-02]"}}, "num_steps_sampled": 144000, "num_steps_trained": 9024064, "last_target_update_ts": 144000, "num_target_updates": 141001}, "done": false, "episodes_total": 48, "training_iteration": 48, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-46-59", "timestamp": 1609818419, "time_this_iter_s": 54.267794370651245, "time_total_s": 2499.2197835445404, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 2499.2197835445404, "timesteps_since_restore": 0, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 8.092207792207791, "ram_util_percent": 29.790909090909103}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2345.617331663643, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1205.0795280051416, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1560.9038311743677, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.8034665561163905, "mean_processing_ms": 1.3065452797845332, "mean_inference_ms": 0.6470007397135428}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 147000, "timers": {"learn_time_ms": 4.086, "learn_throughput": 15663.904, "update_time_ms": 0.679}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -47.04717254638672, "critic_loss": 0.004580847918987274, "mean_q": 46.76451110839844, "max_q": 67.82827758789062, "min_q": -1.126511573791504, "mean_td_error": -0.0018342230468988419, "td_error": "[-0.00040436  0.03309631 -0.06076813 -0.01362228 -0.01646042  0.03456497\n  0.01058578  0.03601456 -0.02131653  0.04123306 -0.3868637   0.04799652\n  0.11028576 -0.00119019 -0.01552582  0.00334167  0.10331345  0.03049088\n  0.01417923 -0.02542114 -0.04846954 -0.13412476  0.00492275  0.07791901\n -0.03526688 -0.00128555  0.00839615 -0.23596764  0.03656006  0.03093719\n  0.08145905  0.17953682  0.09370422  0.008358    0.08496094 -0.01417542\n  0.05619431  0.01287842 -0.0648613   0.01972198  0.00872421 -0.05029297\n -0.32951164  0.04895306  0.02259827 -0.01233673  0.02861786  0.04571915\n  0.1774559   0.01301193  0.09424019 -0.17501068 -0.02498627 -0.03218079\n  0.00918198  0.04854965  0.03934479  0.04582214 -0.13984108  0.00523376\n  0.01350021  0.01263046  0.00892401 -0.06066513]"}}, "num_steps_sampled": 147000, "num_steps_trained": 9216064, "last_target_update_ts": 147000, "num_target_updates": 144001}, "done": false, "episodes_total": 49, "training_iteration": 49, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-47-52", "timestamp": 1609818472, "time_this_iter_s": 53.02264428138733, "time_total_s": 2552.2424278259277, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc543268>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 2552.2424278259277, "timesteps_since_restore": 0, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 8.111842105263158, "ram_util_percent": 29.800000000000015}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2357.9920242765315, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1228.1377779305694, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2357.9920242765315, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.804817169447395, "mean_processing_ms": 1.3067786104171153, "mean_inference_ms": 0.6474591553031287}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 150000, "timers": {"learn_time_ms": 4.01, "learn_throughput": 15960.82, "update_time_ms": 0.729}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -48.04412078857422, "critic_loss": 0.0027175121940672398, "mean_q": 47.785160064697266, "max_q": 66.51717376708984, "min_q": 1.383873701095581, "mean_td_error": 0.010583840310573578, "td_error": "[ 0.10163498 -0.00749969  0.09262681 -0.00329208 -0.00702667 -0.08498383\n -0.04404449  0.08970261  0.01023102 -0.08251953 -0.06464386  0.04517746\n  0.01594162 -0.14122772 -0.05747604 -0.0033226  -0.04893494  0.11176682\n  0.10284042  0.1457138   0.009655   -0.03749466  0.04267883  0.00124359\n -0.09296608  0.02902603  0.11024284  0.07239151  0.01355362  0.01695251\n  0.01379395  0.061517    0.08637238 -0.02902603  0.02123642 -0.02778625\n  0.01797867  0.04549408  0.10622025 -0.03662491  0.09239578  0.07044601\n  0.03342438  0.10485458  0.01081848 -0.03177643  0.09984589 -0.08685684\n  0.0436554   0.1016655  -0.04116821  0.01027298 -0.01403809 -0.05114365\n  0.0033226   0.06231594 -0.04021168 -0.14459229  0.07174301 -0.05543518\n  0.05433655 -0.09851456 -0.16422272  0.0511055 ]"}}, "num_steps_sampled": 150000, "num_steps_trained": 9408064, "last_target_update_ts": 150000, "num_target_updates": 147001}, "done": false, "episodes_total": 50, "training_iteration": 50, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-48-46", "timestamp": 1609818526, "time_this_iter_s": 53.822205543518066, "time_total_s": 2606.064633369446, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc543620>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 2606.064633369446, "timesteps_since_restore": 0, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 8.089610389610389, "ram_util_percent": 29.849350649350658}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2357.9920242765315, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1247.7033985991525, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2225.984432028312, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.806224470239793, "mean_processing_ms": 1.307001901746278, "mean_inference_ms": 0.6479050428596496}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 153000, "timers": {"learn_time_ms": 3.992, "learn_throughput": 16030.783, "update_time_ms": 0.685}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -48.91417694091797, "critic_loss": 0.0028673792257905006, "mean_q": 48.64543533325195, "max_q": 69.43399810791016, "min_q": -2.1108741760253906, "mean_td_error": 0.0018074619583785534, "td_error": "[ 0.01286316 -0.10119247  0.1505928  -0.02318573  0.04519272 -0.14605713\n -0.01433563  0.11559296 -0.03982544  0.03244781  0.06962967 -0.02116394\n  0.00412369  0.03429413  0.11663839  0.09071732 -0.00022125  0.03616333\n -0.09403229 -0.19599152  0.07812881  0.04035187  0.03773499 -0.04813004\n -0.04001999 -0.02257919 -0.05316925  0.00377345  0.13954163 -0.04960155\n  0.21201706 -0.08942032 -0.0364418  -0.11450958  0.02864075  0.00125504\n  0.00260544  0.04735947 -0.03826141 -0.02005768 -0.01773071  0.12245941\n  0.09148407 -0.0135498   0.09153748 -0.05084038 -0.01115799  0.06065369\n -0.0616951   0.03174591 -0.03488159  0.00390434 -0.00484085  0.05444717\n -0.01280975 -0.02246857 -0.01177216 -0.10031509 -0.0243187  -0.09394836\n  0.01337433 -0.07419586 -0.00671768  0.03584552]"}}, "num_steps_sampled": 153000, "num_steps_trained": 9600064, "last_target_update_ts": 153000, "num_target_updates": 150001}, "done": false, "episodes_total": 51, "training_iteration": 51, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-49-40", "timestamp": 1609818580, "time_this_iter_s": 54.029152631759644, "time_total_s": 2660.0937860012054, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc543a60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 2660.0937860012054, "timesteps_since_restore": 0, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 8.28051948051948, "ram_util_percent": 29.90000000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2357.9920242765315, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1231.9050197473687, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [426.1876983063981, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.807479526713736, "mean_processing_ms": 1.3072151775113965, "mean_inference_ms": 0.6483338049265419}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 156000, "timers": {"learn_time_ms": 3.74, "learn_throughput": 17110.442, "update_time_ms": 0.661}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -52.31061935424805, "critic_loss": 0.002299955114722252, "mean_q": 52.04238510131836, "max_q": 70.0413818359375, "min_q": 12.929200172424316, "mean_td_error": -0.002293810248374939, "td_error": "[ 0.06450272 -0.05680084  0.17383957 -0.02365112 -0.0333252  -0.12404633\n -0.083251   -0.00786591  0.00291443  0.03587341 -0.00508499 -0.00365448\n  0.05193329 -0.04074478 -0.06139755  0.01100922 -0.06394196 -0.01152802\n  0.08782959 -0.01226807 -0.04294968  0.1662674   0.07097244 -0.04204369\n -0.01705551 -0.06106949  0.17160034 -0.0413208  -0.00058746 -0.03176498\n  0.11154175 -0.01203156 -0.06330109  0.02070236  0.05054474 -0.00426483\n  0.01766968 -0.05328369 -0.01355362 -0.03843689 -0.05403519 -0.08917999\n  0.09420395  0.01870728  0.08617401 -0.06406021  0.03316116  0.00371552\n  0.06876373 -0.04273987 -0.07720947 -0.00708771 -0.02012634 -0.08687592\n  0.03510284  0.00921249 -0.01632309  0.00115204 -0.02946091  0.02458954\n  0.08470535 -0.02661133 -0.05712891 -0.12343025]"}}, "num_steps_sampled": 156000, "num_steps_trained": 9792064, "last_target_update_ts": 156000, "num_target_updates": 153001}, "done": false, "episodes_total": 52, "training_iteration": 52, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-50-32", "timestamp": 1609818632, "time_this_iter_s": 51.9316623210907, "time_total_s": 2712.025448322296, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc543378>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 2712.025448322296, "timesteps_since_restore": 0, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 8.004054054054054, "ram_util_percent": 29.902702702702705}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2357.9920242765315, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1240.8645369157896, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1706.759429673675, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.808732247566438, "mean_processing_ms": 1.3074203018208457, "mean_inference_ms": 0.6487496825507625}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 159000, "timers": {"learn_time_ms": 3.932, "learn_throughput": 16275.523, "update_time_ms": 0.632}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -48.82952117919922, "critic_loss": 0.0029860902577638626, "mean_q": 48.608245849609375, "max_q": 70.42034149169922, "min_q": -1.952383041381836, "mean_td_error": -0.001150239259004593, "td_error": "[-0.04709721 -0.0114212   0.02838898  0.08578873  0.01929855 -0.12604904\n -0.01242065  0.00464249  0.09392548  0.01209259  0.13326263  0.05937195\n -0.06888962  0.0824585   0.02241898  0.05957413 -0.10381317 -0.02870178\n -0.061409    0.04907227 -0.00525284 -0.00434494  0.05633926  0.05472565\n  0.02659988 -0.01834488 -0.02230453  0.08182526 -0.03488159 -0.05208969\n -0.14106178  0.03120804  0.05599213  0.07442093  0.09753418 -0.10209656\n  0.04376984 -0.02318954  0.00634384 -0.05433273  0.07444763 -0.05784607\n -0.0330162  -0.29531097  0.06361008  0.0037117  -0.06989288 -0.11892319\n -0.01505661 -0.02119827 -0.07484436  0.09288144 -0.02905655  0.01498413\n -0.02407074 -0.07523346  0.00122261  0.01256514  0.11776733  0.07687378\n -0.02960205 -0.08817673  0.0150919   0.12410355]"}}, "num_steps_sampled": 159000, "num_steps_trained": 9984064, "last_target_update_ts": 159000, "num_target_updates": 156001}, "done": false, "episodes_total": 53, "training_iteration": 53, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-51-25", "timestamp": 1609818685, "time_this_iter_s": 53.42228937149048, "time_total_s": 2765.4477376937866, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc546400>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 2765.4477376937866, "timesteps_since_restore": 0, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 8.08421052631579, "ram_util_percent": 29.998684210526317}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2357.9920242765315, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1245.499440619757, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1491.1493369300204, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.809979238684501, "mean_processing_ms": 1.3076142061605236, "mean_inference_ms": 0.6491563383304}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 162000, "timers": {"learn_time_ms": 4.644, "learn_throughput": 13781.681, "update_time_ms": 0.646}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -51.20396423339844, "critic_loss": 0.004305300768464804, "mean_q": 51.0052490234375, "max_q": 71.06829071044922, "min_q": 15.927709579467773, "mean_td_error": 0.06405054032802582, "td_error": "[ 0.03162384  0.07909775  0.02637482  0.0286026  -0.00463867  0.04876709\n  0.08658981 -0.00341797  0.12789154  0.07299042  0.12362671  0.0928154\n  0.0894928   0.07578278  0.06127548  0.08436966  0.1634903   0.00633621\n -0.02540588  0.1851635   0.05506516  0.08009338  0.16006851  0.16220093\n  0.10591888  0.13978958  0.06213379  0.03089905  0.12242889 -0.10935974\n  0.06538582  0.02136993  0.04854202 -0.01517105  0.01680374  0.23610687\n  0.0736084   0.07874298  0.0589447   0.13518524  0.01882172  0.1509552\n  0.0129776   0.1646862  -0.02088928  0.11029053  0.03641129  0.03804016\n -0.05937862  0.01224518  0.139637    0.15803528  0.04269028  0.03440475\n  0.05630875  0.01196289  0.06687927  0.02006149 -0.05158615  0.09817696\n  0.01078415  0.03588104  0.08198929  0.05026436]"}}, "num_steps_sampled": 162000, "num_steps_trained": 10176064, "last_target_update_ts": 162000, "num_target_updates": 159001}, "done": false, "episodes_total": 54, "training_iteration": 54, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-52-19", "timestamp": 1609818739, "time_this_iter_s": 54.06230139732361, "time_total_s": 2819.5100390911102, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5467b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 2819.5100390911102, "timesteps_since_restore": 0, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 8.12857142857143, "ram_util_percent": 30.0}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2357.9920242765315, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1262.5655427834877, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2184.1350596249517, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.811243201004056, "mean_processing_ms": 1.3078052259351642, "mean_inference_ms": 0.6495525285185533}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 165000, "timers": {"learn_time_ms": 3.683, "learn_throughput": 17379.413, "update_time_ms": 0.608}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -51.25511932373047, "critic_loss": 0.0019340977305546403, "mean_q": 51.04247283935547, "max_q": 70.49623107910156, "min_q": 2.8186607360839844, "mean_td_error": 0.016500674188137054, "td_error": "[ 0.034935    0.0263176  -0.01271439 -0.00505447  0.05445862 -0.09047699\n  0.01468658  0.01850891  0.01598358  0.08482647  0.11422729 -0.01900482\n -0.03520584 -0.0174408  -0.02161407  0.09829712  0.07766342 -0.02096558\n  0.03981781  0.09796143  0.04190922 -0.03332901  0.02492523 -0.08494186\n  0.00222969 -0.0575943   0.00291824  0.13097     0.04380417  0.01477432\n -0.05412674 -0.00192642  0.05994415  0.02944946 -0.02410889  0.0855217\n  0.06156206  0.0565834   0.10135269 -0.11535645  0.04767609  0.02845383\n  0.03234863  0.09989929 -0.04653931  0.05683136 -0.00245667  0.03781509\n -0.03786087  0.02754211  0.10441971 -0.01512146  0.05538177 -0.02353668\n  0.02658081 -0.00510406 -0.11542511  0.05091095 -0.06312656  0.07380295\n  0.0209198  -0.0209465   0.05301666 -0.06920624]"}}, "num_steps_sampled": 165000, "num_steps_trained": 10368064, "last_target_update_ts": 165000, "num_target_updates": 162001}, "done": false, "episodes_total": 55, "training_iteration": 55, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-53-13", "timestamp": 1609818793, "time_this_iter_s": 53.91927123069763, "time_total_s": 2873.429310321808, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc543730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 2873.429310321808, "timesteps_since_restore": 0, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 8.03896103896104, "ram_util_percent": 30.062337662337654}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2357.9920242765315, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1280.844502211628, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2286.187270759327, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.8125431034526605, "mean_processing_ms": 1.3079889972557714, "mean_inference_ms": 0.6499410027339412}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 168000, "timers": {"learn_time_ms": 3.907, "learn_throughput": 16380.801, "update_time_ms": 0.547}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -53.766727447509766, "critic_loss": 0.001770728500559926, "mean_q": 53.55319595336914, "max_q": 72.77236938476562, "min_q": -1.6955748796463013, "mean_td_error": -0.006535444408655167, "td_error": "[ 0.06024933  0.02414703  0.06279278 -0.10770416 -0.01374626  0.03656006\n -0.04488373  0.0357399  -0.08143616 -0.02771759  0.04420853 -0.05077362\n  0.02241516  0.01346588 -0.02804565  0.06602859 -0.03813553  0.05882263\n -0.1044426  -0.0545547  -0.07677078 -0.04647064  0.04521561  0.00675964\n  0.19168854 -0.05153656  0.05256653  0.02618408  0.00133514 -0.0514946\n -0.05451965  0.03505707 -0.05067062 -0.01425552 -0.0920372  -0.00433731\n -0.07907104 -0.05134583  0.0384903  -0.0176506   0.02513123 -0.02285385\n -0.07562256 -0.01454163 -0.02789688  0.00882721  0.08825684 -0.03885269\n -0.02433014 -0.05738068 -0.02384186  0.10043716 -0.04096985  0.01776123\n -0.00654221  0.03388977 -0.05974579 -0.01517868 -0.07669067  0.0006485\n -0.02183533  0.04809809  0.02523708  0.05960083]"}}, "num_steps_sampled": 168000, "num_steps_trained": 10560064, "last_target_update_ts": 168000, "num_target_updates": 165001}, "done": false, "episodes_total": 56, "training_iteration": 56, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-54-08", "timestamp": 1609818848, "time_this_iter_s": 54.082345962524414, "time_total_s": 2927.5116562843323, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc543d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 2927.5116562843323, "timesteps_since_restore": 0, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 8.119480519480522, "ram_util_percent": 30.09999999999999}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2357.9920242765315, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1293.441285326124, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1998.8611397378997, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.813853455589413, "mean_processing_ms": 1.3081719805318024, "mean_inference_ms": 0.6503192607513893}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 171000, "timers": {"learn_time_ms": 3.855, "learn_throughput": 16603.399, "update_time_ms": 0.712}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -53.193912506103516, "critic_loss": 0.008309165947139263, "mean_q": 53.01044845581055, "max_q": 73.53495025634766, "min_q": 0.49624839425086975, "mean_td_error": 0.10509110242128372, "td_error": "[ 0.16549301  0.01506042  0.08902359  0.07491302  0.08919525  0.12200928\n  0.15712738  0.05525017  0.00983047  0.19813156  0.098526    0.12490082\n  0.04984283  0.09695581  0.06509399  0.1218338   0.17097855  0.06887341\n  0.11650085  0.21091843  0.18103027  0.00328827  0.04230118  0.07594681\n  0.00988007  0.14595413  0.08354378  0.10416794  0.07197952  0.0260849\n  0.16151428 -0.02833557  0.13048172 -0.0010376   0.09476471  0.18685532\n  0.07098389  0.11618042  0.0970459   0.11617279  0.02385712  0.2870903\n  0.15914917  0.02573776  0.14611053  0.14974976  0.10024643  0.12014771\n  0.15465546  0.36359787  0.04219437  0.03564453  0.22278595 -0.01591492\n  0.04824066  0.07974625  0.1578331   0.08483124  0.22557068  0.13217163\n  0.07455444  0.13010025  0.06643677  0.12203217]"}}, "num_steps_sampled": 171000, "num_steps_trained": 10752064, "last_target_update_ts": 171000, "num_target_updates": 168001}, "done": false, "episodes_total": 57, "training_iteration": 57, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-55-01", "timestamp": 1609818901, "time_this_iter_s": 53.90442132949829, "time_total_s": 2981.4160776138306, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc543048>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 2981.4160776138306, "timesteps_since_restore": 0, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 8.01038961038961, "ram_util_percent": 30.128571428571412}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2357.9920242765315, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1286.285344996102, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [878.3967461848575, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.815107424554487, "mean_processing_ms": 1.3083618520620603, "mean_inference_ms": 0.6506897493438695}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 174000, "timers": {"learn_time_ms": 3.982, "learn_throughput": 16071.766, "update_time_ms": 0.695}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -52.991817474365234, "critic_loss": 29.378894805908203, "mean_q": 52.758636474609375, "max_q": 72.74449157714844, "min_q": 9.578516006469727, "mean_td_error": 0.9384686946868896, "td_error": "[-9.33322906e-02 -1.15318298e-01 -6.63681030e-02  1.06052399e-01\n -5.31997681e-02 -1.67541504e-02 -7.05718994e-02 -1.49627686e-01\n -9.44252014e-02  9.96208191e-02  3.67393494e-02 -1.50604248e-01\n  1.10931396e-02  6.87026978e-02  2.12593079e-02  9.20104980e-03\n -9.46044922e-04 -4.10690308e-02 -1.48056030e-01 -9.78927612e-02\n  1.02669716e-01  1.34372711e-02  6.13197746e+01  1.14402771e-02\n  2.51235962e-02  9.94491577e-03  2.34756470e-02  9.51690674e-02\n -3.29971313e-02  3.95727158e-02  2.13203430e-02  7.05833435e-02\n  1.17454529e-02 -1.49604797e-01  4.55741882e-02 -7.51113892e-02\n -5.06858826e-02 -2.29034424e-02 -3.00865173e-02  4.94499207e-02\n -3.59535217e-02 -9.10491943e-02  3.61633301e-03 -2.92816162e-02\n -1.51786804e-02 -9.44595337e-02 -6.57577515e-02 -6.88476562e-02\n -1.46636963e-02  2.31628418e-02  4.46777344e-02 -4.11415100e-02\n  7.06863403e-02  4.21333313e-02 -5.83534241e-02 -2.01759338e-02\n  2.84385681e-02 -1.72157288e-01 -1.03599548e-01 -1.89598083e-01\n  6.08062744e-03  8.40301514e-02  7.47947693e-02 -4.78019714e-02]"}}, "num_steps_sampled": 174000, "num_steps_trained": 10944064, "last_target_update_ts": 174000, "num_target_updates": 171001}, "done": false, "episodes_total": 58, "training_iteration": 58, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-55-55", "timestamp": 1609818955, "time_this_iter_s": 53.28231859207153, "time_total_s": 3034.698396205902, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f400>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 3034.698396205902, "timesteps_since_restore": 0, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 8.021052631578947, "ram_util_percent": 30.199999999999985}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2357.9920242765315, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1285.13170550643, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1218.2206151054615, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.816295651749442, "mean_processing_ms": 1.308550267597167, "mean_inference_ms": 0.6510505064494674}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 177000, "timers": {"learn_time_ms": 3.981, "learn_throughput": 16076.097, "update_time_ms": 0.713}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -47.768741607666016, "critic_loss": 1.4907183647155762, "mean_q": 47.49127960205078, "max_q": 73.9393310546875, "min_q": -2.3037235736846924, "mean_td_error": 0.2285986691713333, "td_error": "[ 1.27120972e-01 -1.66301727e-02  2.90603638e-02  1.00116730e-02\n -7.86895752e-02  1.03168488e-02  2.10266113e-02  3.84445190e-02\n  5.61904907e-02 -1.53019011e-01  1.17200851e-01  1.08833313e-02\n  1.13105774e-02  6.63986206e-02 -2.69317627e-03  5.02624512e-02\n  4.21905518e-03  5.39245605e-02  2.22892761e-02  1.28021240e-01\n  5.52062988e-02  7.44476318e-02  6.06536865e-03  8.14208984e-02\n -2.86827087e-02  6.59561157e-02 -2.85644531e-02  2.52609253e-02\n -4.73527908e-02  7.06863403e-02 -4.74166870e-02  3.40461731e-02\n -7.07626343e-02 -5.83229065e-02  7.41271973e-02 -5.91278076e-03\n  2.88724899e-02  1.37252808e-01 -1.09323502e-01  2.18124390e-02\n -1.38092041e-02 -2.63862610e-02 -2.39467621e-02 -8.81958008e-03\n  5.01298904e-02  1.76239014e-02 -1.05422974e-01  2.64739990e-03\n  1.38002081e+01  1.30252838e-01  8.61358643e-02  1.24275208e-01\n  5.84487915e-02  1.60903931e-02  1.17248535e-01  7.49435425e-02\n -1.30432129e-01  1.49154663e-02  1.09405518e-02  3.35607529e-02\n -2.13668823e-01 -5.69267273e-02 -1.27342224e-01  1.51824951e-02]"}}, "num_steps_sampled": 177000, "num_steps_trained": 11136064, "last_target_update_ts": 177000, "num_target_updates": 174001}, "done": false, "episodes_total": 59, "training_iteration": 59, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-56-48", "timestamp": 1609819008, "time_this_iter_s": 53.31702208518982, "time_total_s": 3088.015418291092, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004ff28>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 3088.015418291092, "timesteps_since_restore": 0, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 7.867105263157894, "ram_util_percent": 30.199999999999985}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2357.9920242765315, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1292.960549049755, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1754.8623181059365, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.817483960048549, "mean_processing_ms": 1.3087349426809958, "mean_inference_ms": 0.6514042271115091}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 180000, "timers": {"learn_time_ms": 3.617, "learn_throughput": 17695.852, "update_time_ms": 0.632}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -53.07500076293945, "critic_loss": 0.0015981907490640879, "mean_q": 52.86343765258789, "max_q": 74.69686126708984, "min_q": 2.164633274078369, "mean_td_error": 0.014344882220029831, "td_error": "[ 0.0137291   0.04968262 -0.01149368  0.08423996  0.02405548  0.02597809\n  0.08820724 -0.06992722 -0.11817169  0.04694366 -0.01004028 -0.02148819\n  0.04605103  0.05277252  0.00867462  0.01355743  0.0465889  -0.01065445\n -0.04584503  0.00089073 -0.01042175  0.01870346  0.01612854  0.0457077\n  0.0957489  -0.00803375  0.02445984 -0.11208344  0.06019592  0.04375458\n  0.02317047  0.05267334  0.00482941  0.06985474  0.05509567  0.04622269\n  0.02262497  0.02427673  0.05113983  0.06863213 -0.00073242  0.03642273\n -0.01534271  0.11519623 -0.04968262  0.09306335 -0.01493835  0.05292416\n  0.0450058   0.11229324  0.03295135  0.02108765 -0.03414154 -0.09892273\n -0.03030014 -0.025383    0.04529572 -0.02256775 -0.05853653 -0.03076005\n -0.05407715 -0.03544617  0.01256943  0.01566315]"}}, "num_steps_sampled": 180000, "num_steps_trained": 11328064, "last_target_update_ts": 180000, "num_target_updates": 177001}, "done": false, "episodes_total": 60, "training_iteration": 60, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-57-42", "timestamp": 1609819062, "time_this_iter_s": 54.34627866744995, "time_total_s": 3142.361696958542, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 3142.361696958542, "timesteps_since_restore": 0, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 8.015384615384617, "ram_util_percent": 30.267948717948737}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2357.9920242765315, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1302.1485151704785, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1853.4264824138777, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.818671074974384, "mean_processing_ms": 1.3089149713729777, "mean_inference_ms": 0.6517511697358516}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 183000, "timers": {"learn_time_ms": 3.74, "learn_throughput": 17112.623, "update_time_ms": 0.652}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -52.772457122802734, "critic_loss": 0.010091225616633892, "mean_q": 52.55079650878906, "max_q": 75.4964828491211, "min_q": -0.22912749648094177, "mean_td_error": -0.12248460948467255, "td_error": "[-0.03787994 -0.11978149 -0.12666321 -0.09740067 -0.1537323  -0.09609222\n  0.01208496 -0.0602684   0.01171112 -0.0929985  -0.0846138  -0.00687027\n -0.1857338  -0.1706694  -0.17465305 -0.21940231 -0.0318222  -0.13236618\n -0.077034   -0.15058899 -0.20264435  0.0375824  -0.00944519 -0.07029724\n -0.10029984 -0.25890732 -0.0150528  -0.20348358 -0.09331322 -0.21437073\n -0.18037033 -0.1565094  -0.22405815 -0.19524384 -0.19402313 -0.1483345\n  0.00441742 -0.11775589 -0.17258072 -0.11623383 -0.1444931  -0.08480835\n -0.16412735 -0.12850189 -0.1415329  -0.09606552 -0.1964531  -0.08337402\n -0.16471481 -0.14749146 -0.19340134 -0.01916504 -0.12695312 -0.13065338\n -0.10896301 -0.15828705 -0.1957456  -0.15866089 -0.21968079 -0.12172699\n -0.00676727 -0.13936234 -0.1818161  -0.10057068]"}}, "num_steps_sampled": 183000, "num_steps_trained": 11520064, "last_target_update_ts": 183000, "num_target_updates": 180001}, "done": false, "episodes_total": 61, "training_iteration": 61, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-58-37", "timestamp": 1609819117, "time_this_iter_s": 54.126452684402466, "time_total_s": 3196.4881496429443, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004ff28>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 3196.4881496429443, "timesteps_since_restore": 0, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 7.742857142857144, "ram_util_percent": 30.300000000000015}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2357.9920242765315, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1306.6201938571899, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1579.3925937465838, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.819826655785283, "mean_processing_ms": 1.309092911000891, "mean_inference_ms": 0.6520899596453373}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 186000, "timers": {"learn_time_ms": 3.801, "learn_throughput": 16838.994, "update_time_ms": 0.652}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -53.90447998046875, "critic_loss": 0.017885755747556686, "mean_q": 53.62158966064453, "max_q": 75.2842025756836, "min_q": 2.579486608505249, "mean_td_error": 0.14814196527004242, "td_error": "[ 0.17831802 -0.02225494  0.15390778  0.22531033  0.25259018  0.11429596\n  0.02747726  0.27566528  0.05430984  0.29402924  0.14750671  0.0022583\n  0.22696686  0.28392005  0.22677612  0.192276    0.03777313  0.16965866\n  0.21681976  0.15538025  0.23738098  0.04659271  0.09239197  0.097229\n  0.1317215  -0.11232758 -0.00795746 -0.08217621  0.14551163  0.03231049\n  0.5017967   0.05128479  0.24599075  0.11167526  0.13530731  0.283432\n  0.0010376   0.18270874  0.0087204   0.15512848  0.0999794   0.08117294\n -0.10807037  0.14978027  0.18515587  0.12974167  0.38225937  0.23748398\n  0.31134987  0.22153854  0.3437996   0.16452026  0.289711    0.0785141\n  0.01528168  0.08531189  0.21283722  0.1993599   0.19984055  0.24053955\n  0.13705444  0.11305618  0.05962372  0.18050003]"}}, "num_steps_sampled": 186000, "num_steps_trained": 11712064, "last_target_update_ts": 186000, "num_target_updates": 183001}, "done": false, "episodes_total": 62, "training_iteration": 62, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_12-59-30", "timestamp": 1609819170, "time_this_iter_s": 53.60954833030701, "time_total_s": 3250.0976979732513, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 3250.0976979732513, "timesteps_since_restore": 0, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 7.864935064935065, "ram_util_percent": 30.318181818181824}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2492.372862438557, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1325.4416647870528, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2492.372862438557, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.82099426454146, "mean_processing_ms": 1.30926428853314, "mean_inference_ms": 0.6524183657844952}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 189000, "timers": {"learn_time_ms": 4.018, "learn_throughput": 15928.335, "update_time_ms": 0.694}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -52.726295471191406, "critic_loss": 0.004220160190016031, "mean_q": 52.524269104003906, "max_q": 76.49126434326172, "min_q": -0.6357225775718689, "mean_td_error": -0.05680267512798309, "td_error": "[ 0.01112366 -0.07824707  0.00637436 -0.04199982 -0.16215515  0.03697586\n  0.07743835 -0.11287689 -0.10757446 -0.04657364 -0.04291916 -0.06476593\n -0.07061005  0.05077362 -0.02771759 -0.12453079  0.01782227 -0.09248352\n  0.04343414  0.00127792  0.06395912 -0.06665421 -0.03811264  0.04078674\n -0.0337677  -0.10060501  0.00864029  0.03497145 -0.05370331 -0.1014328\n -0.2000618  -0.17239761 -0.14151001 -0.04716492 -0.03451157 -0.17804718\n -0.13602829 -0.05619049 -0.0365448   0.0641098  -0.01532745 -0.0811615\n -0.1342392  -0.08536148 -0.08537292 -0.00090802 -0.05815887 -0.03475952\n -0.01001358 -0.10452271 -0.0221405  -0.06251526  0.07973194 -0.17381287\n -0.14112473 -0.05754089 -0.03918076 -0.13398743 -0.10405731 -0.09849548\n -0.02579498 -0.18179321 -0.12091827 -0.0324173 ]"}}, "num_steps_sampled": 189000, "num_steps_trained": 11904064, "last_target_update_ts": 189000, "num_target_updates": 186001}, "done": false, "episodes_total": 63, "training_iteration": 63, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-00-24", "timestamp": 1609819224, "time_this_iter_s": 53.770224809646606, "time_total_s": 3303.867922782898, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f048>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 3303.867922782898, "timesteps_since_restore": 0, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 8.102631578947369, "ram_util_percent": 30.400000000000006}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2492.372862438557, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1339.4049587552113, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2219.0924787491767, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.822128169280927, "mean_processing_ms": 1.3094203002123066, "mean_inference_ms": 0.6527336239352246}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 192000, "timers": {"learn_time_ms": 3.532, "learn_throughput": 18120.023, "update_time_ms": 0.638}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -56.64959716796875, "critic_loss": 0.011643709614872932, "mean_q": 56.432952880859375, "max_q": 75.98290252685547, "min_q": 5.631867408752441, "mean_td_error": -0.13115809857845306, "td_error": "[-0.15814972 -0.17191315 -0.03895569 -0.19376373 -0.14419556 -0.00788498\n -0.20866394 -0.2320137  -0.03593826 -0.11655045 -0.0629425  -0.17916489\n -0.04525948 -0.22562408 -0.16574097 -0.19132996 -0.04469681 -0.20492554\n -0.16313934 -0.20197296 -0.10655212 -0.03773499 -0.04240799 -0.08540726\n -0.14494324 -0.1691742  -0.2094574  -0.01346207 -0.06638336 -0.06853867\n -0.1780529  -0.07781982 -0.16651917  0.04803848 -0.08437729 -0.14154053\n -0.14662933 -0.13515472 -0.22227478 -0.21078491 -0.25411987 -0.15463257\n  0.00743484 -0.21603394 -0.27641106 -0.29400635 -0.05142975  0.053298\n -0.17424393 -0.13702774 -0.17439651 -0.11702728 -0.10593414 -0.1763382\n -0.17411041 -0.1106987  -0.07184219 -0.12834549 -0.12765121 -0.12256622\n -0.08274841 -0.19103241 -0.13545227 -0.12680054]"}}, "num_steps_sampled": 192000, "num_steps_trained": 12096064, "last_target_update_ts": 192000, "num_target_updates": 189001}, "done": false, "episodes_total": 64, "training_iteration": 64, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-01-17", "timestamp": 1609819277, "time_this_iter_s": 53.29336595535278, "time_total_s": 3357.1612887382507, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc57c400>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 3357.1612887382507, "timesteps_since_restore": 0, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 8.064473684210524, "ram_util_percent": 30.44078947368421}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2492.372862438557, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1350.0986175256744, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2034.492778835315, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.823249486639888, "mean_processing_ms": 1.3095687236474072, "mean_inference_ms": 0.6530396761579493}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 195000, "timers": {"learn_time_ms": 4.018, "learn_throughput": 15926.54, "update_time_ms": 0.67}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -58.56219482421875, "critic_loss": 0.002096397802233696, "mean_q": 58.319053649902344, "max_q": 78.17613983154297, "min_q": 9.40433406829834, "mean_td_error": 0.002703055739402771, "td_error": "[-0.0901947   0.02116394  0.06297493 -0.03085327  0.01332474  0.11109924\n  0.11732483 -0.14966202 -0.00852966  0.13784027  0.04972458 -0.04772949\n  0.01058197 -0.0396347  -0.04450226  0.07467651  0.01920319  0.09767914\n  0.03754044 -0.00020981 -0.05607224  0.02319813  0.03264618 -0.027668\n  0.06814194  0.18661499  0.02278137 -0.02040482  0.00717163  0.01096344\n -0.08750153  0.02225494 -0.0205574  -0.01368713 -0.0225029  -0.02962589\n -0.04063797 -0.03040314  0.01502228  0.04179382  0.05234146 -0.01896667\n  0.04788971 -0.03475952 -0.11102295  0.0316391   0.00133228 -0.0226593\n -0.01423645 -0.01362228 -0.06926727  0.06443405  0.08145523 -0.08376312\n  0.02838135 -0.08696747  0.01004028  0.01213074 -0.02481079  0.0013504\n  0.00413132 -0.02101898 -0.11444092  0.03005981]"}}, "num_steps_sampled": 195000, "num_steps_trained": 12288064, "last_target_update_ts": 195000, "num_target_updates": 192001}, "done": false, "episodes_total": 65, "training_iteration": 65, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-02-11", "timestamp": 1609819331, "time_this_iter_s": 53.8076434135437, "time_total_s": 3410.9689321517944, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc57c7b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 3410.9689321517944, "timesteps_since_restore": 0, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 8.064935064935064, "ram_util_percent": 30.5}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2492.372862438557, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1333.535116055601, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [256.9075205008452, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.824259272886664, "mean_processing_ms": 1.309715131378157, "mean_inference_ms": 0.6533329207651426}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 198000, "timers": {"learn_time_ms": 4.391, "learn_throughput": 14575.259, "update_time_ms": 0.759}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -55.059329986572266, "critic_loss": 0.002080495236441493, "mean_q": 54.886531829833984, "max_q": 78.08642578125, "min_q": -1.3146392107009888, "mean_td_error": -0.005076372995972633, "td_error": "[ 0.02077484 -0.09619141 -0.02754593 -0.00205612  0.07118988 -0.06595612\n -0.10111237 -0.00831604 -0.00688934  0.01891327  0.06934738 -0.00922394\n -0.04143143  0.04628754 -0.06239951  0.00105286 -0.01953888  0.02700043\n -0.00987625  0.00997162 -0.02993011  0.01784897  0.05289459 -0.0049324\n  0.11959457 -0.01035309 -0.01792145  0.05163956 -0.10133362  0.01119614\n  0.04433441 -0.06068802  0.00061417 -0.14521027  0.04402161 -0.04040718\n  0.01864243  0.00806427 -0.08618164  0.02038574 -0.01607132 -0.08541107\n  0.04546356 -0.02371216 -0.0785675  -0.0144043   0.05699158 -0.07571411\n -0.0869751   0.1818924   0.0268364   0.049366    0.06053925  0.10795593\n -0.05649567  0.05652618 -0.10175323 -0.0831337   0.01257324 -0.06333923\n -0.02708435  0.06042862  0.02072811  0.00219345]"}}, "num_steps_sampled": 198000, "num_steps_trained": 12480064, "last_target_update_ts": 198000, "num_target_updates": 195001}, "done": false, "episodes_total": 66, "training_iteration": 66, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-03-03", "timestamp": 1609819383, "time_this_iter_s": 52.15961480140686, "time_total_s": 3463.1285469532013, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc57cbf8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 3463.1285469532013, "timesteps_since_restore": 0, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 8.082666666666666, "ram_util_percent": 30.5}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2492.372862438557, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1336.5647297616472, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1536.5192343606986, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.825263215922509, "mean_processing_ms": 1.309864640971872, "mean_inference_ms": 0.6536237185365215}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 201000, "timers": {"learn_time_ms": 3.87, "learn_throughput": 16537.627, "update_time_ms": 0.635}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -53.82560348510742, "critic_loss": 0.002673906506970525, "mean_q": 53.614280700683594, "max_q": 78.94607543945312, "min_q": 2.745643377304077, "mean_td_error": -0.012759830802679062, "td_error": "[-8.79364014e-02 -4.61463928e-02 -4.65393066e-03  5.64575195e-02\n -8.42971802e-02 -4.00505066e-02  2.13127136e-02  2.47077942e-02\n  9.52377319e-02 -4.08134460e-02 -1.60903931e-02  7.54599571e-02\n -2.87246704e-03  2.40325928e-02  8.25729370e-02  7.22503662e-03\n  1.08016968e-01 -2.11524963e-02 -3.62701416e-02  6.93130493e-02\n -5.56726456e-02 -9.93270874e-02 -6.22558594e-03 -5.64880371e-02\n -1.15318298e-01  3.97529602e-02 -8.30841064e-03 -1.01493835e-01\n -5.62667847e-02 -4.95986938e-02 -3.89404297e-02  2.66555786e-01\n -8.44154358e-02 -1.28288269e-01 -9.05456543e-02  4.31900024e-02\n  3.33595276e-02  2.24113464e-04 -5.66673279e-02 -8.48388672e-03\n  4.70809937e-02 -1.24740601e-03 -1.02844238e-02 -1.21074677e-01\n -4.16793823e-02  1.09176636e-02  2.86102295e-03 -3.75595093e-02\n -1.26640320e-01  1.49688721e-02  9.67102051e-02  2.62069702e-02\n -1.15447998e-01  1.41525269e-02  5.60531616e-02 -5.51757812e-02\n -1.52142048e-02  5.24902344e-03  4.48837280e-02  4.70352173e-03\n -1.35612488e-02 -9.22241211e-02 -4.64782715e-02 -7.49244690e-02]"}}, "num_steps_sampled": 201000, "num_steps_trained": 12672064, "last_target_update_ts": 201000, "num_target_updates": 198001}, "done": false, "episodes_total": 67, "training_iteration": 67, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-03-58", "timestamp": 1609819438, "time_this_iter_s": 54.47019839286804, "time_total_s": 3517.5987453460693, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fb70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 3517.5987453460693, "timesteps_since_restore": 0, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 8.179220779220778, "ram_util_percent": 30.59220779220779}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2492.372862438557, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1342.2009185812665, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1719.8255694957602, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.826247459955749, "mean_processing_ms": 1.3100030076537634, "mean_inference_ms": 0.65390698369802}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 204000, "timers": {"learn_time_ms": 4.032, "learn_throughput": 15872.484, "update_time_ms": 0.719}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -53.08660888671875, "critic_loss": 0.0017059737583622336, "mean_q": 52.853084564208984, "max_q": 78.30850219726562, "min_q": -0.9809809327125549, "mean_td_error": 0.012494328431785107, "td_error": "[ 0.06210606  0.01097298  0.10277557 -0.06620026  0.0489502  -0.01660156\n  0.08058929  0.00583839 -0.02363586  0.03447533  0.11109924  0.04309082\n -0.00063705 -0.06666565  0.02368927 -0.07926941 -0.06602097 -0.01160431\n -0.01780701  0.04887772  0.05508423 -0.02593231  0.03781891  0.02612305\n  0.03704834  0.02932739  0.05217743  0.04030895 -0.00916672 -0.04688263\n -0.06940651 -0.0135994  -0.03129578  0.04692841  0.05626678 -0.01327515\n  0.07394791  0.00384802  0.03409576  0.04565048 -0.10958481  0.11941528\n  0.12225342 -0.07326508  0.00348663 -0.01308441  0.10798645 -0.00606251\n -0.00538635 -0.03084183 -0.05858612 -0.01537704  0.04486847  0.07470703\n -0.04233551  0.0273819   0.04080963 -0.04928589 -0.00712553  0.01931381\n  0.03321838  0.02993774  0.07191467 -0.03781128]"}}, "num_steps_sampled": 204000, "num_steps_trained": 12864064, "last_target_update_ts": 204000, "num_target_updates": 201001}, "done": false, "episodes_total": 68, "training_iteration": 68, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-04-51", "timestamp": 1609819491, "time_this_iter_s": 53.172513246536255, "time_total_s": 3570.7712585926056, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f9d8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 3570.7712585926056, "timesteps_since_restore": 0, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 8.044736842105264, "ram_util_percent": 30.599999999999994}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2492.372862438557, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1358.3367412430027, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2455.5726822410534, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.827254067756886, "mean_processing_ms": 1.3101329462109754, "mean_inference_ms": 0.6541847132279845}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 207000, "timers": {"learn_time_ms": 4.21, "learn_throughput": 15201.315, "update_time_ms": 0.6}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -56.282108306884766, "critic_loss": 0.008077016100287437, "mean_q": 56.049781799316406, "max_q": 77.82462310791016, "min_q": -0.6064461469650269, "mean_td_error": 0.09860077500343323, "td_error": "[ 0.03445053  0.20161057  0.15291214  0.04103088  0.20771408  0.02738571\n  0.04357147  0.12012482  0.15040016  0.18976593  0.13198471  0.09534454\n  0.07811737  0.18913269  0.00862503  0.12475586  0.11317825  0.3127861\n  0.0620079   0.18165588 -0.00868988  0.16062927  0.10991669  0.09650421\n  0.08594513 -0.00380707  0.08467102  0.03731155  0.0148468   0.04256439\n  0.04330444  0.1287117   0.0423851  -0.0197525   0.14772034  0.15089417\n  0.1829071   0.10266876  0.10419464  0.05046844 -0.00735474  0.12624359\n  0.24111176 -0.03679848  0.04815561  0.0553894   0.09078217  0.13195038\n  0.08356094  0.06583405  0.05909729  0.09480035  0.08813095  0.3925476\n  0.05138016  0.12504196  0.07380867  0.05406952  0.1540947   0.09355927\n -0.01083374  0.10675812  0.17280579  0.03636551]"}}, "num_steps_sampled": 207000, "num_steps_trained": 13056064, "last_target_update_ts": 207000, "num_target_updates": 204001}, "done": false, "episodes_total": 69, "training_iteration": 69, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-05-45", "timestamp": 1609819545, "time_this_iter_s": 53.95841145515442, "time_total_s": 3624.72967004776, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a7400>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 3624.72967004776, "timesteps_since_restore": 0, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 8.133766233766234, "ram_util_percent": 30.64545454545453}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2492.372862438557, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1350.4641619228153, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [807.2561888298916, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.828227606239269, "mean_processing_ms": 1.310266836483957, "mean_inference_ms": 0.6544615631690961}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 210000, "timers": {"learn_time_ms": 4.027, "learn_throughput": 15892.877, "update_time_ms": 0.697}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -55.049842834472656, "critic_loss": 0.0020594249945133924, "mean_q": 54.85107421875, "max_q": 79.87735748291016, "min_q": 0.34875237941741943, "mean_td_error": -0.007042231038212776, "td_error": "[-0.10853767 -0.02451324  0.00074768 -0.08418274  0.03317642 -0.07631683\n  0.06525421  0.05954552 -0.02085114 -0.01159668  0.01592255  0.05393982\n -0.0077095  -0.09109497  0.01885986 -0.11144257 -0.08904281 -0.0139637\n  0.01947784 -0.09054852  0.07663345 -0.01499176  0.01787567 -0.019104\n -0.01731491 -0.03300476  0.02433014 -0.01929474  0.08908367  0.02971649\n -0.11962128 -0.1099968   0.03627014 -0.07542419  0.0103302  -0.02524567\n -0.09646988  0.0918808  -0.0396347   0.06379318 -0.04792786 -0.09669495\n  0.03940964 -0.01358414 -0.00888443  0.02206039 -0.00712204 -0.03898621\n  0.03548431 -0.02127075 -0.11486816 -0.00577164 -0.01634979  0.03702545\n  0.0291748   0.13325119  0.05255127  0.01635742  0.07312965 -0.07756042\n  0.00807953 -0.00994873  0.08856964  0.0662384 ]"}}, "num_steps_sampled": 210000, "num_steps_trained": 13248064, "last_target_update_ts": 210000, "num_target_updates": 207001}, "done": false, "episodes_total": 70, "training_iteration": 70, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-06-39", "timestamp": 1609819599, "time_this_iter_s": 54.05937838554382, "time_total_s": 3678.789048433304, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a77b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 3678.789048433304, "timesteps_since_restore": 0, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 10.419480519480521, "ram_util_percent": 30.763636363636376}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2492.372862438557, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1364.4057532703087, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2340.31714759485, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.829227018092406, "mean_processing_ms": 1.310399084377799, "mean_inference_ms": 0.6547391696732828}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 213000, "timers": {"learn_time_ms": 3.997, "learn_throughput": 16010.799, "update_time_ms": 0.775}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -58.59261703491211, "critic_loss": 0.0038841029163450003, "mean_q": 58.39178466796875, "max_q": 80.98580932617188, "min_q": 9.87552261352539, "mean_td_error": 0.03672851622104645, "td_error": "[-7.8201294e-02  9.6351624e-02 -1.2428284e-02  7.6587677e-02\n  4.8027039e-02  9.1003418e-02 -1.5537262e-02 -3.6670685e-02\n  1.4749146e-01  4.2842865e-02 -1.1802673e-02 -8.7814331e-03\n  1.3185883e-01 -9.0675354e-03 -7.6293945e-04  4.1969299e-02\n -1.0860443e-02  3.3084869e-02  8.2614899e-02 -2.8427124e-02\n  1.1000824e-01  6.0272217e-02 -4.2488098e-02  5.4092407e-03\n -5.4981232e-02 -4.0969849e-03 -1.6498566e-02  1.9326019e-01\n  1.7417908e-02  5.4672241e-02  2.9944229e-01  1.5876770e-02\n -3.7574768e-03  1.3235092e-01  1.3684464e-01  6.7753792e-02\n  4.5921326e-02 -4.4776917e-02  7.2479248e-05  7.9132080e-02\n  2.9014587e-02  7.1899414e-02 -8.5563660e-02  3.1188965e-02\n  7.7144623e-02 -1.9821167e-01  5.3146362e-02  6.3323975e-03\n -7.3532104e-02  1.7673492e-01  3.8688660e-02  3.0265808e-02\n -2.0244598e-02  2.8778076e-02  5.2551270e-02  2.5016785e-02\n  1.5483475e-01  7.8369141e-02 -9.6271515e-02  4.5906067e-02\n  8.3251953e-02  1.0888672e-01  1.5090942e-02  8.6219788e-02]"}}, "num_steps_sampled": 213000, "num_steps_trained": 13440064, "last_target_update_ts": 213000, "num_target_updates": 210001}, "done": false, "episodes_total": 71, "training_iteration": 71, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-07-35", "timestamp": 1609819655, "time_this_iter_s": 55.47595286369324, "time_total_s": 3734.265001296997, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a7bf8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 3734.265001296997, "timesteps_since_restore": 0, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 10.48481012658228, "ram_util_percent": 30.79240506329116}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2492.372862438557, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1378.3014943507385, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2364.899111061244, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.8302573777139735, "mean_processing_ms": 1.310529765478738, "mean_inference_ms": 0.6550159480063266}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 216000, "timers": {"learn_time_ms": 3.669, "learn_throughput": 17445.487, "update_time_ms": 0.659}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -56.386863708496094, "critic_loss": 0.0022488455288112164, "mean_q": 56.17827606201172, "max_q": 79.44642639160156, "min_q": -2.1550745964050293, "mean_td_error": 0.006906912662088871, "td_error": "[ 0.03268814  0.0055275  -0.04901505  0.01032639  0.00692749  0.08130646\n -0.03531647  0.06420898 -0.03583527  0.07090759 -0.0308342  -0.02104473\n  0.01224709 -0.03814316  0.07611924 -0.09693146  0.03416443  0.10341644\n  0.01399994 -0.03107834  0.02024078  0.16383362  0.0684967   0.00074387\n -0.03700638 -0.01448822 -0.00252914  0.11127472 -0.12314224  0.07372284\n -0.02170181 -0.03443527 -0.01143646 -0.06260085  0.04927826  0.01343536\n -0.01425934 -0.01464844 -0.14051819  0.03295898 -0.01403809  0.13118744\n -0.03940868  0.10856628  0.04447937 -0.02256775 -0.10036469  0.08161926\n -0.05171204 -0.00035858 -0.06520081  0.06586838  0.00580978 -0.06843948\n -0.05917358 -0.04202271 -0.04572296 -0.0608139   0.03981018  0.10192871\n  0.04439163  0.06253815  0.0927124   0.00209427]"}}, "num_steps_sampled": 216000, "num_steps_trained": 13632064, "last_target_update_ts": 216000, "num_target_updates": 213001}, "done": false, "episodes_total": 72, "training_iteration": 72, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-08-30", "timestamp": 1609819710, "time_this_iter_s": 55.61901140213013, "time_total_s": 3789.884012699127, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5b0158>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 3789.884012699127, "timesteps_since_restore": 0, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 9.05625, "ram_util_percent": 30.800000000000004}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2492.372862438557, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1373.8168177098496, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1050.9200995658653, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.831248185059934, "mean_processing_ms": 1.3106582733596353, "mean_inference_ms": 0.6552847983821375}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 219000, "timers": {"learn_time_ms": 3.9, "learn_throughput": 16408.537, "update_time_ms": 0.693}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -58.23134231567383, "critic_loss": 0.0026291622780263424, "mean_q": 58.010982513427734, "max_q": 82.23613739013672, "min_q": -1.5070089101791382, "mean_td_error": 0.015372112393379211, "td_error": "[-0.02487183 -0.08156586 -0.08096313  0.10977936  0.07953644  0.04032135\n -0.01719666 -0.00921631 -0.0194397   0.05472565 -0.10142517 -0.01909828\n  0.02300262 -0.05255508  0.04434967 -0.02893829  0.01796341  0.15735626\n -0.01488495  0.0705986   0.02038193 -0.08502871  0.00966263  0.03227234\n  0.19277191 -0.1039505   0.03471756  0.1181488   0.0482254   0.00052643\n  0.05065155  0.00364876  0.04186249 -0.03569031 -0.04213715 -0.12593079\n  0.10475922 -0.04100311 -0.00308418 -0.05259705  0.07198334 -0.0065155\n  0.09501648  0.04345703 -0.0047226   0.10055161  0.133255    0.05812836\n  0.04060364  0.01222229  0.01442719  0.1499443  -0.00357819  0.01511765\n  0.05474091 -0.00294495 -0.02154446 -0.04875946  0.07203293  0.02868652\n  0.05801392 -0.07188416 -0.01553345 -0.10456848]"}}, "num_steps_sampled": 219000, "num_steps_trained": 13824064, "last_target_update_ts": 219000, "num_target_updates": 216001}, "done": false, "episodes_total": 73, "training_iteration": 73, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-09-24", "timestamp": 1609819764, "time_this_iter_s": 53.28449845314026, "time_total_s": 3843.1685111522675, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5b0510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 3843.1685111522675, "timesteps_since_restore": 0, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 8.928947368421053, "ram_util_percent": 30.80657894736843}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2492.372862438557, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1381.2525098089748, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1924.0580330451016, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.832236286244782, "mean_processing_ms": 1.3107872432356609, "mean_inference_ms": 0.6555474151191598}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 222000, "timers": {"learn_time_ms": 3.724, "learn_throughput": 17185.589, "update_time_ms": 0.643}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -56.992610931396484, "critic_loss": 0.0022072670981287956, "mean_q": 56.79102325439453, "max_q": 80.93914794921875, "min_q": 0.7936602234840393, "mean_td_error": -0.007711281068623066, "td_error": "[-0.04602814  0.08132553  0.18279648 -0.06076813  0.07727814 -0.03546333\n -0.07674408  0.01502991 -0.01992416  0.01996613 -0.02256775  0.03337479\n -0.04864883  0.03084183 -0.02554703 -0.11524326  0.01044846  0.01789856\n -0.13970947  0.069664   -0.00830078  0.02498627 -0.0990448   0.03606415\n -0.02955627 -0.07989502 -0.05296326 -0.02410126  0.07548523  0.07918549\n -0.04428864  0.05667496 -0.09790039  0.05610657  0.04351807 -0.04102325\n -0.02736664  0.00161362  0.02471924  0.00480461 -0.04393005 -0.0089798\n -0.04133224 -0.00428772  0.07159805 -0.0131073  -0.02656937  0.03424835\n -0.04628754 -0.02241516  0.10530853 -0.02631378  0.07471848  0.01284027\n  0.03083801  0.02269745 -0.05372238 -0.11225891 -0.06451797  0.0821228\n -0.06475258 -0.11544037 -0.04187393 -0.08880234]"}}, "num_steps_sampled": 222000, "num_steps_trained": 14016064, "last_target_update_ts": 222000, "num_target_updates": 219001}, "done": false, "episodes_total": 74, "training_iteration": 74, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-10-17", "timestamp": 1609819817, "time_this_iter_s": 53.7829806804657, "time_total_s": 3896.951491832733, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5b0950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 3896.951491832733, "timesteps_since_restore": 0, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 8.947368421052634, "ram_util_percent": 30.900000000000006}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2492.372862438557, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1386.7112073714047, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1790.6548269912294, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.833206646938566, "mean_processing_ms": 1.3109103604777494, "mean_inference_ms": 0.6558039510379994}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 225000, "timers": {"learn_time_ms": 3.93, "learn_throughput": 16284.903, "update_time_ms": 0.65}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -65.29032135009766, "critic_loss": 0.002264807466417551, "mean_q": 65.01488494873047, "max_q": 83.15277862548828, "min_q": 23.019634246826172, "mean_td_error": 0.03338402509689331, "td_error": "[ 0.11784363  0.08831024  0.08685684  0.03697205  0.00600433  0.01008987\n  0.00421143  0.0450592  -0.00055313 -0.05034637  0.05199814  0.05039215\n -0.02302551  0.16121674  0.00279236  0.02292633  0.04807281  0.06350708\n  0.00621796 -0.05448532 -0.06274033 -0.0173378   0.05683899  0.01464081\n  0.05400085  0.05792999  0.08688354  0.0956192   0.13728333  0.12296295\n  0.07466125  0.09322357  0.05961609  0.0332489   0.03655624 -0.03473663\n -0.02710724  0.09955597  0.05755615  0.00350189 -0.07064056  0.04490662\n -0.01457977  0.04053497  0.015625    0.04269791  0.056633   -0.05748749\n  0.07843018 -0.07015991 -0.00770187 -0.01231384 -0.0362587   0.06542206\n  0.09028625 -0.00511169  0.07202911 -0.03725433  0.09215927 -0.02305603\n  0.02514648  0.09527588  0.05874634  0.07703018]"}}, "num_steps_sampled": 225000, "num_steps_trained": 14208064, "last_target_update_ts": 225000, "num_target_updates": 222001}, "done": false, "episodes_total": 75, "training_iteration": 75, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-11-11", "timestamp": 1609819871, "time_this_iter_s": 53.27892065048218, "time_total_s": 3950.2304124832153, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fc80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 3950.2304124832153, "timesteps_since_restore": 0, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 8.597368421052632, "ram_util_percent": 30.900000000000006}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2492.372862438557, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1398.0539849604252, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2248.762304136957, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.834185869907839, "mean_processing_ms": 1.3110285341205579, "mean_inference_ms": 0.6560562539101294}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 228000, "timers": {"learn_time_ms": 4.354, "learn_throughput": 14700.495, "update_time_ms": 0.603}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -61.09239196777344, "critic_loss": 0.003297914285212755, "mean_q": 60.90704345703125, "max_q": 83.23966979980469, "min_q": 0.45636415481567383, "mean_td_error": -0.0113625293597579, "td_error": "[ 0.02696228 -0.08211517  0.05443573 -0.10771179  0.0871048   0.06425476\n  0.1940155  -0.15744781  0.00317192 -0.00191116  0.0344696  -0.09922028\n  0.10179901 -0.08538818  0.04290009 -0.03265381  0.03990555  0.02812958\n  0.13471222  0.04945374 -0.04021454 -0.03488922 -0.17140579  0.0535183\n -0.02795029 -0.06264114 -0.09823608 -0.05454254 -0.05334473 -0.0002346\n  0.05841827  0.15081024 -0.03355408 -0.13749695 -0.02228546 -0.12828064\n  0.0106144  -0.00220108 -0.11475372 -0.02445984 -0.05714417 -0.06204987\n  0.04368019 -0.04891962  0.05174255 -0.03356934 -0.11178589  0.01224518\n  0.05964661 -0.04780889 -0.06269836  0.10447693 -0.05610657  0.03461456\n  0.02449799  0.0767746  -0.03662109 -0.01737213 -0.18507504  0.04091644\n -0.00997162  0.00426483 -0.06143188  0.04875565]"}}, "num_steps_sampled": 228000, "num_steps_trained": 14400064, "last_target_update_ts": 228000, "num_target_updates": 225001}, "done": false, "episodes_total": 76, "training_iteration": 76, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-12-05", "timestamp": 1609819925, "time_this_iter_s": 53.93188452720642, "time_total_s": 4004.1622970104218, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 4004.1622970104218, "timesteps_since_restore": 0, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 8.085714285714285, "ram_util_percent": 30.96233766233766}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2492.372862438557, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1399.384963349744, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1500.539320937984, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.835143640381843, "mean_processing_ms": 1.311148677815008, "mean_inference_ms": 0.6563031818902946}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 231000, "timers": {"learn_time_ms": 4.03, "learn_throughput": 15881.405, "update_time_ms": 0.667}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -60.449771881103516, "critic_loss": 0.0024106160271912813, "mean_q": 60.208927154541016, "max_q": 82.69300079345703, "min_q": 4.388267993927002, "mean_td_error": 0.024790063500404358, "td_error": "[ 0.16500854 -0.0195694   0.007164   -0.06357956  0.00818634  0.0032959\n  0.03333282  0.0581131   0.00934601 -0.11189365  0.01602173 -0.01649857\n  0.01081085 -0.00857544  0.03165436  0.02705383 -0.03647232  0.03079987\n  0.03509521  0.00165176 -0.03075027 -0.06161499  0.05906296 -0.04001236\n  0.02948952  0.11843491 -0.04330444  0.19179916  0.07026672 -0.00043488\n  0.03471375  0.0247879  -0.07396698 -0.00185013  0.02972412  0.00413513\n  0.05795288  0.10260963  0.07114792  0.1890564  -0.11544514 -0.00331116\n  0.01437378  0.03756142  0.03448009  0.055336    0.02958679 -0.00437927\n  0.07884216 -0.02774048 -0.07891083  0.14090729  0.01513672  0.07597351\n  0.02432251  0.07615662  0.09929657  0.0510025  -0.02304077  0.02759552\n  0.03746986  0.04055023  0.03489685  0.05371094]"}}, "num_steps_sampled": 231000, "num_steps_trained": 14592064, "last_target_update_ts": 231000, "num_target_updates": 228001}, "done": false, "episodes_total": 77, "training_iteration": 77, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-12-58", "timestamp": 1609819978, "time_this_iter_s": 53.6545090675354, "time_total_s": 4057.816806077957, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a9400>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 4057.816806077957, "timesteps_since_restore": 0, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 9.55324675324675, "ram_util_percent": 31.005194805194808}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2492.372862438557, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1400.8207437269693, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1511.3758327733265, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.836075093164841, "mean_processing_ms": 1.311266282919066, "mean_inference_ms": 0.6565458720388101}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 234000, "timers": {"learn_time_ms": 4.34, "learn_throughput": 14747.094, "update_time_ms": 0.697}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -59.475765228271484, "critic_loss": 0.008274267427623272, "mean_q": 59.3139762878418, "max_q": 82.30879211425781, "min_q": -0.060775935649871826, "mean_td_error": 0.04972103610634804, "td_error": "[ 0.11489487  0.22963715  0.04433441  0.00577545  0.0728302  -0.01914978\n  0.13264465 -0.6552353   0.07645416 -0.03712463  0.10869598 -0.08987427\n -0.00643921  0.10051346  0.10374451  0.10166168  0.21102238 -0.02387238\n  0.12966156  0.12121582  0.04033661  0.09502411  0.14746857  0.08869171\n  0.0599823   0.06178284  0.03860474  0.13928986  0.03321075  0.06581879\n  0.08755112  0.12265396 -0.05203247 -0.08337402  0.02583694 -0.08873749\n -0.03748322  0.11344147 -0.08613586  0.07043457  0.05398178  0.12225342\n  0.02830505  0.08548737  0.12671661  0.15010834  0.07960582 -0.21196747\n  0.11395264  0.07458878  0.0369339   0.05651093  0.07292938  0.04546356\n  0.07833531  0.10075378 -0.02887726  0.09109879  0.10414886  0.09935379\n  0.11463165  0.02996063  0.11235809  0.08175659]"}}, "num_steps_sampled": 234000, "num_steps_trained": 14784064, "last_target_update_ts": 234000, "num_target_updates": 231001}, "done": false, "episodes_total": 78, "training_iteration": 78, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-13-52", "timestamp": 1609820032, "time_this_iter_s": 53.65578246116638, "time_total_s": 4111.4725885391235, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a97b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 4111.4725885391235, "timesteps_since_restore": 0, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 8.836363636363636, "ram_util_percent": 31.057142857142853}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1415.4548437378453, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2556.9146445861616, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.837042645365846, "mean_processing_ms": 1.3113795122758425, "mean_inference_ms": 0.6567874181582256}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 237000, "timers": {"learn_time_ms": 4.1, "learn_throughput": 15610.797, "update_time_ms": 0.694}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -61.051666259765625, "critic_loss": 0.0035294019617140293, "mean_q": 60.8603630065918, "max_q": 84.17174530029297, "min_q": 3.4724903106689453, "mean_td_error": -0.05321715399622917, "td_error": "[-0.1314621  -0.12205505  0.14950562 -0.0453949  -0.05532837 -0.04396057\n -0.13127899 -0.1278534  -0.1408081  -0.04197693 -0.04034233 -0.11855316\n -0.07917023 -0.05960846 -0.0249939  -0.17886877 -0.02619267 -0.01244354\n -0.08916473 -0.09806061  0.00697708 -0.0086174  -0.02705002 -0.06466675\n -0.02565575 -0.07633209  0.00210571 -0.04678345  0.0100174  -0.13349533\n -0.08517838  0.01815796 -0.01628113 -0.00590515 -0.02776337  0.08999634\n -0.10447311 -0.04489136 -0.06900787 -0.1262207  -0.11001015 -0.1513977\n -0.05722809 -0.1190474  -0.07206726 -0.01244736 -0.04452515 -0.03780365\n  0.05038452  0.03715897 -0.09779739 -0.1055069  -0.07640076 -0.11797333\n -0.06259918  0.02758026 -0.11747742 -0.05023956 -0.01082611  0.01010895\n -0.01844406 -0.08172607 -0.07021332  0.03567886]"}}, "num_steps_sampled": 237000, "num_steps_trained": 14976064, "last_target_update_ts": 237000, "num_target_updates": 234001}, "done": false, "episodes_total": 79, "training_iteration": 79, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-14-48", "timestamp": 1609820088, "time_this_iter_s": 55.52081346511841, "time_total_s": 4166.993402004242, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a9bf8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 4166.993402004242, "timesteps_since_restore": 0, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 8.78354430379747, "ram_util_percent": 31.09999999999999}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1424.3209829106759, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2124.745977564283, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.838005156542123, "mean_processing_ms": 1.311487403566574, "mean_inference_ms": 0.6570248228591249}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 240000, "timers": {"learn_time_ms": 4.228, "learn_throughput": 15137.537, "update_time_ms": 0.698}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -57.23268508911133, "critic_loss": 0.004659409634768963, "mean_q": 57.051143646240234, "max_q": 84.3067626953125, "min_q": -0.75385981798172, "mean_td_error": 0.008686966262757778, "td_error": "[ 0.0555191  -0.02275848 -0.07395613  0.1157608  -0.02774811  0.07157516\n  0.01010895 -0.09418488 -0.05728912  0.288414   -0.01086426 -0.03282166\n -0.47875214 -0.03412628 -0.05920792  0.07157135  0.04625589 -0.00272369\n  0.00177002 -0.08517456  0.05384445  0.03808594 -0.00823784 -0.0045104\n  0.11899447  0.05986023  0.06583405 -0.07580566  0.09796524  0.05705261\n  0.04762268 -0.06181335  0.05501556  0.02173615 -0.0623951  -0.08792114\n  0.05828857 -0.029953   -0.02226257  0.12830734  0.17782593  0.02229309\n -0.0193367  -0.03656006  0.07718277 -0.01415253 -0.01187897 -0.09067535\n -0.07740784  0.01926804 -0.02608109  0.10286713 -0.00310516  0.12448502\n  0.01829147  0.04203033 -0.02720642  0.00452518  0.01055908  0.1135788\n  0.01179504 -0.02675629  0.02293396  0.01041412]"}}, "num_steps_sampled": 240000, "num_steps_trained": 15168064, "last_target_update_ts": 240000, "num_target_updates": 237001}, "done": false, "episodes_total": 80, "training_iteration": 80, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-15-42", "timestamp": 1609820142, "time_this_iter_s": 54.50935745239258, "time_total_s": 4221.5027594566345, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a6158>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 4221.5027594566345, "timesteps_since_restore": 0, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 8.278205128205128, "ram_util_percent": 31.115384615384603}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1425.8183442203658, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1545.607248995561, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.838953196887845, "mean_processing_ms": 1.311593490465394, "mean_inference_ms": 0.6572585224399351}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 243000, "timers": {"learn_time_ms": 3.884, "learn_throughput": 16478.947, "update_time_ms": 0.639}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -56.47813415527344, "critic_loss": 0.0023870139848440886, "mean_q": 56.238624572753906, "max_q": 82.63373565673828, "min_q": -0.7183318138122559, "mean_td_error": -0.010844883508980274, "td_error": "[ 3.40194702e-02 -3.97491455e-03  4.82635498e-02  1.05588913e-01\n  1.23878479e-01 -5.29518127e-02  2.43835449e-02  1.32675171e-02\n  1.41677856e-02 -5.75714111e-02 -1.04537964e-01 -2.36740112e-02\n -6.77550435e-02 -1.51859283e-01 -8.98056030e-02  2.05192566e-02\n -1.63764954e-02  1.66549683e-02  1.53747559e-01 -6.40258789e-02\n  1.50466919e-01  1.43051147e-04 -4.51316833e-02  7.41958618e-02\n  7.08007812e-03  1.98287964e-02 -5.73577881e-02 -2.21176147e-02\n  1.17378235e-02  9.77706909e-03 -1.29776001e-01 -8.56781006e-02\n  1.26495361e-02 -1.24249458e-02 -7.50808716e-02 -3.76892090e-03\n  5.63125610e-02 -6.83059692e-02  7.69805908e-03  2.36463547e-02\n -2.33840942e-02 -2.21710205e-02  7.72628784e-02  7.25250244e-02\n  8.27789307e-03  2.91671753e-02  4.40368652e-02 -9.83848572e-02\n -4.63790894e-02 -5.84411621e-03 -1.00708008e-02 -7.34786987e-02\n -7.80029297e-02 -7.84072876e-02 -1.08310699e-01 -6.92291260e-02\n -3.91006470e-02 -1.92947388e-02  1.11419678e-01 -6.60667419e-02\n -2.18544006e-02 -1.75247192e-02 -3.96385193e-02 -1.54724121e-02]"}}, "num_steps_sampled": 243000, "num_steps_trained": 15360064, "last_target_update_ts": 243000, "num_target_updates": 240001}, "done": false, "episodes_total": 81, "training_iteration": 81, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-16-36", "timestamp": 1609820196, "time_this_iter_s": 54.068273305892944, "time_total_s": 4275.5710327625275, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a6510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 4275.5710327625275, "timesteps_since_restore": 0, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 8.666233766233768, "ram_util_percent": 31.199999999999985}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1418.7417563747726, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [845.5381408817311, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.83986812140798, "mean_processing_ms": 1.3116961661013669, "mean_inference_ms": 0.6574882414714239}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 246000, "timers": {"learn_time_ms": 3.878, "learn_throughput": 16504.277, "update_time_ms": 0.665}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -59.4571533203125, "critic_loss": 0.028693633154034615, "mean_q": 59.2015266418457, "max_q": 84.42814636230469, "min_q": 5.2435197830200195, "mean_td_error": -0.19564566016197205, "td_error": "[-0.22542572 -0.23312378 -0.254982   -0.26543427 -0.02192688 -1.0353775\n -0.2534485  -0.28202152 -0.06796265 -0.0711937  -0.39364624 -0.04640961\n -0.19519806 -0.08578873  0.09872818 -0.16847229 -0.04534531 -0.2261467\n -0.18588638 -0.18964767 -0.1612091  -0.13221359 -0.36226654 -0.3191681\n -0.14338684 -0.27544022 -0.15712547 -0.13374329 -0.1714468  -0.29211426\n -0.13129044 -0.09577942 -0.16760254 -0.22312164 -0.19335938 -0.11277771\n -0.18567657 -0.1510086  -0.27174377 -0.22709274 -0.18299866 -0.21192932\n -0.24687958 -0.29304504 -0.30584717 -0.14932251 -0.11811829 -0.21024704\n -0.21913147 -0.18338776 -0.20008087 -0.06026459 -0.22764587 -0.01554108\n -0.19877625 -0.14208221 -0.11608124 -0.19043732 -0.174469   -0.18592072\n -0.23328781 -0.21316147 -0.11599731 -0.27039337]"}}, "num_steps_sampled": 246000, "num_steps_trained": 15552064, "last_target_update_ts": 246000, "num_target_updates": 243001}, "done": false, "episodes_total": 82, "training_iteration": 82, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-17-30", "timestamp": 1609820250, "time_this_iter_s": 53.34472393989563, "time_total_s": 4328.915756702423, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a6950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 4328.915756702423, "timesteps_since_restore": 0, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 8.080263157894738, "ram_util_percent": 31.199999999999985}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1420.61041073821, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1573.8400685400861, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.840759531229952, "mean_processing_ms": 1.3117975687457746, "mean_inference_ms": 0.6577141279215118}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 249000, "timers": {"learn_time_ms": 4.046, "learn_throughput": 15816.558, "update_time_ms": 0.695}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -61.9335823059082, "critic_loss": 0.0030220095068216324, "mean_q": 61.67858123779297, "max_q": 83.87262725830078, "min_q": 2.5592496395111084, "mean_td_error": 0.010056819766759872, "td_error": "[ 0.00095367 -0.02070618 -0.02376556  0.03409958  0.00318909 -0.09134102\n  0.11247635  0.0555191  -0.10860443  0.00306702  0.02600098 -0.05490875\n -0.04913712 -0.01149368 -0.04081345 -0.00902653  0.10932159  0.04108429\n -0.05788803 -0.05625153  0.03825378  0.02848816  0.09060669  0.0500946\n -0.02418518 -0.00202942  0.05985069  0.09978485  0.25828934 -0.13001633\n  0.03696442  0.10974884 -0.1517868   0.06298065 -0.09711385 -0.00873566\n -0.11763763  0.0366745   0.01583862  0.0410881  -0.0147934  -0.06177902\n  0.00601196 -0.02436829  0.01856232 -0.0906601   0.07072449  0.09103394\n -0.0710392   0.07004166 -0.00334167  0.00240326  0.17210388 -0.04329681\n -0.03299713  0.02089691  0.13508606  0.08598328 -0.04911041  0.06078339\n -0.01800919  0.06459808 -0.00148773 -0.00264359]"}}, "num_steps_sampled": 249000, "num_steps_trained": 15744064, "last_target_update_ts": 249000, "num_target_updates": 246001}, "done": false, "episodes_total": 83, "training_iteration": 83, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-18-23", "timestamp": 1609820303, "time_this_iter_s": 53.880139112472534, "time_total_s": 4382.795895814896, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fc80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 4382.795895814896, "timesteps_since_restore": 0, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 8.729870129870129, "ram_util_percent": 31.199999999999985}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1417.3889034902027, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1150.003801905576, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.841631893428089, "mean_processing_ms": 1.3119038982108502, "mean_inference_ms": 0.6579362756229363}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 252000, "timers": {"learn_time_ms": 4.106, "learn_throughput": 15586.504, "update_time_ms": 0.609}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -57.02589416503906, "critic_loss": 0.00271078129298985, "mean_q": 56.7905387878418, "max_q": 84.54478454589844, "min_q": 5.883342742919922, "mean_td_error": -0.012983530759811401, "td_error": "[ 0.1627121   0.03168488 -0.04500198 -0.08271599 -0.00759506  0.13549423\n -0.04831696 -0.03831863 -0.06131744 -0.07006073  0.03079605  0.03756714\n -0.01303482 -0.0474968  -0.14098358 -0.03029633  0.05271912 -0.03213501\n -0.08348608 -0.05400467 -0.08751726 -0.05162811 -0.10295486 -0.01532364\n -0.03458786  0.07024384 -0.01522446 -0.08325958 -0.02431488 -0.00909424\n  0.00919724 -0.01660728 -0.1275711   0.00254822  0.07194519 -0.00997162\n  0.17637634  0.0406189  -0.14200592 -0.01694489 -0.10799026  0.06191254\n  0.07240295  0.04688263  0.08453369  0.09418488 -0.07787704 -0.07331848\n  0.02939224 -0.07630157 -0.01135254  0.05610657 -0.03914642 -0.04794884\n -0.0080719   0.05291176 -0.06145763 -0.02132416 -0.08622456 -0.02599335\n -0.02449799 -0.09236145  0.04453278  0.04992676]"}}, "num_steps_sampled": 252000, "num_steps_trained": 15936064, "last_target_update_ts": 252000, "num_target_updates": 249001}, "done": false, "episodes_total": 84, "training_iteration": 84, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-19-17", "timestamp": 1609820357, "time_this_iter_s": 53.703569412231445, "time_total_s": 4436.499465227127, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fd90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 4436.499465227127, "timesteps_since_restore": 0, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 8.64342105263158, "ram_util_percent": 31.25000000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1425.0817705841073, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2071.2826064721016, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.842510548409619, "mean_processing_ms": 1.312006048425554, "mean_inference_ms": 0.6581557748683055}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 255000, "timers": {"learn_time_ms": 3.592, "learn_throughput": 17818.838, "update_time_ms": 0.66}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -63.48113250732422, "critic_loss": 0.003679439192637801, "mean_q": 63.30989074707031, "max_q": 85.95092010498047, "min_q": 3.581817150115967, "mean_td_error": 0.021813184022903442, "td_error": "[-0.04838562  0.10941315 -0.00559998  0.29099274  0.00426102  0.08685684\n  0.07538605 -0.00975037  0.07310486  0.09346771 -0.00256729  0.00771332\n -0.00143814 -0.04129028  0.03451538 -0.04349518  0.10305786  0.02441025\n -0.018013    0.04462433 -0.04666901  0.04134369 -0.04088974  0.13439941\n -0.05997086  0.03514099  0.02427673  0.00527573  0.00436401  0.04385757\n -0.0634613   0.10340118  0.11210632  0.03697205 -0.03569031  0.00697327\n -0.06111526  0.08189392  0.05077744 -0.01575947 -0.0413208  -0.00043154\n -0.03837585 -0.0573349   0.04007721 -0.23890686  0.1723175  -0.00661469\n -0.07403564 -0.09751701 -0.07859802  0.13583374  0.11592102  0.03321075\n  0.05549622  0.04381561  0.01711273 -0.09012604  0.17909002 -0.02248383\n  0.02534485  0.12548065  0.05422974  0.0093689 ]"}}, "num_steps_sampled": 255000, "num_steps_trained": 16128064, "last_target_update_ts": 255000, "num_target_updates": 252001}, "done": false, "episodes_total": 85, "training_iteration": 85, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-20-12", "timestamp": 1609820412, "time_this_iter_s": 54.64318227767944, "time_total_s": 4491.1426475048065, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5af400>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 4491.1426475048065, "timesteps_since_restore": 0, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 9.316666666666666, "ram_util_percent": 31.312820512820533}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1413.4607870439934, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [425.6771861343114, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.8433364944970725, "mean_processing_ms": 1.3121137203237188, "mean_inference_ms": 0.658373256432823}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 258000, "timers": {"learn_time_ms": 4.251, "learn_throughput": 15053.581, "update_time_ms": 0.65}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -57.1717414855957, "critic_loss": 0.0026427716948091984, "mean_q": 56.9693717956543, "max_q": 85.73693084716797, "min_q": 4.061132907867432, "mean_td_error": 0.011685818433761597, "td_error": "[ 0.13379669  0.04224014 -0.04140091  0.00941277  0.04152679 -0.01539612\n -0.06607437 -0.02849579  0.0295639   0.08295441  0.08569717  0.0917511\n -0.00676346  0.00542355 -0.07421112  0.03552055 -0.07728577  0.09033966\n -0.00128937  0.0115509   0.0173111   0.00527191  0.01528168  0.03830719\n  0.01979065  0.11580276  0.02375031  0.15077114 -0.05457687 -0.02434921\n  0.07920837 -0.06927872  0.10696793 -0.16007233  0.15636492 -0.00766754\n  0.15457916 -0.07407379 -0.04685879 -0.02784729 -0.00463104 -0.10282135\n -0.07798767  0.02121353  0.06756067 -0.01344299 -0.03182983  0.0819931\n -0.0327301  -0.04242325  0.01390839  0.11705017 -0.04398727 -0.0378418\n  0.12393951 -0.06359863 -0.03354645  0.05073929 -0.06271362  0.02145386\n -0.02957153  0.02964401  0.00271225  0.02725983]"}}, "num_steps_sampled": 258000, "num_steps_trained": 16320064, "last_target_update_ts": 258000, "num_target_updates": 255001}, "done": false, "episodes_total": 86, "training_iteration": 86, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-21-05", "timestamp": 1609820465, "time_this_iter_s": 53.61568546295166, "time_total_s": 4544.758332967758, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5af7b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 4544.758332967758, "timesteps_since_restore": 0, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 10.236363636363636, "ram_util_percent": 31.39480519480519}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1403.5938554658526, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [555.0377397457366, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.844119601613723, "mean_processing_ms": 1.3122194587958464, "mean_inference_ms": 0.6585901581030131}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 261000, "timers": {"learn_time_ms": 3.93, "learn_throughput": 16286.583, "update_time_ms": 0.647}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -63.124263763427734, "critic_loss": 0.010191976092755795, "mean_q": 62.858177185058594, "max_q": 86.02007293701172, "min_q": 2.621969223022461, "mean_td_error": 0.1016015112400055, "td_error": "[ 0.03087616  0.10446167  0.04032135  0.12169647  0.03205872  0.05677795\n  0.07060242  0.2463913   0.09467316 -0.00577545  0.09886932  0.4577942\n  0.07315826  0.15932465  0.04085922 -0.01722717  0.0447731   0.19465637\n -0.04707336  0.19978333  0.01657867  0.1285553   0.12793732  0.01564407\n  0.08701324  0.0891304  -0.04683685  0.06539917 -0.05425262 -0.06681061\n  0.32360458  0.29232025  0.06083298  0.09799194  0.06423187  0.07659912\n  0.03612518  0.15159607  0.07967377  0.30747604  0.09888458  0.13820648\n  0.25074196  0.05396271  0.0557785   0.23497772  0.23322296  0.03656387\n  0.05328369  0.15995789  0.11112595  0.19381714  0.0610199   0.03772354\n  0.10170746  0.09344482 -0.00868988  0.11765671  0.20158768  0.16978455\n  0.07545471  0.09229279 -0.02960968  0.11978912]"}}, "num_steps_sampled": 261000, "num_steps_trained": 16512064, "last_target_update_ts": 261000, "num_target_updates": 258001}, "done": false, "episodes_total": 87, "training_iteration": 87, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-22-00", "timestamp": 1609820520, "time_this_iter_s": 54.203014612197876, "time_total_s": 4598.961347579956, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5afbf8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 4598.961347579956, "timesteps_since_restore": 0, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 10.555844155844156, "ram_util_percent": 31.767532467532483}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1407.682968141699, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1763.4357709403312, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.844896838326933, "mean_processing_ms": 1.3123265650466513, "mean_inference_ms": 0.6588051957236537}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 264000, "timers": {"learn_time_ms": 3.633, "learn_throughput": 17618.384, "update_time_ms": 0.722}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -58.3039436340332, "critic_loss": 0.003910577390342951, "mean_q": 58.12938690185547, "max_q": 86.94597625732422, "min_q": 0.4053274095058441, "mean_td_error": 0.004126968327909708, "td_error": "[ 7.02056885e-02  9.11178589e-02  9.63211060e-05 -5.33542633e-02\n -3.56159210e-02 -4.72946167e-02  6.82182312e-02  9.97238159e-02\n  4.90188599e-02  2.04696655e-02 -7.68318176e-02 -5.40847778e-02\n -5.04646301e-02 -1.23809814e-01 -1.80986404e-01  4.29534912e-02\n -3.28674316e-02  1.27220154e-01 -1.07101440e-01 -3.74221802e-02\n -6.40411377e-02 -1.13059998e-01  1.09710693e-01 -1.25240326e-01\n  3.47900391e-03 -6.54678345e-02  7.20024109e-02  7.39440918e-02\n  1.92123413e-01 -1.41525269e-02  4.76379395e-02 -7.71789551e-02\n -8.47625732e-03 -4.17747498e-02 -8.80889893e-02 -2.95486450e-02\n  4.89616394e-02  2.78114319e-01 -1.71203613e-02 -1.12335205e-01\n  1.55563354e-02 -7.92312622e-02  1.41128540e-01 -1.07467651e-01\n -2.15290487e-02 -1.01112366e-01 -1.75170898e-02  3.12805176e-02\n  1.40800476e-01 -1.23214722e-02  7.72628784e-02  8.31108093e-02\n -4.68826294e-03  5.60188293e-02  8.52050781e-02  5.23643494e-02\n -7.89260864e-03  8.38394165e-02  1.99508667e-02  3.58238220e-02\n  3.60717773e-02  3.72390747e-02 -1.36215210e-01  1.77688599e-02]"}}, "num_steps_sampled": 264000, "num_steps_trained": 16704064, "last_target_update_ts": 264000, "num_target_updates": 261001}, "done": false, "episodes_total": 88, "training_iteration": 88, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-22-54", "timestamp": 1609820574, "time_this_iter_s": 54.5209264755249, "time_total_s": 4653.482274055481, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2158>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 4653.482274055481, "timesteps_since_restore": 0, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 9.48076923076923, "ram_util_percent": 31.85641025641027}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1408.8850054885665, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1514.66429201293, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.845658960405354, "mean_processing_ms": 1.312432408562204, "mean_inference_ms": 0.6590179468856453}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 267000, "timers": {"learn_time_ms": 4.087, "learn_throughput": 15660.523, "update_time_ms": 0.646}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -61.83564758300781, "critic_loss": 0.06464093178510666, "mean_q": 61.66583251953125, "max_q": 87.38322448730469, "min_q": 9.153225898742676, "mean_td_error": -0.3294273018836975, "td_error": "[-0.44161606 -0.39544678 -0.2643051  -0.34199524 -0.3254547  -0.26180267\n -1.1144066  -0.47122955 -0.43917847 -0.1378479  -0.32276154 -0.46232414\n -0.0594101  -0.17700958 -0.29653168 -0.29078674 -0.272995   -0.3853073\n -0.38925934 -0.3317566  -0.36369324 -0.42622757 -0.37407684 -0.45503998\n -0.07199097 -0.4196167  -0.32453156 -0.27345753 -0.4610443  -0.31579208\n -0.3432846  -0.35500336 -0.25448608 -0.3761139  -0.46291733 -0.11675262\n -0.4020691  -0.3503914  -0.2451706  -0.31835175 -0.42832947 -0.24856567\n -0.11566162 -0.3612442  -0.38863373 -0.31281662 -0.17101288 -0.31610107\n -0.18756676 -0.14663696 -0.3271942  -0.24609375 -0.21360779 -0.37908936\n -0.37383652 -0.30062103 -0.2510147  -0.25120544 -0.19395447 -0.3088646\n -0.46725845 -0.38407135 -0.34492874 -0.4736023 ]"}}, "num_steps_sampled": 267000, "num_steps_trained": 16896064, "last_target_update_ts": 267000, "num_target_updates": 264001}, "done": false, "episodes_total": 89, "training_iteration": 89, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-23-48", "timestamp": 1609820628, "time_this_iter_s": 54.07293128967285, "time_total_s": 4707.555205345154, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 4707.555205345154, "timesteps_since_restore": 0, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 8.810389610389608, "ram_util_percent": 31.90000000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1416.521983847797, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2096.213057819302, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.846424448291085, "mean_processing_ms": 1.312538719307223, "mean_inference_ms": 0.6592273139249916}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 270000, "timers": {"learn_time_ms": 3.776, "learn_throughput": 16949.465, "update_time_ms": 0.655}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -59.9244270324707, "critic_loss": 2.2204647064208984, "mean_q": 59.71830368041992, "max_q": 88.677978515625, "min_q": 7.982135772705078, "mean_td_error": 0.15224213898181915, "td_error": "[-1.66236877e-01 -8.34884644e-02 -6.87179565e-02 -1.09825134e-01\n -5.73501587e-02 -7.42683411e-02 -1.10992432e-01 -2.21431732e-01\n -3.64761353e-02  1.68251839e+01 -1.29081726e-01 -7.16857910e-02\n -2.16642380e-01 -1.19773865e-01 -4.69207764e-03 -6.86187744e-02\n -1.13616943e-01 -1.08642578e-01 -6.90536499e-02 -2.76947021e-03\n -1.34979248e-01 -2.17473030e-01 -1.48967743e-01 -1.70719147e-01\n -1.73412323e-01 -7.04345703e-02 -2.33768463e-01 -1.13342285e-01\n -9.10110474e-02 -1.32522583e-01 -1.24927521e-01 -1.16577148e-01\n  7.01065063e-02 -1.05457306e-01 -1.75930023e-01 -7.64045715e-02\n -1.24214172e-01 -1.67259216e-01  1.94702148e-02 -1.48353577e-01\n -1.05003357e-01 -1.52048111e-01  2.08129883e-02 -1.66015625e-01\n -1.30096436e-01 -4.01535034e-02 -1.64962769e-01 -3.66592407e-02\n -2.07199097e-01  2.14500427e-02 -2.73767471e-01 -1.13914490e-01\n -2.06459045e-01 -1.39427185e-01 -1.72348022e-01 -1.16203308e-01\n -4.52270508e-02 -7.99636841e-02 -9.87434387e-02 -1.38893127e-01\n -6.40029907e-02 -2.48794556e-01 -7.94296265e-02 -7.50961304e-02]"}}, "num_steps_sampled": 270000, "num_steps_trained": 17088064, "last_target_update_ts": 270000, "num_target_updates": 267001}, "done": false, "episodes_total": 90, "training_iteration": 90, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-24-42", "timestamp": 1609820682, "time_this_iter_s": 53.90022420883179, "time_total_s": 4761.455429553986, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 4761.455429553986, "timesteps_since_restore": 0, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 8.607792207792206, "ram_util_percent": 31.906493506493508}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1419.9958231109222, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1732.6413567921957, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.847177186622815, "mean_processing_ms": 1.3126445914468265, "mean_inference_ms": 0.6594315188061205}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 273000, "timers": {"learn_time_ms": 4.145, "learn_throughput": 15439.659, "update_time_ms": 0.794}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -63.853721618652344, "critic_loss": 0.002318198559805751, "mean_q": 63.66117858886719, "max_q": 87.07864379882812, "min_q": 2.6907191276550293, "mean_td_error": 0.006928779184818268, "td_error": "[ 0.04647064 -0.01451492  0.01544571  0.16199493 -0.03611755  0.0617981\n -0.1203537   0.04245758  0.02588463 -0.02910233  0.02954865  0.00843048\n  0.03392029 -0.00695038 -0.05357361  0.03377151 -0.05848694  0.03605652\n  0.02177429  0.03570175 -0.02980804 -0.02220154 -0.0796051   0.15113068\n -0.01363373  0.14572144 -0.11000776 -0.06787872 -0.08249283 -0.03966141\n  0.00027847 -0.01856232 -0.09355545 -0.02439117 -0.01003265  0.01954651\n  0.10228729 -0.03644562 -0.0478363  -0.00175476 -0.10163879 -0.03102875\n  0.04682922  0.02763748  0.02817917  0.0472641   0.03265381  0.01910019\n -0.00302505  0.06891251 -0.02445984  0.10792542  0.06495667 -0.04788971\n  0.00579071  0.03991699  0.0634079  -0.0158844   0.02867889 -0.00347137\n  0.0226059  -0.07234955 -0.02856445  0.19264221]"}}, "num_steps_sampled": 273000, "num_steps_trained": 17280064, "last_target_update_ts": 273000, "num_target_updates": 270001}, "done": false, "episodes_total": 91, "training_iteration": 91, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-25-36", "timestamp": 1609820736, "time_this_iter_s": 53.80498814582825, "time_total_s": 4815.260417699814, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fb70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 4815.260417699814, "timesteps_since_restore": 0, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 8.355844155844155, "ram_util_percent": 32.0}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1415.044035546438, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [964.4313671783724, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.847903058908821, "mean_processing_ms": 1.3127503634049895, "mean_inference_ms": 0.6596332674711245}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 276000, "timers": {"learn_time_ms": 4.02, "learn_throughput": 15920.683, "update_time_ms": 0.698}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -60.396915435791016, "critic_loss": 0.0026931671891361475, "mean_q": 60.235809326171875, "max_q": 86.43738555908203, "min_q": -0.32375067472457886, "mean_td_error": -0.0010812939144670963, "td_error": "[ 0.11022186 -0.05725861 -0.11567688  0.22395325  0.00275421  0.13327408\n  0.05416107 -0.03453064  0.00631875  0.02607727  0.06136322 -0.06668091\n -0.03723631 -0.01454163 -0.06567383  0.01065063  0.00695419 -0.05567169\n -0.12615967  0.08743286  0.00351334  0.09178162 -0.09381866  0.10020447\n  0.00180817 -0.08967972  0.09422302 -0.02925873  0.10052109  0.11031342\n -0.02702332 -0.09024334 -0.06942749  0.00837708  0.067379   -0.03757095\n  0.02170181  0.070961   -0.01459503 -0.03606415 -0.05727386  0.02473831\n  0.058815    0.03533173  0.04842758 -0.01202774 -0.08156586  0.06483459\n -0.09758759 -0.03946686 -0.06707001 -0.006073   -0.01831436  0.09672928\n -0.02029419 -0.04430389 -0.02976799 -0.02631378  0.00675964 -0.06182861\n -0.04753876 -0.09531021 -0.05323792  0.02030182]"}}, "num_steps_sampled": 276000, "num_steps_trained": 17472064, "last_target_update_ts": 276000, "num_target_updates": 273001}, "done": false, "episodes_total": 92, "training_iteration": 92, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-26-30", "timestamp": 1609820790, "time_this_iter_s": 53.94064903259277, "time_total_s": 4869.201066732407, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fa60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 4869.201066732407, "timesteps_since_restore": 0, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 8.577922077922079, "ram_util_percent": 32.0}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1414.9366157425932, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1405.0539937888561, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.848609173312165, "mean_processing_ms": 1.3128534761531123, "mean_inference_ms": 0.6598317100688592}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 279000, "timers": {"learn_time_ms": 4.103, "learn_throughput": 15597.735, "update_time_ms": 0.704}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -58.76173400878906, "critic_loss": 0.006774380337446928, "mean_q": 58.55827713012695, "max_q": 86.51058197021484, "min_q": 4.919734954833984, "mean_td_error": 0.009319886565208435, "td_error": "[ 7.41500854e-02  9.38758850e-02  9.49783325e-02  5.87768555e-02\n -1.36699677e-02 -1.11503601e-02  7.71408081e-02 -1.52034760e-02\n  6.53724670e-02 -6.57272339e-03 -3.43627930e-02 -7.11898804e-02\n  2.90374756e-02 -3.91998291e-02  6.83975220e-02  8.56857300e-02\n  1.41677856e-02 -6.74247742e-03  2.19116211e-02 -9.07897949e-02\n  5.35736084e-02  6.70280457e-02 -2.82649994e-02 -9.91659164e-02\n -2.03201294e-01 -6.95404053e-01 -5.61408997e-02  7.09743500e-02\n  5.86185455e-02  2.38056183e-01  1.14025116e-01 -8.65764618e-02\n  5.27305603e-02 -5.76019287e-04  7.36999512e-03 -2.15377808e-02\n -7.92083740e-02 -3.98864746e-02  3.42788696e-02  9.77401733e-02\n -4.90951538e-02  8.51974487e-02  6.90460205e-03 -3.92532349e-02\n  4.21600342e-02 -1.45339966e-02  2.28729248e-02  7.10563660e-02\n  2.34222412e-02  1.21372223e-01  8.81958008e-02  5.06591797e-03\n  5.47332764e-02 -9.93728638e-02  2.95677185e-02  8.22677612e-02\n  1.41838074e-01  2.60543823e-02  5.09147644e-02 -2.38952637e-02\n  7.00073242e-02 -3.19862366e-02 -5.68237305e-02  1.10755920e-01]"}}, "num_steps_sampled": 279000, "num_steps_trained": 17664064, "last_target_update_ts": 279000, "num_target_updates": 276001}, "done": false, "episodes_total": 93, "training_iteration": 93, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-27-24", "timestamp": 1609820844, "time_this_iter_s": 53.51324915885925, "time_total_s": 4922.714315891266, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f400>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 4922.714315891266, "timesteps_since_restore": 0, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 8.38684210526316, "ram_util_percent": 32.06578947368421}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1414.4815631805714, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1372.1616749125517, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.8492968478865945, "mean_processing_ms": 1.3129522195190293, "mean_inference_ms": 0.6600274731022442}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 282000, "timers": {"learn_time_ms": 3.669, "learn_throughput": 17443.333, "update_time_ms": 0.636}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -55.818603515625, "critic_loss": 0.0030808127485215664, "mean_q": 55.64393997192383, "max_q": 86.72652435302734, "min_q": -0.3986201286315918, "mean_td_error": -0.040534839034080505, "td_error": "[ 0.13902283 -0.03533173 -0.05852127 -0.0446701   0.04415894 -0.01979828\n -0.10909271 -0.01885986 -0.11351013 -0.07879639 -0.02989197 -0.02351379\n -0.13192749 -0.03269958  0.00159073  0.12438202 -0.10778618 -0.05245972\n -0.00963593 -0.01514435  0.07247028 -0.01312733  0.01280594 -0.0524025\n -0.1084137   0.04080963 -0.12482452 -0.09846878  0.03453064 -0.02465439\n -0.06014252 -0.13420105 -0.10519791  0.03050232 -0.05690384 -0.01545334\n -0.13217545 -0.00961304 -0.09394836 -0.0368042  -0.09692764 -0.03832436\n -0.0389003  -0.07076645 -0.04766083 -0.04363251 -0.05229568  0.02170181\n  0.00819778 -0.11390686 -0.07950592 -0.01966172  0.0625267  -0.09120178\n -0.16309357 -0.08414841 -0.03078461 -0.14065933 -0.06245422 -0.0511322\n  0.00674057  0.01859093 -0.10128403  0.06204987]"}}, "num_steps_sampled": 282000, "num_steps_trained": 17856064, "last_target_update_ts": 282000, "num_target_updates": 279001}, "done": false, "episodes_total": 94, "training_iteration": 94, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-28-17", "timestamp": 1609820897, "time_this_iter_s": 53.608455657958984, "time_total_s": 4976.322771549225, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2ae8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 4976.322771549225, "timesteps_since_restore": 0, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 8.4, "ram_util_percent": 32.1}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1410.6344108651954, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1049.0020932198336, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.849956272510134, "mean_processing_ms": 1.3130532362441543, "mean_inference_ms": 0.6602191993389879}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 285000, "timers": {"learn_time_ms": 4.16, "learn_throughput": 15385.766, "update_time_ms": 0.649}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -66.6788330078125, "critic_loss": 0.0022434431593865156, "mean_q": 66.53120422363281, "max_q": 88.6258773803711, "min_q": 4.565829753875732, "mean_td_error": 0.025873489677906036, "td_error": "[ 0.05652618  0.09443665  0.10276794  0.06381226  0.11400795  0.0049057\n  0.02051544  0.11050034  0.00537109  0.00330353  0.07887268  0.00933075\n -0.0483017   0.05498505 -0.09262848 -0.01909637 -0.02950287  0.04697847\n -0.0300293   0.0552597   0.19856262  0.05158234 -0.01940918 -0.05965424\n -0.10076904  0.09558868  0.01769066  0.08664322 -0.00203705  0.06021881\n  0.05530548  0.10987854 -0.04199219  0.00283813  0.08729553  0.03242111\n  0.030159   -0.02411652  0.04347229  0.0124321   0.03224945  0.10717773\n  0.01368713 -0.00110626 -0.04873657  0.04531097  0.02654266 -0.00585938\n  0.02410507  0.01989746  0.0585022   0.02625656 -0.06149292 -0.03560638\n  0.00427628 -0.01223755  0.16157532 -0.03691864  0.06723785  0.00853729\n -0.02852631  0.03215027  0.00528717  0.0154686 ]"}}, "num_steps_sampled": 285000, "num_steps_trained": 18048064, "last_target_update_ts": 285000, "num_target_updates": 282001}, "done": false, "episodes_total": 95, "training_iteration": 95, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-29-11", "timestamp": 1609820951, "time_this_iter_s": 53.30152440071106, "time_total_s": 5029.624295949936, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 5029.624295949936, "timesteps_since_restore": 0, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 8.314285714285713, "ram_util_percent": 32.111688311688305}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1407.272470506349, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1087.8881364159554, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.8505963017929785, "mean_processing_ms": 1.3131541503658675, "mean_inference_ms": 0.6604081667373931}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 288000, "timers": {"learn_time_ms": 4.194, "learn_throughput": 15258.083, "update_time_ms": 0.761}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -64.24972534179688, "critic_loss": 0.0042903912253677845, "mean_q": 64.07461547851562, "max_q": 89.0031509399414, "min_q": 1.9686381816864014, "mean_td_error": 0.025770416483283043, "td_error": "[ 0.00552702 -0.03825378  0.00440979  0.06414032 -0.06910706 -0.05444336\n  0.01776886 -0.09256363  0.03416443  0.00209808  0.00982666  0.02228928\n  0.02761078  0.03866386 -0.05281734  0.07544327 -0.05744171  0.13801575\n -0.01036835 -0.07263184 -0.09326935  0.01867676 -0.03001785  0.10157013\n -0.03322601 -0.09689331 -0.03985596  0.03521729  0.07469177  0.0275116\n  0.07260895 -0.03397369  0.17384338  0.02728271  0.08709717 -0.08999634\n  0.16674805  0.1000061   0.11190796  0.09394073  0.01090622  0.14301491\n  0.0850296   0.07357025  0.10507965  0.10072327 -0.03333282  0.16332626\n -0.11940765 -0.07529449 -0.02059174  0.18618011 -0.07040405 -0.15459442\n  0.08499908  0.04734039 -0.05838776 -0.1353302  -0.00763702  0.13674164\n  0.0602417   0.16160583  0.09941483  0.19991195]"}}, "num_steps_sampled": 288000, "num_steps_trained": 18240064, "last_target_update_ts": 288000, "num_target_updates": 285001}, "done": false, "episodes_total": 96, "training_iteration": 96, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-30-04", "timestamp": 1609821004, "time_this_iter_s": 53.867457151412964, "time_total_s": 5083.491753101349, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2bf8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 5083.491753101349, "timesteps_since_restore": 0, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 8.30657894736842, "ram_util_percent": 32.19999999999999}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1414.2411416246152, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2083.233568978157, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.85124670808342, "mean_processing_ms": 1.3132509447323442, "mean_inference_ms": 0.660593469476414}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 291000, "timers": {"learn_time_ms": 3.674, "learn_throughput": 17419.11, "update_time_ms": 0.676}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -59.78783416748047, "critic_loss": 0.00406284537166357, "mean_q": 59.589019775390625, "max_q": 89.16875457763672, "min_q": -1.3937989473342896, "mean_td_error": -0.04375381022691727, "td_error": "[-0.09103775 -0.09806824 -0.06705475 -0.02207184  0.04283142 -0.11738968\n -0.08743286  0.0133667  -0.06887817 -0.11333466  0.0136528  -0.38819122\n -0.01403046 -0.05591965  0.01424408 -0.00388718 -0.06739426 -0.0488739\n  0.0064888   0.05596161 -0.09047699 -0.21661377 -0.02653885 -0.06713867\n -0.03987122 -0.09191895  0.13183308 -0.01415253 -0.07469177 -0.01517487\n -0.06442261 -0.04278564  0.01207733 -0.00994873 -0.02687836 -0.0662626\n -0.10775757 -0.015625   -0.05282974 -0.0398407   0.02469254  0.01021576\n -0.0517292   0.07183838  0.02472305 -0.04620361 -0.12696838 -0.15124512\n -0.06815338 -0.07508087 -0.11369324 -0.04910278  0.03365326  0.05626297\n  0.02448654 -0.04441071 -0.06636047  0.00078583 -0.04366493 -0.07631683\n  0.09703064 -0.15512848 -0.00707245 -0.05276489]"}}, "num_steps_sampled": 291000, "num_steps_trained": 18432064, "last_target_update_ts": 291000, "num_target_updates": 288001}, "done": false, "episodes_total": 97, "training_iteration": 97, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-30-59", "timestamp": 1609821059, "time_this_iter_s": 54.31607437133789, "time_total_s": 5137.807827472687, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54c2f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 5137.807827472687, "timesteps_since_restore": 0, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 8.25, "ram_util_percent": 32.19999999999998}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1412.9568265622565, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1288.3782655134846, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.851885154242609, "mean_processing_ms": 1.3133484423969608, "mean_inference_ms": 0.6607780148734199}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 294000, "timers": {"learn_time_ms": 4.09, "learn_throughput": 15647.286, "update_time_ms": 0.674}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -59.869781494140625, "critic_loss": 0.00685627618804574, "mean_q": 59.667598724365234, "max_q": 88.60710906982422, "min_q": 7.1920623779296875, "mean_td_error": 0.06371054798364639, "td_error": "[ 3.92532349e-02  5.27038574e-02  1.22920990e-01  1.72897339e-01\n  5.38024902e-02  1.13869667e-01  1.99734688e-01 -1.81884766e-02\n  1.68369293e-01 -4.35638428e-03  6.52313232e-02  5.86509705e-02\n -9.86018181e-02 -1.41502380e-01 -2.75192261e-02  1.16706848e-01\n  1.86866760e-01 -5.14984131e-03  2.05818176e-01  2.17590332e-02\n  1.43184662e-01  4.85496521e-02  2.34985352e-02  1.55220032e-01\n -1.09542847e-01 -9.01870728e-02  1.73656464e-01  3.09410095e-01\n  7.58285522e-02  6.33697510e-02  1.32797241e-01 -2.13623047e-02\n  1.56841278e-01  8.83560181e-02  9.32312012e-03 -4.94079590e-02\n  2.51922607e-02  1.09275818e-01  4.68330383e-02 -2.79464722e-02\n  8.47740173e-02  1.06616974e-01 -9.29870605e-02  5.76362610e-02\n -8.03527832e-02 -3.98025513e-02  8.97979736e-02  1.34204865e-01\n  2.73124695e-01  1.91993713e-01  2.77252197e-02  6.77566528e-02\n  1.83956146e-01  5.47981262e-02  2.05993652e-04  1.00646973e-01\n  1.61008835e-01 -1.13655090e-01  6.56890869e-02 -6.30378723e-03\n  1.06765747e-01  8.41026306e-02 -3.52401733e-02  1.08856201e-01]"}}, "num_steps_sampled": 294000, "num_steps_trained": 18624064, "last_target_update_ts": 294000, "num_target_updates": 291001}, "done": false, "episodes_total": 98, "training_iteration": 98, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-31-54", "timestamp": 1609821114, "time_this_iter_s": 54.72611737251282, "time_total_s": 5192.5339448452, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54c6a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 5192.5339448452, "timesteps_since_restore": 0, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 9.756410256410257, "ram_util_percent": 32.27564102564104}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1414.0948355678554, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1525.6197181165674, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.8525043370248895, "mean_processing_ms": 1.3134424089029346, "mean_inference_ms": 0.6609592559092244}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 297000, "timers": {"learn_time_ms": 3.916, "learn_throughput": 16341.411, "update_time_ms": 0.661}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -60.66889953613281, "critic_loss": 0.002612228272482753, "mean_q": 60.37955856323242, "max_q": 87.46833801269531, "min_q": 17.711597442626953, "mean_td_error": -0.0021309852600097656, "td_error": "[ 0.05997086 -0.022995   -0.02919388 -0.03181839 -0.02215195  0.01753998\n -0.09127426 -0.00876236 -0.07966232 -0.06893921  0.02723312 -0.04251862\n -0.11418152 -0.00619507  0.17894363 -0.03063202  0.11754608 -0.02788925\n  0.03520966 -0.01747131 -0.12384415 -0.11774445  0.0173645   0.00791168\n -0.07976532 -0.06339264 -0.05345154 -0.04271698  0.00522232 -0.11940765\n -0.07530212 -0.09447479 -0.02841949  0.01889801  0.00151825  0.01562881\n -0.04541397 -0.02809143 -0.01058578 -0.00767517  0.07802963  0.05886841\n  0.03259277  0.03846741  0.05607986  0.12598419  0.05368423  0.02937317\n -0.0931015   0.09762573 -0.03451538 -0.03333282 -0.03834915  0.0006485\n  0.01885986  0.01800156  0.07422638 -0.0330658   0.16443634 -0.06167603\n  0.07348633  0.153656    0.03541565  0.02920532]"}}, "num_steps_sampled": 297000, "num_steps_trained": 18816064, "last_target_update_ts": 297000, "num_target_updates": 294001}, "done": false, "episodes_total": 99, "training_iteration": 99, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-32-47", "timestamp": 1609821167, "time_this_iter_s": 53.17749547958374, "time_total_s": 5245.711440324783, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2ae8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 5245.711440324783, "timesteps_since_restore": 0, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 8.906578947368422, "ram_util_percent": 32.30000000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -3839.1905239557054, "episode_reward_mean": 1421.1770088393978, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2122.312162722068, -3839.1905239557054, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.8531337163656705, "mean_processing_ms": 1.3135316369510122, "mean_inference_ms": 0.6611375307687556}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 300000, "timers": {"learn_time_ms": 3.843, "learn_throughput": 16655.217, "update_time_ms": 0.645}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -64.51681518554688, "critic_loss": 0.006317108869552612, "mean_q": 64.34181213378906, "max_q": 88.28837585449219, "min_q": 3.422544240951538, "mean_td_error": 0.041933707892894745, "td_error": "[ 6.60705566e-03  8.57086182e-02  2.33013153e-01 -4.73480225e-02\n  4.58755493e-02 -7.10525513e-02 -1.40830994e-01 -2.55661011e-02\n  1.23210907e-01  4.10881042e-02 -5.25512695e-02 -7.41958618e-03\n  7.48443604e-02  1.32209778e-01 -3.10974121e-02  8.74977112e-02\n -2.61688232e-03  1.36589050e-01 -7.59963989e-02  2.89115906e-02\n -6.41098022e-02  2.61039734e-02  4.70657349e-02 -6.32858276e-03\n  2.23846436e-02  1.77703857e-01  5.05447388e-02  1.82907104e-01\n  1.34880066e-01  8.06045532e-03  8.63075256e-02  1.92356110e-01\n  1.14440918e-04  1.49917603e-02  6.52084351e-02  2.70309448e-02\n -1.58996582e-01  4.64477539e-02  7.86743164e-02 -1.28173828e-03\n  3.21350098e-02 -1.00440979e-02 -6.63604736e-02  2.08053589e-02\n  4.13627625e-02  1.86843872e-02 -3.61251831e-02  1.99089050e-02\n  9.24491882e-03 -1.16207123e-01  3.92197609e-01  4.75234985e-02\n  1.96556091e-01 -2.51235962e-02 -1.27182007e-02  3.59725952e-01\n -3.73840332e-03  1.03752136e-01 -6.52427673e-02  1.85443878e-01\n -5.28640747e-02 -2.21099854e-02  5.23376465e-02  1.43471241e-01]"}}, "num_steps_sampled": 300000, "num_steps_trained": 19008064, "last_target_update_ts": 300000, "num_target_updates": 297001}, "done": false, "episodes_total": 100, "training_iteration": 100, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-33-41", "timestamp": 1609821221, "time_this_iter_s": 54.403294801712036, "time_total_s": 5300.114735126495, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a28c8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 5300.114735126495, "timesteps_since_restore": 0, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 8.549350649350648, "ram_util_percent": 32.33246753246753}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1470.1735098385357, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1060.4595759580993, 1715.5862666758464, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.862140923213292, "mean_processing_ms": 1.315028451845838, "mean_inference_ms": 0.6642724800674117}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 303000, "timers": {"learn_time_ms": 3.921, "learn_throughput": 16322.035, "update_time_ms": 0.725}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -59.19826126098633, "critic_loss": 0.003066461067646742, "mean_q": 59.018455505371094, "max_q": 90.343017578125, "min_q": 3.156230926513672, "mean_td_error": 0.005980193614959717, "td_error": "[ 0.01271057 -0.0381546  -0.01978302 -0.03455353 -0.06786346  0.07243347\n  0.05104828  0.07988739  0.00912857 -0.0061264  -0.03084183  0.13439178\n -0.06184769 -0.13394165  0.04994202  0.01124573 -0.03953552 -0.02666473\n -0.02437592 -0.03869629  0.07229614  0.09298706 -0.08184814  0.02806854\n -0.02894783 -0.04737854  0.02571869  0.16606903  0.06157684 -0.11598969\n -0.03652954 -0.01540375  0.19450665 -0.07009125 -0.04485321  0.05402756\n -0.07684326  0.01708221 -0.08161926  0.23692799  0.02098083  0.00476074\n  0.10779572  0.01178455  0.02849579  0.0633316  -0.04875183 -0.09237289\n -0.02252197 -0.04331398  0.13374329 -0.01872826  0.00539398 -0.12410164\n  0.02179718  0.06966782  0.04453278  0.09358978 -0.04088306  0.05435944\n -0.07779694 -0.0590744  -0.01649857  0.01838303]"}}, "num_steps_sampled": 303000, "num_steps_trained": 19200064, "last_target_update_ts": 303000, "num_target_updates": 300001}, "done": false, "episodes_total": 101, "training_iteration": 101, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-34-35", "timestamp": 1609821275, "time_this_iter_s": 53.73964524269104, "time_total_s": 5353.854380369186, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fa60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 5353.854380369186, "timesteps_since_restore": 0, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 9.792207792207792, "ram_util_percent": 32.42597402597403}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1470.8071428937753, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1778.9495721997735, 1425.6014848829889, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.8668586282198785, "mean_processing_ms": 1.315888552730837, "mean_inference_ms": 0.6660123646685692}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 306000, "timers": {"learn_time_ms": 3.906, "learn_throughput": 16384.8, "update_time_ms": 0.678}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -63.18496322631836, "critic_loss": 0.00609342847019434, "mean_q": 62.996482849121094, "max_q": 88.89472198486328, "min_q": 7.807724952697754, "mean_td_error": 0.08567577600479126, "td_error": "[-0.02892303  0.03129578  0.11091232  0.09346008  0.06357193  0.14323425\n  0.10031128  0.1581688   0.07106018  0.20458794  0.10635376  0.08506775\n -0.0109787   0.05062103 -0.02896118  0.09994507  0.00084686  0.0138092\n  0.1718216   0.0088501   0.07040024  0.19540787  0.09403992  0.08992004\n  0.11564636  0.1595459   0.09539032  0.21435547  0.02067566  0.08177185\n  0.1758995   0.15713501  0.11679077  0.08060074  0.05897522  0.07365417\n  0.01326752 -0.01113129  0.17133331  0.05716324  0.18247223  0.09122467\n  0.01085663  0.08183098  0.02831268  0.21622849  0.00608158  0.1531372\n  0.17459106 -0.06136322  0.16420841  0.05462646  0.11544418  0.0355835\n  0.10908508  0.10581589  0.03518677  0.07788086  0.1472168   0.04343414\n  0.06817055  0.05856323  0.10036469  0.00839996]"}}, "num_steps_sampled": 306000, "num_steps_trained": 19392064, "last_target_update_ts": 306000, "num_target_updates": 303001}, "done": false, "episodes_total": 102, "training_iteration": 102, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-35-30", "timestamp": 1609821330, "time_this_iter_s": 54.57485365867615, "time_total_s": 5408.429234027863, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 5408.429234027863, "timesteps_since_restore": 0, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 9.969230769230771, "ram_util_percent": 32.5525641025641}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1472.1449049470618, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1559.3776902116174, 1125.6203171617908, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.870253407927444, "mean_processing_ms": 1.3164341699671664, "mean_inference_ms": 0.6671887629076038}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 309000, "timers": {"learn_time_ms": 4.078, "learn_throughput": 15694.033, "update_time_ms": 0.708}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -63.60349655151367, "critic_loss": 0.0025791155640035868, "mean_q": 63.4155387878418, "max_q": 89.63233184814453, "min_q": 1.0949000120162964, "mean_td_error": -0.0007848702371120453, "td_error": "[-0.0105629  -0.05490875 -0.12903118  0.03811073  0.00309753 -0.06734467\n  0.01189423  0.05818176 -0.10406113  0.01322174  0.00200653 -0.07640839\n -0.0225296   0.07291412  0.02935791 -0.17081451  0.06640625 -0.04810715\n  0.01008606  0.10163498 -0.06920624  0.02760315  0.01540756  0.03542328\n -0.03286362 -0.00127411  0.07235527 -0.05892563  0.04728699  0.08808899\n  0.02125549  0.09591222 -0.08952332  0.05268097 -0.04753876 -0.04586029\n  0.03755951  0.09596252  0.04656219  0.03108978  0.07778168  0.0113945\n  0.0925293   0.04880524 -0.00408173 -0.07272339 -0.02695465  0.05980682\n -0.14766693  0.02499008  0.01905823  0.01656723 -0.10565948 -0.02367401\n  0.01521301 -0.00121307  0.07232666 -0.03585052  0.04259491  0.09454727\n -0.11089325  0.02276611 -0.18331146  0.01827621]"}}, "num_steps_sampled": 309000, "num_steps_trained": 19584064, "last_target_update_ts": 309000, "num_target_updates": 306001}, "done": false, "episodes_total": 103, "training_iteration": 103, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-36-24", "timestamp": 1609821384, "time_this_iter_s": 54.72395849227905, "time_total_s": 5463.153192520142, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f8c8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 5463.153192520142, "timesteps_since_restore": 0, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 9.216666666666669, "ram_util_percent": 32.52948717948718}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1470.1852058219117, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [929.6504046468336, 1119.2006153250275, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.872835665684587, "mean_processing_ms": 1.3168760783370497, "mean_inference_ms": 0.6680512931483479}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 312000, "timers": {"learn_time_ms": 3.918, "learn_throughput": 16335.743, "update_time_ms": 0.778}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -62.11156463623047, "critic_loss": 0.002571261487901211, "mean_q": 61.92966842651367, "max_q": 90.15251159667969, "min_q": -0.9054898023605347, "mean_td_error": 0.005039051175117493, "td_error": "[ 0.0358696  -0.06142044  0.00079727  0.13318634  0.26600647 -0.0401535\n  0.10964966 -0.01324463  0.08223724 -0.04217529  0.13481903 -0.04969025\n -0.04230499  0.06670761  0.01805496  0.04496765 -0.1437912   0.05437469\n -0.01005554 -0.13508606  0.13471985  0.0218811  -0.06101227 -0.00941467\n -0.02820587  0.0004425  -0.0457077   0.01843262 -0.05935669 -0.0218811\n  0.0164032  -0.02093887  0.01258087 -0.00257111  0.05853271 -0.07539749\n -0.03195572 -0.01569366 -0.01649475  0.05073547  0.04488087  0.02336121\n  0.0750885  -0.03920746 -0.04628372  0.04212189 -0.13394928  0.01716614\n  0.0025177  -0.0561676  -0.04354477  0.03313684 -0.07093048 -0.0162735\n  0.00843811  0.04452944 -0.02577972  0.03923798 -0.03941345  0.00038242\n  0.08779144  0.03634644  0.00157166  0.00363159]"}}, "num_steps_sampled": 312000, "num_steps_trained": 19776064, "last_target_update_ts": 312000, "num_target_updates": 309001}, "done": false, "episodes_total": 104, "training_iteration": 104, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-37-19", "timestamp": 1609821439, "time_this_iter_s": 54.50043725967407, "time_total_s": 5517.653629779816, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5582f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 5517.653629779816, "timesteps_since_restore": 0, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 8.458974358974361, "ram_util_percent": 32.58076923076922}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1482.3765849041718, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2338.3385235509663, 1514.6348566743522, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.874802898175517, "mean_processing_ms": 1.3172418546766331, "mean_inference_ms": 0.6687270639458944}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 315000, "timers": {"learn_time_ms": 3.999, "learn_throughput": 16002.877, "update_time_ms": 0.742}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -63.9312629699707, "critic_loss": 0.0033912097569555044, "mean_q": 63.76258087158203, "max_q": 90.37596893310547, "min_q": 13.240017890930176, "mean_td_error": 0.010930895805358887, "td_error": "[ 0.10510254 -0.02137756  0.19973755  0.01976776 -0.07440186 -0.02806091\n -0.0989399  -0.07440948 -0.02260208  0.00839615  0.05980682  0.02201462\n -0.0702858   0.02439499 -0.0810318  -0.06574249  0.03023529 -0.02564621\n -0.09975433  0.0663681   0.03355408 -0.04036713 -0.05223846  0.07644272\n  0.04748535  0.28321838 -0.07175827  0.09402084 -0.03303909  0.04351044\n -0.05120087  0.02399063 -0.03183746  0.2360611   0.13114166 -0.00080872\n -0.06325531 -0.03031921  0.05729294 -0.04724121  0.03482056 -0.02860451\n -0.11420441  0.04957581  0.01558304 -0.0286026  -0.07128525  0.09999084\n  0.06482315 -0.03038025  0.1515503   0.00400162 -0.02554321  0.05116272\n  0.06731415 -0.02075195  0.07644653 -0.09055328  0.00233841 -0.01968384\n  0.01114655  0.02371216 -0.00367737  0.00217438]"}}, "num_steps_sampled": 315000, "num_steps_trained": 19968064, "last_target_update_ts": 315000, "num_target_updates": 312001}, "done": false, "episodes_total": 105, "training_iteration": 105, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-38-15", "timestamp": 1609821495, "time_this_iter_s": 55.677125215530396, "time_total_s": 5573.330754995346, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5586a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 5573.330754995346, "timesteps_since_restore": 0, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 9.303797468354428, "ram_util_percent": 32.599999999999994}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1482.8861481550578, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1565.5911817629587, 817.5017468072697, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.8762718242717105, "mean_processing_ms": 1.3175494454348324, "mean_inference_ms": 0.6692628747903057}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 318000, "timers": {"learn_time_ms": 4.287, "learn_throughput": 14930.334, "update_time_ms": 0.718}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -64.39903259277344, "critic_loss": 0.002923036692664027, "mean_q": 64.2493896484375, "max_q": 87.5083999633789, "min_q": 4.679879665374756, "mean_td_error": -0.0082545205950737, "td_error": "[ 0.01311493 -0.00389099 -0.15325165 -0.06952286  0.01078796 -0.04639053\n  0.00216675 -0.03900909 -0.00489807  0.01670074  0.0317688  -0.0550766\n -0.06461334  0.04319     0.00440216 -0.07487488  0.01405334  0.03713989\n  0.09444427 -0.07632828 -0.1003418   0.03429413 -0.11995697 -0.06668091\n -0.04248047 -0.02428436  0.04400253  0.01620483  0.07598829  0.13713264\n  0.01891136  0.02038574  0.08435059  0.1278696   0.01761627  0.00672913\n  0.01911163 -0.18801117  0.03311539  0.06760406 -0.07568359 -0.07807159\n  0.10665894 -0.04120636 -0.04112244 -0.09197998 -0.19095612  0.05367279\n -0.08403015 -0.04602814 -0.08735657 -0.02721024  0.09130096 -0.02993011\n  0.02108765 -0.04576111  0.02163315  0.18486023 -0.01087189 -0.03219223\n  0.01669312  0.04719543 -0.04357147  0.0131073 ]"}}, "num_steps_sampled": 318000, "num_steps_trained": 20160064, "last_target_update_ts": 318000, "num_target_updates": 315001}, "done": false, "episodes_total": 106, "training_iteration": 106, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-39-09", "timestamp": 1609821549, "time_this_iter_s": 54.58479404449463, "time_total_s": 5627.915549039841, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc558ae8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 5627.915549039841, "timesteps_since_restore": 0, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 9.605128205128207, "ram_util_percent": 32.69358974358973}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1494.8498964484997, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2013.8765761514996, 1270.749013965709, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.8776569587712, "mean_processing_ms": 1.3177867888459232, "mean_inference_ms": 0.6697090466787451}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 321000, "timers": {"learn_time_ms": 4.0, "learn_throughput": 16000.111, "update_time_ms": 0.679}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -62.567440032958984, "critic_loss": 0.0021854215301573277, "mean_q": 62.35669708251953, "max_q": 88.42250061035156, "min_q": 0.8091750144958496, "mean_td_error": 0.009035776369273663, "td_error": "[ 0.13011932  0.05273438  0.04440308 -0.00154114  0.0342598  -0.04624176\n -0.05827332 -0.07863617  0.04611969  0.04064178 -0.01719666  0.01965332\n -0.04335403 -0.00315857 -0.02463913  0.00092697 -0.00749207 -0.07975769\n  0.06841278 -0.02482605 -0.05224991  0.07493973  0.02725983 -0.01317596\n -0.09372711  0.00651932  0.00554276  0.04512787 -0.03168488  0.19894409\n -0.10982639  0.05877686  0.1418724  -0.02999115 -0.06548309  0.02730179\n -0.03514862  0.06422424 -0.04893112 -0.0463562  -0.05763245  0.03298569\n -0.06003571 -0.03899384  0.04900551 -0.00575256  0.04124451  0.05588531\n -0.05740356 -0.01234818 -0.03890228  0.00608826  0.01524353 -0.05419159\n  0.05492401  0.0006485   0.06316376  0.11138153  0.11500168  0.00046539\n  0.05975342 -0.01826477  0.10683441  0.03310013]"}}, "num_steps_sampled": 321000, "num_steps_trained": 20352064, "last_target_update_ts": 321000, "num_target_updates": 318001}, "done": false, "episodes_total": 107, "training_iteration": 107, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-40-04", "timestamp": 1609821604, "time_this_iter_s": 55.12031126022339, "time_total_s": 5683.035860300064, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fa60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 5683.035860300064, "timesteps_since_restore": 0, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 9.246835443037977, "ram_util_percent": 32.69746835443036}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1507.085781887842, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2494.3375578999, 1788.2859632752227, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.878946220045861, "mean_processing_ms": 1.317986236187316, "mean_inference_ms": 0.6701033425595798}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 324000, "timers": {"learn_time_ms": 4.01, "learn_throughput": 15959.492, "update_time_ms": 0.653}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -64.5035171508789, "critic_loss": 0.005990313831716776, "mean_q": 64.34845733642578, "max_q": 89.81281280517578, "min_q": 6.107024669647217, "mean_td_error": 0.07974902540445328, "td_error": "[ 6.05087280e-02 -1.37214661e-02  6.60858154e-02  6.55364990e-02\n  9.10873413e-02  6.36749268e-02  1.12518311e-01  1.08665466e-01\n  1.15791321e-01  3.55930328e-02 -2.24761963e-02  6.07528687e-02\n  1.24465942e-01  1.22268677e-01  1.61846161e-01 -4.74853516e-02\n  6.98471069e-02  3.91845703e-02  1.32125854e-01  5.12237549e-02\n  9.09805298e-02  1.61289215e-01  1.27351761e-01  1.23416901e-01\n  1.43221855e-01  3.37181091e-02  1.12068176e-01  6.91909790e-02\n  4.94842529e-02  1.19338989e-01  8.99009705e-02  5.78117371e-02\n  1.94473267e-02  1.28501892e-01  1.46659851e-01  2.42080688e-02\n  2.45208740e-02  2.61199951e-01  1.06655121e-01  1.19354248e-01\n  1.23321533e-01  1.25160217e-01  1.26457214e-01  2.62687683e-01\n  1.23001099e-01 -1.98364258e-04  6.45103455e-02  1.48338318e-01\n -3.51333618e-03  1.71821594e-01  6.18515015e-02 -8.14743042e-02\n  1.52801514e-01  1.02867126e-01  1.67884827e-01 -1.84106827e-03\n  2.81581879e-02  3.76262665e-02  9.80453491e-02 -8.36410522e-02\n  1.25694275e-01  6.90002441e-02 -4.18205261e-02 -7.86151886e-02]"}}, "num_steps_sampled": 324000, "num_steps_trained": 20544064, "last_target_update_ts": 324000, "num_target_updates": 321001}, "done": false, "episodes_total": 108, "training_iteration": 108, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-41-00", "timestamp": 1609821660, "time_this_iter_s": 55.739527225494385, "time_total_s": 5738.7753875255585, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fea0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 5738.7753875255585, "timesteps_since_restore": 0, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 8.392405063291138, "ram_util_percent": 32.69999999999998}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1511.4253656730411, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2222.244341795145, 807.5946343155173, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.879973040514911, "mean_processing_ms": 1.318150894450252, "mean_inference_ms": 0.6704580432981766}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 327000, "timers": {"learn_time_ms": 4.091, "learn_throughput": 15644.824, "update_time_ms": 0.718}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -61.99604797363281, "critic_loss": 0.0043039764277637005, "mean_q": 61.83493423461914, "max_q": 89.30573272705078, "min_q": -0.8504160642623901, "mean_td_error": -0.04579984396696091, "td_error": "[-0.00988388 -0.04639435 -0.01626587 -0.05292892 -0.03359866 -0.1006012\n  0.06428528  0.03975677 -0.07437134 -0.12237167 -0.12694931 -0.10248546\n -0.08533096 -0.1934433   0.00216675 -0.09523773 -0.02098465 -0.12218475\n -0.00991821 -0.03811646 -0.09566689  0.02886963 -0.00374031 -0.15367126\n  0.02171326 -0.16098022  0.12901306 -0.06336689  0.0187912   0.2752838\n -0.1260376   0.0007019  -0.18286896 -0.05173492  0.08181763 -0.06994629\n  0.00713348  0.00834656 -0.06427002 -0.10431671 -0.06497574  0.0038681\n -0.03221893  0.02281189 -0.05050659 -0.06658936 -0.02136612 -0.08406067\n -0.10387421 -0.03025436 -0.2136116   0.01847839 -0.02826691 -0.04679489\n -0.01671982 -0.03012848 -0.00602722 -0.0569458  -0.07894135 -0.15187073\n -0.0526123  -0.11445618 -0.01148224 -0.06485748]"}}, "num_steps_sampled": 327000, "num_steps_trained": 20736064, "last_target_update_ts": 327000, "num_target_updates": 324001}, "done": false, "episodes_total": 109, "training_iteration": 109, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-41-55", "timestamp": 1609821715, "time_this_iter_s": 55.30981421470642, "time_total_s": 5794.085201740265, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a28c8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 5794.085201740265, "timesteps_since_restore": 0, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 9.432911392405062, "ram_util_percent": 32.69999999999998}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1510.9502133708747, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [760.0794040989045, 1434.2923601191646, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.881052096375122, "mean_processing_ms": 1.3183174679882916, "mean_inference_ms": 0.6708013664560789}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 330000, "timers": {"learn_time_ms": 4.354, "learn_throughput": 14697.759, "update_time_ms": 0.733}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -60.20724105834961, "critic_loss": 25.776222229003906, "mean_q": 60.052825927734375, "max_q": 91.48426055908203, "min_q": 2.4745912551879883, "mean_td_error": 0.8809055089950562, "td_error": "[ 5.56793213e-02  5.38177490e-02  7.66410828e-02 -3.90415192e-02\n  1.91574097e-02 -7.05146790e-02 -7.51724243e-02  1.40838623e-02\n  6.90307617e-02  2.18093872e-01 -9.21936035e-02  5.74336548e+01\n -6.60896301e-02 -1.44119263e-02 -1.41914368e-01  1.15028381e-01\n -9.17434692e-03 -1.10290527e-01  1.12953186e-01 -5.69000244e-02\n  7.07244873e-02 -4.33788300e-02 -2.85377502e-02 -4.16030884e-02\n  9.81101990e-02 -2.58712769e-02 -2.69454956e-01 -1.48468018e-01\n  2.26898193e-02 -2.35137939e-02 -1.86233521e-01 -1.79740906e-01\n -1.31935120e-01  5.68714142e-02  9.32769775e-02 -7.04193115e-03\n -2.26058960e-02  1.60408020e-02 -1.59080505e-01  4.77066040e-02\n  3.87115479e-02 -3.55751514e-01  2.15911865e-03  2.90069580e-02\n  1.88480377e-01 -7.21511841e-02 -1.43070221e-02  7.38830566e-02\n  1.42326355e-02 -8.57353210e-03 -1.52702332e-01 -1.56356812e-01\n  5.59272766e-02  7.55462646e-02 -1.86805725e-02  1.90757751e-01\n -2.92117596e-02 -3.83758545e-03 -4.98199463e-02 -4.48837280e-02\n  1.29028320e-01 -6.91604614e-02 -5.92575073e-02 -1.54800415e-02]"}}, "num_steps_sampled": 330000, "num_steps_trained": 20928064, "last_target_update_ts": 330000, "num_target_updates": 327001}, "done": false, "episodes_total": 110, "training_iteration": 110, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-42-49", "timestamp": 1609821769, "time_this_iter_s": 53.85897779464722, "time_total_s": 5847.944179534912, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 5847.944179534912, "timesteps_since_restore": 0, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 10.442857142857141, "ram_util_percent": 32.75194805194807}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1509.633531164882, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1302.6241395198547, 1622.3671759308284, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.882089960664977, "mean_processing_ms": 1.3184909094316337, "mean_inference_ms": 0.6711300489292973}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 333000, "timers": {"learn_time_ms": 3.786, "learn_throughput": 16906.125, "update_time_ms": 0.701}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -55.46528244018555, "critic_loss": 46.2245979309082, "mean_q": 55.31138610839844, "max_q": 90.20751953125, "min_q": -0.5408220887184143, "mean_td_error": 0.857708215713501, "td_error": "[-2.7485657e-01 -1.1729145e-01 -3.2518196e-01 -3.6596680e-01\n -5.0495911e-01 -3.4234619e-01 -4.0846634e-01 -4.6972275e-01\n -2.9737473e-01 -4.8531342e-01 -4.3695831e-01 -3.0156708e-01\n -3.0630493e-01 -3.1534958e-01 -2.9041290e-01 -4.9170685e-01\n -4.5184326e-01 -3.1301880e-01 -1.6116333e-01 -4.1326904e-01\n -4.8569489e-01 -5.6058407e-02 -4.1750336e-01 -2.5186920e-01\n -2.8232384e-01 -3.4903717e-01 -1.6751671e-01 -4.8462677e-01\n -2.4571991e-01 -3.4722137e-01 -4.4795227e-01 -2.7028275e-01\n -1.7042160e-01 -3.8873672e-01 -5.1966095e-01 -3.9121628e-01\n -2.1695709e-01 -3.7297058e-01 -3.9957809e-01 -4.5494461e-01\n -3.7459564e-01 -3.1419754e-01 -4.8129272e-01  7.6865845e+01\n -3.2982635e-01 -3.3324432e-01 -3.9014500e-01 -5.0703049e-01\n -4.5789719e-01 -2.7765274e-01 -3.4600449e-01 -4.5380783e-01\n -2.6453972e-01 -3.9621735e-01 -3.4704590e-01 -2.7100372e-01\n -3.7004852e-01 -1.5453339e-01 -2.3676682e-01 -2.6569366e-01\n -3.6194611e-01 -3.7908936e-01 -5.1930237e-01 -3.4727478e-01]"}}, "num_steps_sampled": 333000, "num_steps_trained": 21120064, "last_target_update_ts": 333000, "num_target_updates": 330001}, "done": false, "episodes_total": 111, "training_iteration": 111, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-43-43", "timestamp": 1609821823, "time_this_iter_s": 53.59061145782471, "time_total_s": 5901.534790992737, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a26a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 5901.534790992737, "timesteps_since_restore": 0, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 8.914473684210526, "ram_util_percent": 32.80000000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1508.7114174866595, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1530.1558081086016, 2131.3394730921996, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.883092219911357, "mean_processing_ms": 1.3186818030966199, "mean_inference_ms": 0.6714489641229044}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 336000, "timers": {"learn_time_ms": 4.291, "learn_throughput": 14913.495, "update_time_ms": 0.746}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -62.813926696777344, "critic_loss": 0.0018801460973918438, "mean_q": 62.630672454833984, "max_q": 91.3311767578125, "min_q": 1.825049638748169, "mean_td_error": -0.010776001960039139, "td_error": "[ 0.04414368 -0.01250458 -0.06944275 -0.01725388 -0.02867889 -0.0248642\n  0.02667236  0.02019501 -0.04335022  0.0612793  -0.03653717  0.02708435\n  0.0388031  -0.07942963 -0.02247238  0.04264832  0.01361465  0.00881958\n  0.00452423 -0.03432465 -0.06221581 -0.01685333  0.02788544  0.08880615\n -0.01159668 -0.02840424  0.00064087 -0.04668427  0.03139138 -0.08951569\n -0.02301025 -0.10137177  0.00797844  0.01855469  0.06381607 -0.00605774\n -0.06460571 -0.12301254  0.07733154 -0.04098511 -0.13787842 -0.05150604\n -0.02136993 -0.04676819  0.16896057 -0.07936859 -0.03977966  0.02450562\n  0.01049042 -0.00477982 -0.03032684  0.00173044 -0.00720978 -0.06682587\n  0.01052856  0.07858276  0.09237671 -0.04972839 -0.08473969 -0.03926086\n  0.00621796 -0.01743698 -0.0847168   0.057621  ]"}}, "num_steps_sampled": 336000, "num_steps_trained": 21312064, "last_target_update_ts": 336000, "num_target_updates": 333001}, "done": false, "episodes_total": 112, "training_iteration": 112, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-44-37", "timestamp": 1609821877, "time_this_iter_s": 54.18917655944824, "time_total_s": 5955.723967552185, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc55a2f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 5955.723967552185, "timesteps_since_restore": 0, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 8.434615384615384, "ram_util_percent": 32.848717948717955}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1499.424188113102, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1202.6165357364655, 1987.765003373451, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.883887751208851, "mean_processing_ms": 1.3188481826586402, "mean_inference_ms": 0.6717390217585882}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 339000, "timers": {"learn_time_ms": 4.204, "learn_throughput": 15223.125, "update_time_ms": 0.695}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -62.66126251220703, "critic_loss": 0.0035206496249884367, "mean_q": 62.490135192871094, "max_q": 89.32160186767578, "min_q": 0.9465989470481873, "mean_td_error": -0.02416539564728737, "td_error": "[ 0.16146088  0.06549835 -0.08030319 -0.00267792 -0.0316124  -0.0457077\n -0.03905487 -0.02233887 -0.22098541  0.0082016  -0.18423939 -0.10523224\n -0.02249146 -0.03051758 -0.13280487 -0.03873444  0.10849762 -0.00125885\n -0.00499725 -0.09469223  0.25679016 -0.03937531 -0.06692505 -0.02536011\n  0.02289963 -0.0287323  -0.00322723  0.00516129 -0.02571106 -0.07755661\n  0.09895325  0.06080627 -0.1272049  -0.09705353  0.0589447   0.02153778\n -0.10903931 -0.06309891 -0.05268097 -0.05846786 -0.03378296 -0.07873917\n -0.11779785  0.03527069 -0.00268555 -0.03488922 -0.0536232  -0.00247192\n  0.04550934 -0.00227356 -0.09111786 -0.1115799  -0.0707016  -0.08214569\n  0.00127411  0.08079147  0.0165329  -0.01199269  0.04179764 -0.03162384\n -0.05282593  0.07497406 -0.01377106 -0.08738327]"}}, "num_steps_sampled": 339000, "num_steps_trained": 21504064, "last_target_update_ts": 339000, "num_target_updates": 336001}, "done": false, "episodes_total": 113, "training_iteration": 113, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-45-32", "timestamp": 1609821932, "time_this_iter_s": 55.11052584648132, "time_total_s": 6010.834493398666, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc55a6a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 6010.834493398666, "timesteps_since_restore": 0, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 8.626923076923077, "ram_util_percent": 32.816666666666684}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1493.3466857779752, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1380.0147698608052, 1141.9422949047678, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.88450503844628, "mean_processing_ms": 1.3190080864760205, "mean_inference_ms": 0.6720139066166049}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 342000, "timers": {"learn_time_ms": 3.975, "learn_throughput": 16099.623, "update_time_ms": 0.632}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -65.86060333251953, "critic_loss": 0.002728126710280776, "mean_q": 65.697265625, "max_q": 90.52733612060547, "min_q": 15.710135459899902, "mean_td_error": 0.009606733918190002, "td_error": "[ 0.00740814  0.02918243 -0.04091644  0.01220703  0.00913239  0.0705452\n  0.03275681  0.08512878  0.00131226  0.05692291  0.09797668 -0.05846024\n -0.02461243  0.13318634  0.00386047  0.0332489   0.00385284 -0.07460022\n  0.06084442 -0.06917572 -0.05317307  0.09382629  0.03614426 -0.00894165\n  0.02078629 -0.00560665 -0.03256989 -0.04557037 -0.06009674  0.06069946\n -0.12042999 -0.06479645  0.10608673 -0.04062653  0.04216766 -0.0067215\n  0.07989502 -0.04297638  0.07180786  0.0030899   0.05286407  0.02835846\n -0.05135345  0.00025177  0.02838898 -0.07602692  0.2032013  -0.07969666\n  0.22847748 -0.00504303 -0.0231781   0.0421524   0.109478   -0.09857178\n  0.02644348 -0.01463699  0.02489471 -0.09289551 -0.02223206 -0.14009094\n  0.00898361  0.06161499  0.02273178 -0.02207947]"}}, "num_steps_sampled": 342000, "num_steps_trained": 21696064, "last_target_update_ts": 342000, "num_target_updates": 339001}, "done": false, "episodes_total": 114, "training_iteration": 114, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-46-26", "timestamp": 1609821986, "time_this_iter_s": 53.89028453826904, "time_total_s": 6064.724777936935, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc55aae8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 6064.724777936935, "timesteps_since_restore": 0, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 8.650649350649351, "ram_util_percent": 32.845454545454565}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1492.91122619806, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1098.3963369132414, 1045.2608820849264, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.885137297710968, "mean_processing_ms": 1.3191453035309657, "mean_inference_ms": 0.672278095036133}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 345000, "timers": {"learn_time_ms": 3.939, "learn_throughput": 16245.776, "update_time_ms": 0.753}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -65.72630310058594, "critic_loss": 0.016630152240395546, "mean_q": 65.53471374511719, "max_q": 92.33040618896484, "min_q": 2.000436544418335, "mean_td_error": 0.14501222968101501, "td_error": "[ 0.14089966  0.28020096  0.10421753  0.13921356  0.15377808  0.16713333\n  0.16940308  0.41666698  0.26000977  0.05284882  0.09391785  0.2392807\n  0.21378326  0.21623993  0.13733673  0.40018082  0.11923218  0.22638702\n  0.01836395  0.10251617  0.08424759  0.16386414  0.18613434  0.17107391\n -0.01644897  0.36123657  0.22276306  0.1725769   0.12976074 -0.11987305\n  0.11181259  0.24198258  0.10218048  0.02500916  0.37926483  0.17360687\n -0.09433746  0.06030273  0.11027527  0.05690765  0.06043243  0.18884277\n  0.13445282  0.05974579  0.05893326  0.29768372  0.032547    0.03242493\n  0.18537903  0.14244843  0.18103981  0.12076187  0.15037155  0.10456848\n  0.22683716  0.17868805  0.20776749  0.22695541  0.12499619  0.02367401\n  0.21176529 -0.13226318  0.21115112  0.07762909]"}}, "num_steps_sampled": 345000, "num_steps_trained": 21888064, "last_target_update_ts": 345000, "num_target_updates": 342001}, "done": false, "episodes_total": 115, "training_iteration": 115, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-47-21", "timestamp": 1609822041, "time_this_iter_s": 54.55190420150757, "time_total_s": 6119.276682138443, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2bf8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 6119.276682138443, "timesteps_since_restore": 0, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 8.461538461538462, "ram_util_percent": 32.87820512820513}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1505.3789098013597, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2292.0292424148865, 188.29686392552995, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.885809562668169, "mean_processing_ms": 1.319287726203415, "mean_inference_ms": 0.6725413129982647}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 348000, "timers": {"learn_time_ms": 4.088, "learn_throughput": 15656.413, "update_time_ms": 0.716}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -64.92572784423828, "critic_loss": 0.026415972039103508, "mean_q": 64.76773834228516, "max_q": 91.84900665283203, "min_q": 22.31660270690918, "mean_td_error": -0.18549826741218567, "td_error": "[-0.06967163 -0.11010742 -0.21218109 -0.24317169 -0.24828339 -0.1730156\n -0.10110474 -0.08703613 -0.2596283  -0.15175629 -0.15470886 -0.20439148\n -0.17848206 -0.17498016 -0.18629074 -0.11055756 -0.14065552 -0.262146\n -0.20317078 -0.15144348 -0.19070435 -0.15945435  0.05368042 -0.26528168\n -0.08199692 -0.03992462 -0.34842682 -0.1684227  -0.08589935 -0.30312347\n -0.22144318 -0.0867157  -0.2340622  -0.1726265  -0.1405487  -0.02853394\n -0.2839508   0.16085434 -0.1384983  -0.33433533 -0.23664093 -0.14802551\n -0.20677948 -0.29380608 -0.18498993 -0.25371933 -0.25120544 -0.20010376\n -0.17079163 -0.13379669 -0.18330383 -0.19672394 -0.1530075  -0.2214508\n -0.15556717 -0.11872864 -1.0160522  -0.19869614 -0.18308449 -0.14976501\n -0.17381287 -0.17185974 -0.15485382 -0.2229271 ]"}}, "num_steps_sampled": 348000, "num_steps_trained": 22080064, "last_target_update_ts": 348000, "num_target_updates": 345001}, "done": false, "episodes_total": 116, "training_iteration": 116, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-48-16", "timestamp": 1609822096, "time_this_iter_s": 55.297688722610474, "time_total_s": 6174.5743708610535, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a21e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 6174.5743708610535, "timesteps_since_restore": 0, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 8.856962025316454, "ram_util_percent": 32.837974683544324}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1525.0657774766826, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2156.9836314578047, 1032.594893286371, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.886626250402298, "mean_processing_ms": 1.319418575751335, "mean_inference_ms": 0.6727945266650806}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 351000, "timers": {"learn_time_ms": 4.259, "learn_throughput": 15028.13, "update_time_ms": 0.744}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -59.49517059326172, "critic_loss": 0.0038252833765000105, "mean_q": 59.31085205078125, "max_q": 91.843994140625, "min_q": 6.816205024719238, "mean_td_error": -0.042703598737716675, "td_error": "[ 0.08268738  0.02922821 -0.08453369 -0.05820465 -0.06873703  0.1570282\n  0.05556107 -0.11513901 -0.04346466 -0.0872345  -0.09396744 -0.08382034\n -0.02500916  0.0128231   0.0132637   0.00171661  0.04062653 -0.0579071\n -0.14884567 -0.09812164 -0.10796356  0.0109787   0.04148865 -0.12229538\n -0.0265007   0.00079346 -0.09585571 -0.10458374 -0.17160034 -0.1261406\n  0.01929092  0.00535583 -0.04040909 -0.05114365 -0.04747963 -0.01605415\n -0.09949493 -0.13002205 -0.07477951  0.06340027 -0.01012421 -0.00428963\n -0.08322525  0.01634598  0.12516785  0.05393982 -0.0112915  -0.05158234\n -0.09703064 -0.05189514 -0.13927078  0.06138229 -0.21481323  0.02706146\n -0.1179657  -0.10314178 -0.08660889 -0.09577179 -0.02085114 -0.06859207\n  0.04729462 -0.06759644 -0.08262634 -0.11248016]"}}, "num_steps_sampled": 351000, "num_steps_trained": 22272064, "last_target_update_ts": 351000, "num_target_updates": 348001}, "done": false, "episodes_total": 117, "training_iteration": 117, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-49-10", "timestamp": 1609822150, "time_this_iter_s": 54.07399845123291, "time_total_s": 6228.648369312286, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 6228.648369312286, "timesteps_since_restore": 0, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 9.314285714285711, "ram_util_percent": 32.80000000000002}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1539.6775760693772, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2493.7747525558207, 988.4924645765291, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.887462256179931, "mean_processing_ms": 1.3195362444417083, "mean_inference_ms": 0.6730365750780015}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 354000, "timers": {"learn_time_ms": 4.095, "learn_throughput": 15628.611, "update_time_ms": 0.741}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -65.97200012207031, "critic_loss": 0.011393729597330093, "mean_q": 65.83621978759766, "max_q": 91.78314971923828, "min_q": 1.0689290761947632, "mean_td_error": -0.0644940659403801, "td_error": "[-0.06323242 -0.23316193 -0.05319214 -0.07635498 -0.11161423  0.05007935\n -0.14173698 -0.1353836   0.01779938  0.0190506  -0.07571983 -0.01548767\n  0.03356612 -0.16403961  0.04917145 -0.08681488 -0.14582062 -0.05063629\n -0.0659523  -0.06314087 -0.00656891 -0.03277588 -0.06021881 -0.08654022\n -0.07875061 -0.03809357 -0.12067413 -0.9443054   0.04946899 -0.10840607\n -0.26970673 -0.11618042 -0.01397705 -0.09801102 -0.06115723 -0.1075058\n -0.16734695 -0.06563568  0.16423798  0.01024628 -0.07440186 -0.06578827\n -0.06984711 -0.0138092   0.00489044  0.01216888 -0.06107712 -0.09778595\n  0.0607605  -0.12693024 -0.04837036  0.00722504 -0.18601227  0.09919739\n  0.02449036 -0.06813812 -0.05448151 -0.00933075  0.00699615  0.0488205\n  0.01774597 -0.03274918 -0.04402924  0.00735855]"}}, "num_steps_sampled": 354000, "num_steps_trained": 22464064, "last_target_update_ts": 354000, "num_target_updates": 351001}, "done": false, "episodes_total": 118, "training_iteration": 118, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-50-06", "timestamp": 1609822206, "time_this_iter_s": 55.881245851516724, "time_total_s": 6284.529615163803, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fa60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 6284.529615163803, "timesteps_since_restore": 0, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 9.1975, "ram_util_percent": 32.800000000000004}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1550.806955367715, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2101.430394410294, 1258.5046335313136, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.888322596256906, "mean_processing_ms": 1.3196319541109642, "mean_inference_ms": 0.6732697171219876}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 357000, "timers": {"learn_time_ms": 4.157, "learn_throughput": 15395.472, "update_time_ms": 0.713}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -63.64166259765625, "critic_loss": 0.002814936451613903, "mean_q": 63.430259704589844, "max_q": 89.70899200439453, "min_q": 5.529843330383301, "mean_td_error": -0.0020440295338630676, "td_error": "[ 0.10680771 -0.07076645  0.0271759   0.07559204 -0.0680542  -0.12026978\n -0.03844452  0.10626984  0.04985619 -0.0326004  -0.0583725   0.0307312\n -0.02031708  0.0733757  -0.00536346 -0.00462341  0.03807831 -0.03446531\n  0.01334381  0.04989624 -0.04364967 -0.00611877 -0.11474609  0.1358757\n  0.01856232 -0.10260773  0.04595566 -0.06542015  0.0511055   0.04844666\n -0.00382996 -0.00765991  0.09836578  0.02046585  0.04878998 -0.00247192\n -0.03136444 -0.0331955  -0.00311661  0.01016235  0.00054169 -0.0949707\n  0.09607697 -0.05415726  0.11283588 -0.03983307  0.11927032  0.11824799\n -0.07728577 -0.14906311 -0.02592468  0.09785461 -0.01003265  0.02984619\n -0.0275383   0.0308075   0.01616669 -0.06967926 -0.22723389  0.02977753\n -0.00570679 -0.06067657 -0.03417206 -0.08736801]"}}, "num_steps_sampled": 357000, "num_steps_trained": 22656064, "last_target_update_ts": 357000, "num_target_updates": 354001}, "done": false, "episodes_total": 119, "training_iteration": 119, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-51-01", "timestamp": 1609822261, "time_this_iter_s": 54.58512496948242, "time_total_s": 6339.1147401332855, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fb70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 6339.1147401332855, "timesteps_since_restore": 0, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 8.410256410256412, "ram_util_percent": 32.843589743589746}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1550.7219271658805, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1250.0018133478984, 1.2044636429592133, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.88918266069427, "mean_processing_ms": 1.319727925654047, "mean_inference_ms": 0.6734973898238734}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 360000, "timers": {"learn_time_ms": 3.742, "learn_throughput": 17103.247, "update_time_ms": 0.732}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -64.5302734375, "critic_loss": 0.002440116601064801, "mean_q": 64.38587951660156, "max_q": 90.96824645996094, "min_q": 7.095326900482178, "mean_td_error": 0.0018908008933067322, "td_error": "[-0.03167725 -0.06539917 -0.03726196  0.17241669  0.08097076 -0.04903412\n  0.01983643  0.03603363  0.00646591  0.00746918 -0.01139069  0.06295776\n  0.05887604  0.06905365 -0.06967163 -0.05638885  0.08464813 -0.01769638\n  0.17584229 -0.01776886 -0.01737213  0.07773972 -0.0344162   0.11489868\n  0.05033875 -0.07170486 -0.0631485  -0.07575989 -0.05640411 -0.02342987\n  0.03765106  0.12763786 -0.01351166 -0.07852173 -0.02531433 -0.07411957\n -0.0087204  -0.01460266  0.01783419 -0.08677673 -0.02375793  0.02798462\n -0.0413208  -0.05400848 -0.00907135 -0.04103851 -0.13130856 -0.04135132\n  0.09160614 -0.01736069  0.06972504 -0.03490448  0.07519531  0.0016613\n -0.00321579 -0.08560181  0.03631973 -0.03496552  0.02671814 -0.0184288\n  0.02870941  0.15275764 -0.00231361 -0.0515976 ]"}}, "num_steps_sampled": 360000, "num_steps_trained": 22848064, "last_target_update_ts": 360000, "num_target_updates": 357001}, "done": false, "episodes_total": 120, "training_iteration": 120, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-51-55", "timestamp": 1609822315, "time_this_iter_s": 54.4717857837677, "time_total_s": 6393.586525917053, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d2f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 6393.586525917053, "timesteps_since_restore": 0, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 8.37012987012987, "ram_util_percent": 32.900000000000006}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2556.9146445861616, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1570.0414853654102, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1933.1602835959102, 1864.0011266909753, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.8901676241717125, "mean_processing_ms": 1.3198268339440835, "mean_inference_ms": 0.6737232896778879}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 363000, "timers": {"learn_time_ms": 3.906, "learn_throughput": 16383.4, "update_time_ms": 0.688}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -66.31426239013672, "critic_loss": 0.001738601946271956, "mean_q": 66.15547180175781, "max_q": 92.58155059814453, "min_q": 5.484920024871826, "mean_td_error": 0.0024247393012046814, "td_error": "[-0.01668549  0.04190588  0.05586052 -0.06044769  0.02561188 -0.0438385\n -0.04504395  0.02126312 -0.00408173 -0.04102325 -0.02529907 -0.02451324\n -0.019104    0.06108856  0.04811096 -0.00760651 -0.0177803  -0.00886917\n -0.05504608 -0.03295898  0.05060577 -0.04329681  0.11668777  0.01384735\n  0.013237    0.06743622  0.03134155  0.0490036   0.00043488  0.03043747\n -0.11948776  0.09275436  0.07117844 -0.07441139 -0.02674866 -0.02254486\n  0.08834076 -0.02170944  0.02470016 -0.0157547  -0.06977081  0.00730133\n  0.04342651  0.03839493 -0.1155014   0.06035995 -0.00311279  0.03731537\n -0.02552032  0.05088043  0.03464127  0.05410767 -0.08721161  0.01828003\n  0.00196838 -0.17002106 -0.01410294  0.07759094  0.00965881 -0.01992035\n -0.02526855  0.0621376   0.01861572 -0.00666046]"}}, "num_steps_sampled": 363000, "num_steps_trained": 23040064, "last_target_update_ts": 363000, "num_target_updates": 360001}, "done": false, "episodes_total": 121, "training_iteration": 121, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-52-50", "timestamp": 1609822370, "time_this_iter_s": 54.91142392158508, "time_total_s": 6448.497949838638, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54dae8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 6448.497949838638, "timesteps_since_restore": 0, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 8.606329113924051, "ram_util_percent": 32.900000000000006}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1577.903281127603, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2650.1807029102674, 1588.2776786181473, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.891086735591639, "mean_processing_ms": 1.3199204147706374, "mean_inference_ms": 0.6739388186987483}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 366000, "timers": {"learn_time_ms": 4.094, "learn_throughput": 15632.16, "update_time_ms": 0.722}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -65.29057312011719, "critic_loss": 0.0035291181411594152, "mean_q": 65.11044311523438, "max_q": 90.92427825927734, "min_q": 6.464032173156738, "mean_td_error": 0.03589069843292236, "td_error": "[ 0.08325195  0.04545593 -0.01701355  0.05587769 -0.04503632  0.19568634\n -0.04066658  0.16913605  0.05466461  0.01834488  0.05018616  0.02384186\n  0.11117649  0.08976746 -0.03549957  0.04917145  0.23122406  0.04852295\n  0.02051544  0.07546997  0.01911926 -0.01341248  0.09849548  0.0242691\n  0.05893707  0.1400528  -0.010849    0.03113365  0.04582977 -0.01740646\n  0.08006668  0.05245209  0.06325531 -0.01646805 -0.05664825 -0.00033569\n -0.041008    0.05004883 -0.05760193  0.10109711  0.02781296  0.02341843\n -0.04261589  0.01115036  0.03541946  0.06291962  0.14968872  0.0040741\n  0.03894043  0.00146484  0.09512043 -0.06122589 -0.02554131 -0.198143\n  0.00184631 -0.01716423 -0.04228973  0.06422424  0.19097137  0.0322876\n -0.04884338  0.09911346  0.14863586  0.01063538]"}}, "num_steps_sampled": 366000, "num_steps_trained": 23232064, "last_target_update_ts": 366000, "num_target_updates": 363001}, "done": false, "episodes_total": 122, "training_iteration": 122, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-53-46", "timestamp": 1609822426, "time_this_iter_s": 55.821906089782715, "time_total_s": 6504.319855928421, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d598>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 6504.319855928421, "timesteps_since_restore": 0, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 8.340506329113923, "ram_util_percent": 32.900000000000006}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1585.4480138476515, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2342.750950623029, 2024.6808970271243, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.892006203733635, "mean_processing_ms": 1.3200160766715276, "mean_inference_ms": 0.6741554082595763}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 369000, "timers": {"learn_time_ms": 3.956, "learn_throughput": 16177.243, "update_time_ms": 0.7}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -65.63487243652344, "critic_loss": 0.0034591774456202984, "mean_q": 65.45743560791016, "max_q": 92.19927978515625, "min_q": -0.5578490495681763, "mean_td_error": -0.0023031244054436684, "td_error": "[ 0.10027313  0.0949688   0.01764679 -0.00767356  0.07386017  0.07247734\n  0.11645508  0.03335571  0.04980469  0.09488678 -0.01696777 -0.02988434\n -0.02810669 -0.13418579 -0.01748347 -0.10858917 -0.03960419  0.07331085\n -0.00536346 -0.15747833 -0.09069824  0.11446381  0.02516937  0.04998016\n -0.02454376 -0.01131058 -0.11063385 -0.05197906 -0.04829025  0.16051483\n -0.00714111 -0.0069046   0.02305984 -0.00641632  0.00418854 -0.30081177\n -0.00856781  0.07170868 -0.05095005 -0.02205658 -0.01889038 -0.17967224\n -0.03585052  0.0793457  -0.03659058  0.00693512  0.18559265 -0.01436615\n  0.05169678 -0.0592041  -0.04924774  0.01483154  0.03964996  0.06884766\n  0.01098633 -0.02548981 -0.02618408  0.02394485 -0.07557678  0.02697754\n -0.03864288 -0.05895233  0.09187317 -0.01989746]"}}, "num_steps_sampled": 369000, "num_steps_trained": 23424064, "last_target_update_ts": 369000, "num_target_updates": 366001}, "done": false, "episodes_total": 123, "training_iteration": 123, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-54-41", "timestamp": 1609822481, "time_this_iter_s": 54.884095668792725, "time_total_s": 6559.203951597214, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d7b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 6559.203951597214, "timesteps_since_restore": 0, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 8.22151898734177, "ram_util_percent": 32.900000000000006}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1585.9362292982921, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2073.5024420911536, 69.15543966356044, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.892855295807813, "mean_processing_ms": 1.32011196533508, "mean_inference_ms": 0.6743614222728403}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 372000, "timers": {"learn_time_ms": 4.142, "learn_throughput": 15449.612, "update_time_ms": 0.72}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -65.06754302978516, "critic_loss": 0.003237413242459297, "mean_q": 64.91429901123047, "max_q": 93.3752212524414, "min_q": 5.514988422393799, "mean_td_error": -0.00229693204164505, "td_error": "[-0.04774094  0.02833557  0.04390717  0.08117676 -0.0721817   0.00199127\n -0.07484436  0.00530243 -0.10385132 -0.09177399  0.00740814  0.02833176\n  0.04181671 -0.07409286  0.14804459 -0.04161835 -0.00974274  0.07215118\n -0.01815033  0.0288353  -0.00817108 -0.00870514 -0.01994705 -0.09095383\n -0.36664963  0.03235245 -0.05406952  0.12084198  0.03263855 -0.16108704\n -0.00370026 -0.03317261  0.05805016 -0.0565567   0.02294159  0.0906601\n -0.10506439 -0.01498985 -0.04234314 -0.00097656 -0.04546356 -0.08229065\n -0.03126526  0.02568054  0.04589653  0.01161194 -0.00977325 -0.01091003\n  0.04404449  0.11709595 -0.00629616  0.12355804  0.06215286  0.1169548\n -0.00554276  0.00687408 -0.02023315 -0.00437927  0.03690338 -0.02150726\n  0.08938551  0.05346298 -0.00424957  0.01688385]"}}, "num_steps_sampled": 372000, "num_steps_trained": 23616064, "last_target_update_ts": 372000, "num_target_updates": 369001}, "done": false, "episodes_total": 124, "training_iteration": 124, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-55-36", "timestamp": 1609822536, "time_this_iter_s": 55.39090180397034, "time_total_s": 6614.594853401184, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fd90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 6614.594853401184, "timesteps_since_restore": 0, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 8.851898734177215, "ram_util_percent": 32.900000000000006}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1598.1164549117705, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1287.1780010113807, 133.88734700637613, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.893807680406967, "mean_processing_ms": 1.320204260560668, "mean_inference_ms": 0.6745588981579692}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 375000, "timers": {"learn_time_ms": 4.069, "learn_throughput": 15728.701, "update_time_ms": 0.685}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -67.52352142333984, "critic_loss": 0.007590287830680609, "mean_q": 67.36685943603516, "max_q": 93.35061645507812, "min_q": 4.1909613609313965, "mean_td_error": 0.0801699310541153, "td_error": "[ 0.16545105  0.0462265   0.07238388  0.11237335  0.00886536  0.41926575\n  0.13987732  0.07993317 -0.04772949 -0.01951981  0.12812805  0.01867294\n  0.09289932  0.05020332  0.04515076  0.00247574  0.16225433  0.21294594\n  0.10098267  0.20740509  0.05419159  0.15766144 -0.05062866  0.06284332\n  0.08763123 -0.041008    0.02451324  0.10660553 -0.07649231 -0.08144379\n  0.08971405  0.11928558  0.05064392  0.01979065 -0.02005005  0.07012939\n  0.14994812  0.00964355  0.08240509  0.01462555  0.1302414   0.0116291\n  0.06806946 -0.00136566  0.16188812  0.3719635   0.12240601  0.10065079\n  0.06879425  0.10064316  0.12947083  0.00355911  0.12250519  0.19476318\n  0.0960083   0.19774628  0.05682373  0.11816406  0.05472565  0.05355072\n  0.087677   -0.09259033  0.09564972  0.04964733]"}}, "num_steps_sampled": 375000, "num_steps_trained": 23808064, "last_target_update_ts": 375000, "num_target_updates": 372001}, "done": false, "episodes_total": 125, "training_iteration": 125, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-56-31", "timestamp": 1609822591, "time_this_iter_s": 54.26254200935364, "time_total_s": 6668.857395410538, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 6668.857395410538, "timesteps_since_restore": 0, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 8.94935064935065, "ram_util_percent": 32.900000000000006}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1618.868336783845, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2209.0755342138714, 1226.7076148023064, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.894862099549516, "mean_processing_ms": 1.3202952488763668, "mean_inference_ms": 0.67475591100234}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 378000, "timers": {"learn_time_ms": 4.233, "learn_throughput": 15119.036, "update_time_ms": 0.657}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -69.80747985839844, "critic_loss": 0.00287861586548388, "mean_q": 69.66462707519531, "max_q": 92.76994323730469, "min_q": 8.611292839050293, "mean_td_error": 0.013991490006446838, "td_error": "[ 0.04120636 -0.00475311 -0.06713104  0.01163483 -0.01138306 -0.00449753\n -0.10192108  0.019104    0.08918762 -0.007164   -0.06890869 -0.03634644\n -0.13011932 -0.02309799 -0.12007141  0.03530121  0.0476532   0.08897018\n -0.00465775  0.14840698  0.02651024  0.06921387  0.0562439  -0.04056168\n  0.13189697 -0.0452652   0.08353424  0.03929901 -0.05238342  0.00655365\n  0.0525589  -0.11326599 -0.1052475  -0.00586319  0.0455246   0.00193024\n  0.00824738  0.13573456 -0.08895874  0.02449799  0.07754803 -0.09152222\n  0.04784393 -0.04718781  0.07871628 -0.01117325  0.04364014  0.03517151\n  0.0812149  -0.05397797  0.03852844 -0.07275391  0.00325775  0.15559387\n  0.10575867 -0.07199097  0.10746002 -0.00821686 -0.01157379  0.03549194\n  0.15068054  0.06951904  0.08665466  0.01515961]"}}, "num_steps_sampled": 378000, "num_steps_trained": 24000064, "last_target_update_ts": 378000, "num_target_updates": 375001}, "done": false, "episodes_total": 126, "training_iteration": 126, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-57-26", "timestamp": 1609822646, "time_this_iter_s": 55.90079045295715, "time_total_s": 6724.758185863495, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fb70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 6724.758185863495, "timesteps_since_restore": 0, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 9.9475, "ram_util_percent": 33.64125000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1626.5432259647405, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1994.1965328918413, 2291.5854842340254, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.895957227378392, "mean_processing_ms": 1.320388580239954, "mean_inference_ms": 0.6749589474577137}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 381000, "timers": {"learn_time_ms": 4.373, "learn_throughput": 14634.856, "update_time_ms": 0.668}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -68.74404907226562, "critic_loss": 0.0017262989422306418, "mean_q": 68.59044647216797, "max_q": 93.93626403808594, "min_q": 7.148141384124756, "mean_td_error": -0.006504841148853302, "td_error": "[-0.00699615  0.08337784 -0.08590317 -0.03120422  0.03424454  0.03823853\n  0.03075027 -0.06620026  0.00500107 -0.03392029  0.00955963 -0.03504181\n -0.03826904  0.00598145 -0.04647064  0.06523132 -0.07520294 -0.04837036\n -0.07637024 -0.03010559 -0.0612793   0.01865387  0.05262756  0.05278778\n  0.0117569   0.11875153 -0.11493683 -0.04156494 -0.04137421 -0.03204346\n -0.03469467  0.00441742 -0.00850677 -0.08306885  0.02005959 -0.03551865\n  0.07702637 -0.00249481 -0.08342743 -0.01246643 -0.05570984  0.00682831\n -0.00255108 -0.08898163  0.04872894  0.01435852  0.0770874   0.04284668\n -0.03257751 -0.03912735 -0.07953644 -0.00284576  0.06377459  0.00808716\n -0.08369446  0.08602142 -0.03567505  0.0450592  -0.04828644 -0.02217865\n  0.00086212  0.066082    0.07704163  0.03504181]"}}, "num_steps_sampled": 381000, "num_steps_trained": 24192064, "last_target_update_ts": 381000, "num_target_updates": 378001}, "done": false, "episodes_total": 127, "training_iteration": 127, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-58-21", "timestamp": 1609822701, "time_this_iter_s": 54.96975255012512, "time_total_s": 6779.72793841362, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a21e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 6779.72793841362, "timesteps_since_restore": 0, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 9.216666666666665, "ram_util_percent": 33.80000000000002}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1629.3684025950215, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2574.1031472621157, 132.51372905828967, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.896992712203225, "mean_processing_ms": 1.320474660415572, "mean_inference_ms": 0.675160573924177}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 384000, "timers": {"learn_time_ms": 3.766, "learn_throughput": 16996.255, "update_time_ms": 0.68}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -68.3501968383789, "critic_loss": 0.0027118998114019632, "mean_q": 68.19719696044922, "max_q": 92.72086334228516, "min_q": 9.39147663116455, "mean_td_error": 0.02117002010345459, "td_error": "[ 0.04541016 -0.01501465 -0.05289459 -0.03482819 -0.06921387  0.01976013\n  0.06425476  0.02015305  0.02006531  0.03966904  0.17144012  0.0202713\n  0.03831482  0.02227783 -0.02548218  0.05540466 -0.05308533 -0.01543427\n -0.05962372  0.05554199 -0.0008812   0.05782509  0.19789886  0.05738831\n -0.17913818  0.10100555  0.00556946 -0.03554535  0.0436554  -0.06730652\n  0.05006409  0.08686066  0.08860016 -0.00441742 -0.08211136 -0.11261749\n  0.00917816  0.1048851   0.05104065 -0.05384445 -0.00775146  0.00968933\n -0.00719452  0.056427    0.03690338  0.08326721  0.01741791  0.06479645\n  0.00077057  0.12683868  0.02090454 -0.03768921  0.09108734  0.05654907\n -0.02785492  0.03448486 -0.00708008 -0.06386566 -0.00237656  0.15341187\n -0.02640533  0.08700562  0.08239365  0.04805565]"}}, "num_steps_sampled": 384000, "num_steps_trained": 24384064, "last_target_update_ts": 384000, "num_target_updates": 381001}, "done": false, "episodes_total": 128, "training_iteration": 128, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_13-59-17", "timestamp": 1609822757, "time_this_iter_s": 55.65734076499939, "time_total_s": 6835.385279178619, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2620>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 6835.385279178619, "timesteps_since_restore": 0, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 9.145, "ram_util_percent": 33.800000000000004}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1638.3035629569554, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1026.029765251664, 1041.794612357399, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.8981044398088, "mean_processing_ms": 1.3205630890076427, "mean_inference_ms": 0.6753612524685982}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 387000, "timers": {"learn_time_ms": 3.747, "learn_throughput": 17078.111, "update_time_ms": 0.637}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -65.303466796875, "critic_loss": 0.0036617701407521963, "mean_q": 65.13367462158203, "max_q": 90.90790557861328, "min_q": 15.26339054107666, "mean_td_error": -6.903707981109619e-05, "td_error": "[-0.04800797 -0.00871277  0.02854919 -0.08716583 -0.00647736  0.03148746\n  0.0154953   0.03694153 -0.15756226 -0.08205414  0.03151321 -0.00278854\n  0.06520081 -0.04917145 -0.02435684  0.10074615  0.02765656 -0.04079437\n -0.07356262 -0.04781342 -0.00338745  0.11529541  0.03501892 -0.03527832\n -0.08208466  0.11215973 -0.02733612  0.27416992 -0.00323105  0.04802704\n -0.01641083 -0.00222015 -0.05212402  0.00262451  0.04206848  0.00109863\n  0.07245255 -0.11805725 -0.05986023 -0.01759338  0.11112213  0.01384354\n  0.00475311  0.06771851 -0.22090149 -0.16162872 -0.07704163 -0.00485992\n -0.01244354 -0.00634003 -0.11499023  0.06935883  0.0099411   0.22729874\n -0.01933289  0.05384827 -0.09372711 -0.02506828 -0.03218842 -0.06867981\n  0.03022003  0.03622437  0.12699127  0.08700943]"}}, "num_steps_sampled": 387000, "num_steps_trained": 24576064, "last_target_update_ts": 387000, "num_target_updates": 384001}, "done": false, "episodes_total": 129, "training_iteration": 129, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-00-11", "timestamp": 1609822811, "time_this_iter_s": 54.03049921989441, "time_total_s": 6889.415778398514, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f8c8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 6889.415778398514, "timesteps_since_restore": 0, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 8.645454545454546, "ram_util_percent": 33.80000000000002}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1642.3965768388102, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1451.0960005428904, 2233.3182175822394, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.899239671301084, "mean_processing_ms": 1.320655278148018, "mean_inference_ms": 0.6755612509366342}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 390000, "timers": {"learn_time_ms": 3.91, "learn_throughput": 16369.513, "update_time_ms": 0.701}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -66.07706451416016, "critic_loss": 0.0018746773712337017, "mean_q": 65.93453979492188, "max_q": 90.8980484008789, "min_q": 8.030891418457031, "mean_td_error": 0.017712749540805817, "td_error": "[ 5.32035828e-02  3.02810669e-02  1.33613586e-01  1.52282715e-02\n -6.58721924e-02  1.62658691e-02  3.85818481e-02 -1.42555237e-02\n  2.37731934e-02 -1.72920227e-02  8.34884644e-02  8.14323425e-02\n  4.43115234e-02 -2.68363953e-02  2.26440430e-02  5.41610718e-02\n  8.31298828e-02  1.59072876e-02  2.31704712e-02 -6.76574707e-02\n -3.82232666e-03  9.59396362e-02 -1.51367188e-02  7.31124878e-02\n -2.60848999e-02  5.58395386e-02 -1.42669678e-03 -8.39233398e-05\n -3.46374512e-02  1.44805908e-02 -9.25140381e-02  7.16323853e-02\n  2.89916992e-03 -3.53202820e-02  1.68876648e-02  8.23211670e-03\n -3.15475464e-02 -8.43963623e-02  5.20248413e-02 -3.34892273e-02\n  5.22637367e-02 -1.32064819e-02  7.36846924e-02  4.00695801e-02\n  5.49621582e-02  2.48718262e-02 -3.55224609e-02  7.68966675e-02\n -2.31513977e-02  9.76715088e-02  2.60162354e-03 -6.58874512e-02\n  5.23300171e-02  3.04756165e-02 -6.94274902e-03 -1.07452393e-01\n  7.03277588e-02  8.92562866e-02  1.21704102e-01  4.26712036e-02\n -7.21664429e-02  6.45828247e-02 -1.62811279e-02  1.99890137e-02]"}}, "num_steps_sampled": 390000, "num_steps_trained": 24768064, "last_target_update_ts": 390000, "num_target_updates": 387001}, "done": false, "episodes_total": 130, "training_iteration": 130, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-01-05", "timestamp": 1609822865, "time_this_iter_s": 53.994539976119995, "time_total_s": 6943.410318374634, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 6943.410318374634, "timesteps_since_restore": 0, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 8.816883116883117, "ram_util_percent": 33.85714285714286}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1633.5306398980479, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1346.724523506024, 1744.7413236598563, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.9003065142834465, "mean_processing_ms": 1.3207470839259507, "mean_inference_ms": 0.6757626413073586}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 393000, "timers": {"learn_time_ms": 4.295, "learn_throughput": 14900.995, "update_time_ms": 0.694}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -65.94100189208984, "critic_loss": 0.014220117591321468, "mean_q": 65.72834014892578, "max_q": 92.81490325927734, "min_q": 6.363047122955322, "mean_td_error": -0.14846500754356384, "td_error": "[-0.1199913  -0.26439285 -0.25554657 -0.13335419 -0.03058624 -0.17255402\n -0.12181854 -0.2149353  -0.02259064 -0.21782684 -0.11102295 -0.23740578\n -0.03768158 -0.24403381 -0.17849731 -0.0687294  -0.13717651 -0.10074425\n  0.00441742 -0.19725037 -0.14745331 -0.2666092  -0.2793007  -0.1663208\n -0.07064056 -0.1216507  -0.04826355 -0.10439301 -0.18447113 -0.03113556\n -0.14951324 -0.16829681 -0.03213501 -0.23031998 -0.18136215 -0.22489929\n -0.1771698  -0.15361786 -0.2693863  -0.13467789 -0.00238037 -0.21453094\n  0.05495453 -0.11310577 -0.1240387  -0.21479797 -0.21702957 -0.15660858\n -0.15065145 -0.15568924 -0.07290649 -0.16059113 -0.20166016 -0.1579361\n -0.18802643 -0.17610168 -0.15520859 -0.27553988 -0.16614532 -0.03623962\n -0.12330627 -0.23171234 -0.11645508 -0.14271545]"}}, "num_steps_sampled": 393000, "num_steps_trained": 24960064, "last_target_update_ts": 393000, "num_target_updates": 390001}, "done": false, "episodes_total": 131, "training_iteration": 131, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-02-00", "timestamp": 1609822920, "time_this_iter_s": 55.000598430633545, "time_total_s": 6998.410916805267, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d6a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 6998.410916805267, "timesteps_since_restore": 0, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 9.464102564102562, "ram_util_percent": 33.900000000000006}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1634.5575026873275, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1847.427602587799, 1638.6940344766317, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.901338211338234, "mean_processing_ms": 1.3208425132516624, "mean_inference_ms": 0.6759619132021032}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 396000, "timers": {"learn_time_ms": 3.819, "learn_throughput": 16757.003, "update_time_ms": 0.639}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -68.56767272949219, "critic_loss": 0.0022828022483736277, "mean_q": 68.39071655273438, "max_q": 94.64561462402344, "min_q": 21.132001876831055, "mean_td_error": -0.01867428421974182, "td_error": "[ 0.01712036 -0.07104874 -0.11721802  0.03641891 -0.06208038  0.06612778\n -0.04443359 -0.03918457 -0.07883453  0.09443665 -0.06375122 -0.05429077\n  0.00884247  0.07157898  0.10015869 -0.04650116  0.07934952 -0.02524185\n -0.03063202 -0.01350021 -0.0588131   0.0647583  -0.01647949 -0.05606842\n -0.09391022 -0.0056839  -0.02120209  0.07480621  0.07493591 -0.00551605\n -0.05775452  0.05851746 -0.11988068  0.03607178  0.03170013 -0.08093262\n  0.01191711 -0.05418396  0.02581024 -0.0003891  -0.03713226  0.01734924\n  0.03560638  0.00904083  0.11142731 -0.03785706 -0.12475586 -0.03642273\n -0.16358185 -0.01589203 -0.05173492 -0.01780319 -0.02362823  0.03337097\n -0.04899597 -0.07564926 -0.10051727  0.02156448 -0.0694046  -0.08659363\n -0.01055145 -0.04367065 -0.04355621 -0.07078552]"}}, "num_steps_sampled": 396000, "num_steps_trained": 25152064, "last_target_update_ts": 396000, "num_target_updates": 393001}, "done": false, "episodes_total": 132, "training_iteration": 132, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-02-56", "timestamp": 1609822976, "time_this_iter_s": 55.48837661743164, "time_total_s": 7053.899293422699, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54da60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 7053.899293422699, "timesteps_since_restore": 0, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 8.98481012658228, "ram_util_percent": 33.900000000000006}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1644.0999280895737, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2592.936574701262, 718.7155772729346, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.902359860702377, "mean_processing_ms": 1.3209455504663792, "mean_inference_ms": 0.6761591410253456}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 399000, "timers": {"learn_time_ms": 3.877, "learn_throughput": 16507.22, "update_time_ms": 0.681}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -70.33946228027344, "critic_loss": 0.003905047895386815, "mean_q": 70.17566680908203, "max_q": 91.62828063964844, "min_q": 10.626058578491211, "mean_td_error": 0.016688182950019836, "td_error": "[ 0.01602936  0.0728302   0.0521431   0.07170486  0.01390076  0.05619431\n -0.00196838  0.00529861 -0.01730347 -0.03679657 -0.19887543  0.14548492\n  0.10884285  0.07142639 -0.02015686 -0.01917648  0.07073593  0.10453033\n  0.04290009 -0.0994339   0.11643219 -0.0007782   0.11360836 -0.04353333\n  0.04414368  0.0254364  -0.08135223  0.02296448 -0.02845764  0.1652298\n  0.12732697 -0.07840729  0.06714058  0.03105164  0.12482452  0.04528999\n  0.04019165 -0.03500366  0.02915192 -0.13889313  0.03572845  0.01946259\n  0.10214996  0.12499619 -0.14892578 -0.04795837  0.07852173 -0.05583954\n  0.05138397  0.02675629  0.0411644   0.08193207  0.05235291 -0.00186157\n -0.00930786 -0.11917114  0.04705048  0.10921478 -0.27752686 -0.04000092\n -0.08898926  0.0845871   0.02629852 -0.00865173]"}}, "num_steps_sampled": 399000, "num_steps_trained": 25344064, "last_target_update_ts": 399000, "num_target_updates": 396001}, "done": false, "episodes_total": 133, "training_iteration": 133, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-03-51", "timestamp": 1609823031, "time_this_iter_s": 55.1856734752655, "time_total_s": 7109.0849668979645, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d488>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 7109.0849668979645, "timesteps_since_restore": 0, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 8.625316455696202, "ram_util_percent": 33.900000000000006}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1649.6827756834798, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1277.0003366635679, 1980.9843686053077, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.903410545331742, "mean_processing_ms": 1.3210527457330554, "mean_inference_ms": 0.6763560110076895}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 402000, "timers": {"learn_time_ms": 4.332, "learn_throughput": 14773.146, "update_time_ms": 0.795}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -66.86775207519531, "critic_loss": 0.0029138480313122272, "mean_q": 66.65772247314453, "max_q": 93.19474792480469, "min_q": 4.66731595993042, "mean_td_error": 0.01325584203004837, "td_error": "[-0.01968384 -0.02189779  0.09666443  0.05819702  0.03278351  0.10215759\n  0.06375885 -0.03524399 -0.00913239 -0.00530624 -0.01222229  0.04714966\n -0.03439331  0.17027283  0.01624298  0.1178894  -0.00320435  0.07059479\n -0.21105957 -0.02532196  0.04705811 -0.03852081 -0.11614227  0.0221405\n  0.05167007 -0.00852203  0.10613251  0.11764526 -0.01647186 -0.00999451\n -0.04655075  0.07950592 -0.04335022 -0.11765862 -0.02500534  0.0792923\n -0.08521271 -0.01705933 -0.0375309  -0.00370026  0.05161285  0.00325012\n  0.05617523  0.14097595  0.04858017 -0.03369141  0.22704315 -0.01464081\n -0.00702667 -0.01824188 -0.02856827  0.01544571 -0.05981827 -0.04827499\n -0.02863312  0.13005066  0.03365326 -0.00874329 -0.02567673  0.06306076\n -0.04849625  0.05661583 -0.00626373  0.0140152 ]"}}, "num_steps_sampled": 402000, "num_steps_trained": 25536064, "last_target_update_ts": 402000, "num_target_updates": 399001}, "done": false, "episodes_total": 134, "training_iteration": 134, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-04-46", "timestamp": 1609823086, "time_this_iter_s": 54.88087177276611, "time_total_s": 7163.965838670731, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2d08>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 7163.965838670731, "timesteps_since_restore": 0, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 11.293589743589742, "ram_util_percent": 34.24743589743591}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1652.8784928462605, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2300.556084883419, 160.4618270929573, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.904412926223779, "mean_processing_ms": 1.3211532889237234, "mean_inference_ms": 0.6765492767255122}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 405000, "timers": {"learn_time_ms": 4.162, "learn_throughput": 15378.186, "update_time_ms": 0.675}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -66.94693756103516, "critic_loss": 0.01839982531964779, "mean_q": 66.8006362915039, "max_q": 91.45234680175781, "min_q": 29.131427764892578, "mean_td_error": -0.17658349871635437, "td_error": "[-0.25637054 -0.14749908 -0.218647   -0.18027115 -0.1295929  -0.10890198\n -0.0563736  -0.18060303 -0.09732819 -0.17943954 -0.2374649  -0.11514664\n -0.23592377 -0.23483276 -0.2084961  -0.22744751 -0.23073578 -0.24132538\n -0.2691574  -0.16753387 -0.2400055  -0.19775772 -0.0270195  -0.3381729\n -0.1680069  -0.14224243 -0.2501068  -0.18089676 -0.21038055 -0.17013931\n -0.2921753  -0.09859467 -0.2889328  -0.16841888 -0.20467377 -0.11535645\n -0.16799164 -0.07804871 -0.18110466 -0.16257858  0.03555298 -0.20529938\n  0.00415802 -0.19010925 -0.10318756 -0.18025208 -0.16613007 -0.19918442\n -0.16648865 -0.1035881  -0.2554474  -0.14208984 -0.27246475 -0.20532227\n -0.1977005  -0.09805298 -0.20306015 -0.08256531 -0.22823334 -0.22885132\n -0.10155869 -0.17224884 -0.18677902 -0.24674606]"}}, "num_steps_sampled": 405000, "num_steps_trained": 25728064, "last_target_update_ts": 405000, "num_target_updates": 402001}, "done": false, "episodes_total": 135, "training_iteration": 135, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-05-41", "timestamp": 1609823141, "time_this_iter_s": 55.570515394210815, "time_total_s": 7219.536354064941, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2bf8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 7219.536354064941, "timesteps_since_restore": 0, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 11.1175, "ram_util_percent": 34.34}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1667.3609073205264, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1608.7032745194804, 1637.2635241003345, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.905457963731021, "mean_processing_ms": 1.321247978084176, "mean_inference_ms": 0.6767388917204029}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 408000, "timers": {"learn_time_ms": 4.255, "learn_throughput": 15041.097, "update_time_ms": 0.665}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -70.14028930664062, "critic_loss": 0.05236997455358505, "mean_q": 69.9798583984375, "max_q": 91.91830444335938, "min_q": 26.230085372924805, "mean_td_error": -0.3080799877643585, "td_error": "[-0.26526642 -0.45664978 -0.31040192 -0.2783928  -0.25896454 -0.49536133\n -0.13441467 -0.23352814 -0.28094864 -0.11497879 -0.25750732 -0.24960327\n -0.44415283 -0.38129807 -0.29821396 -0.31668854 -0.51207733 -0.29143524\n -0.36566925 -0.29053497 -0.22372437 -0.3937149  -0.33200073 -0.3230896\n -0.3564148  -0.2920227  -0.30763245 -0.3525772  -0.31954956 -0.31943512\n -0.34275818 -0.2519226  -0.41130066 -0.39741516 -0.22672272 -0.31822586\n -0.35198212 -0.23349953  0.02075958 -0.17913055 -0.35328674 -0.32677078\n -0.32804108 -0.22819138 -0.27095032 -0.25200653 -0.5016632  -0.26448822\n -0.494812   -0.37527466 -0.28168488 -0.34866714 -0.3733673  -0.24789047\n -0.21695328 -0.14172363 -0.4522171  -0.3876419  -0.22100449 -0.30288696\n -0.36756897 -0.19473267 -0.27807617 -0.35877228]"}}, "num_steps_sampled": 408000, "num_steps_trained": 25920064, "last_target_update_ts": 408000, "num_target_updates": 405001}, "done": false, "episodes_total": 136, "training_iteration": 136, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-06-36", "timestamp": 1609823196, "time_this_iter_s": 54.793516397476196, "time_total_s": 7274.329870462418, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a26a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 7274.329870462418, "timesteps_since_restore": 0, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 10.733333333333334, "ram_util_percent": 34.21666666666666}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1675.991298812263, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2500.30267327401, 1700.7943607039717, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.9065120309736745, "mean_processing_ms": 1.3213442971496614, "mean_inference_ms": 0.676928412831245}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 411000, "timers": {"learn_time_ms": 3.813, "learn_throughput": 16783.825, "update_time_ms": 0.72}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -64.68961334228516, "critic_loss": 0.013417927548289299, "mean_q": 64.554931640625, "max_q": 92.8923110961914, "min_q": 25.947694778442383, "mean_td_error": -0.12641987204551697, "td_error": "[-0.20109558 -0.08119202 -0.16193771 -0.23304367 -0.17720795  0.04021835\n -0.22276306 -0.21214676 -0.12539673 -0.18868256 -0.08588409 -0.07455444\n -0.20645142 -0.16812134 -0.2840538  -0.20331573 -0.09394455 -0.15345001\n  0.04832458 -0.23613167 -0.10651016 -0.05183411 -0.03931427  0.00933456\n -0.05096054 -0.27056122 -0.07279968 -0.33412933 -0.01831818  0.00398254\n -0.17623138  0.04501343 -0.11965179 -0.15407753 -0.25240326 -0.27457047\n -0.12377167 -0.05812836 -0.1040802  -0.28250504 -0.2279129  -0.11624908\n  0.00992584  0.05258942 -0.1281128  -0.12513351 -0.21418762 -0.05276108\n -0.13034058 -0.07061005 -0.26095963  0.13162994  0.02089691 -0.15610504\n -0.19717216 -0.16573715 -0.20412445 -0.19259644 -0.10746002 -0.23713684\n  0.02243805 -0.21043396 -0.00774384 -0.07122803]"}}, "num_steps_sampled": 411000, "num_steps_trained": 26112064, "last_target_update_ts": 411000, "num_target_updates": 408001}, "done": false, "episodes_total": 137, "training_iteration": 137, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-07-32", "timestamp": 1609823252, "time_this_iter_s": 55.86083507537842, "time_total_s": 7330.190705537796, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54dc80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 7330.190705537796, "timesteps_since_restore": 0, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 8.767500000000002, "ram_util_percent": 34.0}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1683.1665978897627, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2418.324268453947, 2213.5046402827356, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.9075529762525845, "mean_processing_ms": 1.3214313229323174, "mean_inference_ms": 0.6771208430444879}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 414000, "timers": {"learn_time_ms": 4.254, "learn_throughput": 15043.626, "update_time_ms": 0.75}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -63.075706481933594, "critic_loss": 0.011612026952207088, "mean_q": 62.95013427734375, "max_q": 93.44357299804688, "min_q": 12.553132057189941, "mean_td_error": -0.09140412509441376, "td_error": "[-2.67601013e-02 -3.93486023e-02 -1.26583099e-01 -1.43539429e-01\n -2.36358643e-02 -4.04510498e-02 -2.59475708e-02 -1.32347107e-01\n  1.64852142e-02 -1.14738464e-01  2.16369629e-02 -6.40735626e-02\n -1.22863770e-01  5.27992249e-02 -7.15637207e-02 -5.78346252e-02\n -1.20426178e-01 -2.14191437e-01 -6.09283447e-02 -4.68673706e-02\n -2.17926025e-01  6.48345947e-02 -5.12924194e-02 -2.03926086e-01\n -7.21473694e-02 -7.66372681e-03 -9.20867920e-02 -1.84743881e-01\n -2.22473145e-02 -1.03797913e-01 -1.76239014e-03 -9.67292786e-02\n -4.36515808e-02 -5.32531738e-03 -4.23889160e-02 -1.65058136e-01\n -1.07887268e-01 -1.61102295e-01 -8.06350708e-02 -8.09555054e-02\n -1.47911072e-01 -1.25537872e-01 -1.20857239e-01 -1.32995605e-01\n -9.45119858e-02 -2.01168060e-01 -4.54216003e-02 -1.40892029e-01\n  2.89916992e-04  8.43048096e-03 -1.39167786e-01 -9.83924866e-02\n  3.56979370e-02 -1.18804932e-01 -1.19819641e-01 -8.82293701e-01\n -6.96334839e-02 -7.42797852e-02 -3.18603516e-02 -1.32080078e-01\n -7.37762451e-03 -1.02996826e-03 -1.28419876e-01 -6.41555786e-02]"}}, "num_steps_sampled": 414000, "num_steps_trained": 26304064, "last_target_update_ts": 414000, "num_target_updates": 411001}, "done": false, "episodes_total": 138, "training_iteration": 138, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-08-28", "timestamp": 1609823308, "time_this_iter_s": 56.03031253814697, "time_total_s": 7386.221018075943, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d1e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 7386.221018075943, "timesteps_since_restore": 0, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 9.305000000000001, "ram_util_percent": 34.13249999999999}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1674.8443500368123, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1381.279854987665, 1620.9615981555712, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.908529143669028, "mean_processing_ms": 1.32152775123448, "mean_inference_ms": 0.6773113772303506}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 417000, "timers": {"learn_time_ms": 3.664, "learn_throughput": 17468.306, "update_time_ms": 0.691}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -67.09517669677734, "critic_loss": 0.005346154794096947, "mean_q": 66.93537902832031, "max_q": 92.91753387451172, "min_q": 5.623381614685059, "mean_td_error": -0.0444951131939888, "td_error": "[-0.07256317 -0.08219147 -0.11151886 -0.12940216 -0.17427063 -0.01412201\n -0.2539673   0.03544617  0.07407951 -0.05397415 -0.03439331 -0.10858154\n  0.00393677 -0.05111694 -0.08637238  0.20453262  0.06867981  0.03286743\n -0.08069611 -0.1164093   0.01947784 -0.03782272 -0.11025238 -0.0109024\n -0.01100159 -0.09111023  0.00145721 -0.05249786 -0.05690765 -0.1065979\n -0.04753876  0.06517792 -0.24568939 -0.08016205 -0.02550888 -0.03650284\n -0.02243805  0.06158829  0.03319931 -0.23599243 -0.08162689 -0.04815674\n  0.00434113 -0.12108231 -0.09197235  0.08189392 -0.06001282 -0.08912659\n -0.04837799  0.01827621 -0.22769165 -0.0713501  -0.02526093  0.01016235\n -0.0519104   0.04569769 -0.1511612   0.21918869 -0.02920532 -0.15370178\n  0.02738953 -0.10755157 -0.02792358  0.07153702]"}}, "num_steps_sampled": 417000, "num_steps_trained": 26496064, "last_target_update_ts": 417000, "num_target_updates": 414001}, "done": false, "episodes_total": 139, "training_iteration": 139, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-09-23", "timestamp": 1609823363, "time_this_iter_s": 54.80127024650574, "time_total_s": 7441.022288322449, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 7441.022288322449, "timesteps_since_restore": 0, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 8.873076923076923, "ram_util_percent": 34.237179487179475}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1677.618241230393, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1898.3507175136865, 2345.617331663643, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.909492276841177, "mean_processing_ms": 1.321617483311557, "mean_inference_ms": 0.6775039680873018}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 420000, "timers": {"learn_time_ms": 4.516, "learn_throughput": 14172.115, "update_time_ms": 0.694}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -62.07916259765625, "critic_loss": 0.0062188273295760155, "mean_q": 61.93022155761719, "max_q": 91.88746643066406, "min_q": 12.27860164642334, "mean_td_error": 0.07925847172737122, "td_error": "[ 0.17050171 -0.03473854  0.16934967  0.06475067 -0.07510376  0.00197983\n  0.02922821  0.06191254  0.12034607  0.05989075  0.15731812  0.0672226\n  0.07420349  0.10739899  0.20735168  0.103302    0.01080322  0.10818481\n -0.02906418 -0.00107193  0.0933609   0.10856247  0.09029007  0.0570755\n -0.03320122  0.069561    0.08795929 -0.02280617  0.0387764   0.05369949\n  0.06334305  0.0719223   0.12940979  0.23891449 -0.02817917  0.15393066\n  0.14406586  0.2008667   0.05835342  0.05951309  0.12911224  0.12384033\n  0.14948273  0.10058594 -0.02238846  0.06242371  0.04319     0.0878334\n  0.08845901  0.04901505 -0.02406311  0.1889267   0.20671082  0.04177856\n -0.02169418 -0.10102463  0.01480865  0.16291809  0.13539124  0.15132141\n  0.1988678   0.15999603  0.08805847  0.0498085 ]"}}, "num_steps_sampled": 420000, "num_steps_trained": 26688064, "last_target_update_ts": 420000, "num_target_updates": 417001}, "done": false, "episodes_total": 140, "training_iteration": 140, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-10-19", "timestamp": 1609823419, "time_this_iter_s": 56.1761589050293, "time_total_s": 7497.198447227478, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f0d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 7497.198447227478, "timesteps_since_restore": 0, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 13.179999999999998, "ram_util_percent": 34.99875}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1667.1112680745757, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1294.9200160818639, 1264.057486799418, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.910391943248811, "mean_processing_ms": 1.321714113941766, "mean_inference_ms": 0.6776966453939286}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 423000, "timers": {"learn_time_ms": 3.855, "learn_throughput": 16600.216, "update_time_ms": 0.686}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -65.7037353515625, "critic_loss": 0.002488311380147934, "mean_q": 65.56192016601562, "max_q": 94.30384826660156, "min_q": 7.113478183746338, "mean_td_error": 0.03132279962301254, "td_error": "[-0.03606415 -0.05217743 -0.00087738 -0.09596634  0.05672073  0.0292511\n  0.04471588  0.00481796  0.0142417  -0.06567764  0.07484818 -0.00378799\n  0.04331207 -0.00543976  0.08804321  0.07359695  0.07915878  0.03133392\n  0.04929352  0.02008057  0.1911354   0.05177307  0.03916931 -0.01572418\n  0.04394913  0.00678253  0.02871323  0.04542923  0.02624512 -0.02473068\n  0.0245285   0.01564789 -0.00713348  0.06403732 -0.05588531  0.0568924\n  0.06867981 -0.02020264 -0.04964447 -0.03917694  0.03728485  0.00957108\n -0.07458878  0.10774994  0.04508209  0.11283493 -0.0627861   0.06705475\n  0.03376389  0.11183167 -0.026474    0.1055069   0.05157089  0.06600189\n  0.11419678 -0.01628876  0.09883881  0.21292877  0.04528046  0.02026367\n  0.06116486  0.00531769  0.00937653  0.06926727]"}}, "num_steps_sampled": 423000, "num_steps_trained": 26880064, "last_target_update_ts": 423000, "num_target_updates": 420001}, "done": false, "episodes_total": 141, "training_iteration": 141, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-11-15", "timestamp": 1609823475, "time_this_iter_s": 55.94827342033386, "time_total_s": 7553.146720647812, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f7b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 7553.146720647812, "timesteps_since_restore": 0, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 13.725, "ram_util_percent": 35.017500000000005}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1678.813216082443, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2434.2522875861764, 1956.3866839851619, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.911321723708336, "mean_processing_ms": 1.3218075293497775, "mean_inference_ms": 0.6778908432736902}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 426000, "timers": {"learn_time_ms": 4.091, "learn_throughput": 15645.006, "update_time_ms": 0.685}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -63.899620056152344, "critic_loss": 0.005201967898756266, "mean_q": 63.72987365722656, "max_q": 91.8108901977539, "min_q": 15.275790214538574, "mean_td_error": -0.0821419209241867, "td_error": "[-0.12104034 -0.04164124 -0.12968445 -0.12458801 -0.12734985 -0.07155609\n -0.02944183 -0.07012558 -0.10293961 -0.0178833  -0.05996704 -0.01361084\n -0.09416962 -0.02901649 -0.16248322 -0.12097168  0.02850723 -0.07483673\n -0.03440094 -0.22994995 -0.09345627 -0.05510712 -0.08927917 -0.09869385\n -0.03713226 -0.19161224 -0.04879761  0.00879669 -0.14353943 -0.12831974\n -0.16537476 -0.10449219 -0.0105629  -0.123703    0.02018738 -0.07494736\n -0.0826416  -0.0821228  -0.10640717 -0.07065582 -0.02996063 -0.08983612\n -0.15673447 -0.08937836 -0.14950943 -0.06543732 -0.08182526 -0.06030273\n -0.03607178 -0.08509064 -0.12052536 -0.12194061 -0.13074493 -0.08685493\n  0.09119415 -0.11147118 -0.12477875 -0.02716064 -0.13097382 -0.11353302\n -0.03860474 -0.02214813 -0.09691238 -0.07347107]"}}, "num_steps_sampled": 426000, "num_steps_trained": 27072064, "last_target_update_ts": 426000, "num_target_updates": 423001}, "done": false, "episodes_total": 142, "training_iteration": 142, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-12-12", "timestamp": 1609823532, "time_this_iter_s": 56.42407512664795, "time_total_s": 7609.57079577446, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2bf8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 7609.57079577446, "timesteps_since_restore": 0, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 13.138749999999998, "ram_util_percent": 35.10000000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1680.9240451236944, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2167.4695881102925, 778.5210568045561, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.9122392823519725, "mean_processing_ms": 1.3219014176195827, "mean_inference_ms": 0.678086441848524}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 429000, "timers": {"learn_time_ms": 3.857, "learn_throughput": 16594.469, "update_time_ms": 0.666}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -66.27583312988281, "critic_loss": 0.0034931933041661978, "mean_q": 66.12017822265625, "max_q": 94.1006088256836, "min_q": 2.852843999862671, "mean_td_error": 0.0009767748415470123, "td_error": "[-0.02146912  0.11922073 -0.06522369  0.08813477  0.17586517 -0.06198883\n  0.02838135  0.08887863  0.02733994 -0.1754837  -0.03079224  0.34700775\n -0.02659607  0.05079651  0.01633453 -0.02242279  0.0761795  -0.02142334\n  0.01535797  0.16100311 -0.0019455   0.05691528 -0.02043915  0.01651001\n -0.094841   -0.02923584  0.09602356 -0.01078033 -0.04098511  0.02232361\n -0.0513649  -0.03833771 -0.0280571  -0.04710388  0.07140541 -0.05303955\n -0.0181427  -0.05587387 -0.08188629 -0.04155731 -0.00840759 -0.09669495\n  0.03538895 -0.00945282 -0.08964539  0.01526642  0.05046844 -0.05599976\n  0.0341742  -0.03460503 -0.00601196 -0.08065796  0.07667542  0.09628296\n  0.0222702  -0.0467453  -0.05422211 -0.08757782 -0.02227783 -0.10011292\n -0.0644989  -0.07330704  0.08693695  0.05657959]"}}, "num_steps_sampled": 429000, "num_steps_trained": 27264064, "last_target_update_ts": 429000, "num_target_updates": 426001}, "done": false, "episodes_total": 143, "training_iteration": 143, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-13-07", "timestamp": 1609823587, "time_this_iter_s": 55.5556697845459, "time_total_s": 7665.126465559006, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2488>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 7665.126465559006, "timesteps_since_restore": 0, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 12.88987341772152, "ram_util_percent": 35.081012658227834}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1696.444192325394, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2330.535776974537, 1921.9561305348493, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.913180022521861, "mean_processing_ms": 1.3219903442354268, "mean_inference_ms": 0.6782808023721387}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 432000, "timers": {"learn_time_ms": 3.922, "learn_throughput": 16316.281, "update_time_ms": 0.741}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -69.93451690673828, "critic_loss": 0.005039127543568611, "mean_q": 69.80799102783203, "max_q": 94.4276123046875, "min_q": 21.70412826538086, "mean_td_error": 0.041807860136032104, "td_error": "[ 0.08123779  0.06548309  0.07937622 -0.02237701  0.09043884  0.14485931\n -0.085289    0.125206   -0.01145935  0.08885193  0.14131927  0.14453506\n  0.11047363  0.08930206 -0.03928375  0.01115417  0.06592369 -0.01597595\n  0.14125061 -0.10544586  0.08423615  0.06147766  0.01122284  0.00749588\n -0.18917084  0.02539062 -0.12807465  0.08100128  0.09764862  0.16592407\n  0.06220245  0.13945007 -0.05013275  0.11598206  0.06465912  0.02410126\n  0.09261322 -0.03775787 -0.06184387  0.01112366  0.06014252  0.09619904\n -0.05113983  0.0758667  -0.04729462  0.11423492  0.04137421  0.06577301\n -0.07975006  0.05487823 -0.01469421 -0.13843536  0.07596588  0.14445496\n -0.02935028  0.34062195 -0.03587341  0.06718445 -0.01096344 -0.08518982\n  0.0614624   0.11273193  0.08895874  0.09141541]"}}, "num_steps_sampled": 432000, "num_steps_trained": 27456064, "last_target_update_ts": 432000, "num_target_updates": 429001}, "done": false, "episodes_total": 144, "training_iteration": 144, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-14-04", "timestamp": 1609823644, "time_this_iter_s": 56.22541069984436, "time_total_s": 7721.35187625885, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2c80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 7721.35187625885, "timesteps_since_restore": 0, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 13.067901234567902, "ram_util_percent": 35.10493827160494}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1700.1308864884309, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2290.625546838484, 1804.646780766845, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.91411059274928, "mean_processing_ms": 1.3220833840205302, "mean_inference_ms": 0.6784783351994396}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 435000, "timers": {"learn_time_ms": 4.608, "learn_throughput": 13889.646, "update_time_ms": 0.797}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -66.58345794677734, "critic_loss": 0.0038332496769726276, "mean_q": 66.44432830810547, "max_q": 93.6875, "min_q": 25.193984985351562, "mean_td_error": 0.020889103412628174, "td_error": "[-6.68487549e-02  3.02124023e-03 -9.15527344e-03 -1.64337158e-02\n -6.71024323e-02  3.01055908e-02  1.63421631e-02  4.76264954e-02\n  4.50286865e-02  9.77859497e-02 -5.65338135e-03  8.65783691e-02\n -4.38461304e-02 -2.18620300e-02 -8.52546692e-02  9.95635986e-03\n  6.29920959e-02  2.54669189e-02  1.06018066e-01  1.00852966e-01\n  9.53369141e-02  1.00334167e-01  1.11503601e-02 -1.33743286e-02\n  1.88751221e-02 -1.51443481e-02  1.21484756e-01 -1.10237122e-01\n -5.21430969e-02 -6.91146851e-02  5.09643555e-02  9.39407349e-02\n -1.37855530e-01 -1.24282837e-02  4.55474854e-03 -1.09313965e-01\n  7.34710693e-03  4.83245850e-02 -5.39512634e-02  4.95147705e-02\n  6.95190430e-02 -1.39160156e-02  5.43670654e-02 -3.27873230e-02\n -4.93011475e-02  2.82123566e-01  3.73497009e-02 -7.56835938e-03\n  4.56275940e-02 -9.72633362e-02  6.18934631e-02 -1.62429810e-02\n  1.31378174e-02  8.81347656e-02  2.47955322e-02 -5.40924072e-03\n  3.94859314e-02  3.20587158e-02  3.78303528e-01 -3.33786011e-03\n -4.85763550e-02  9.14001465e-02 -7.62939453e-06  4.92324829e-02]"}}, "num_steps_sampled": 435000, "num_steps_trained": 27648064, "last_target_update_ts": 435000, "num_target_updates": 432001}, "done": false, "episodes_total": 145, "training_iteration": 145, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-15-01", "timestamp": 1609823701, "time_this_iter_s": 57.02255177497864, "time_total_s": 7778.374428033829, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fa60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 7778.374428033829, "timesteps_since_restore": 0, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 13.169135802469137, "ram_util_percent": 35.19753086419752}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": -1504.939329863299, "episode_reward_mean": 1700.473808528116, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1838.938984735375, -1504.939329863299, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.915028437186822, "mean_processing_ms": 1.3221775530561282, "mean_inference_ms": 0.678675600693627}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 438000, "timers": {"learn_time_ms": 3.873, "learn_throughput": 16523.579, "update_time_ms": 0.733}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -63.961708068847656, "critic_loss": 0.009134598076343536, "mean_q": 63.827537536621094, "max_q": 91.46762084960938, "min_q": 15.899608612060547, "mean_td_error": -0.014703765511512756, "td_error": "[-1.99966431e-02 -1.24053955e-02  1.29699707e-02 -5.33752441e-02\n -2.32543945e-02  5.56640625e-02  4.71725464e-02  4.26940918e-02\n -6.86645508e-03  9.08584595e-02 -1.82952881e-02 -2.16674805e-03\n -3.36227417e-02  1.06480598e-01 -4.91714478e-02  1.44962311e-01\n -7.62176514e-03 -8.49494934e-02  4.24423218e-02 -4.20379639e-03\n -3.63311768e-02  3.83399963e-01 -1.04385376e-01  4.31060791e-03\n -4.98046875e-02 -4.75158691e-02 -9.00627136e-01 -3.21464539e-02\n -2.88314819e-02 -3.11012268e-02  7.46917725e-03  7.76748657e-02\n  3.81927490e-02 -2.56767273e-02 -1.25083923e-02 -3.95431519e-02\n -4.28314209e-02  4.82025146e-02 -2.07977295e-02  1.17797852e-02\n -3.70025635e-04  1.15604401e-02 -2.16522217e-02 -2.10037231e-02\n  7.66754150e-03 -4.30145264e-02  1.42173767e-02 -2.15415955e-02\n  1.83715820e-02  1.73683167e-02 -9.14764404e-03  2.70080566e-02\n  6.10351562e-05  1.34849548e-02  4.53948975e-02 -7.23037720e-02\n -8.27026367e-03 -2.13760376e-01 -3.08914185e-02 -4.13742065e-02\n -2.37579346e-02 -5.35621643e-02  6.33430481e-02 -2.51121521e-02]"}}, "num_steps_sampled": 438000, "num_steps_trained": 27840064, "last_target_update_ts": 438000, "num_target_updates": 435001}, "done": false, "episodes_total": 146, "training_iteration": 146, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-15-57", "timestamp": 1609823757, "time_this_iter_s": 56.48252201080322, "time_total_s": 7834.856950044632, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d378>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 7834.856950044632, "timesteps_since_restore": 0, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 12.958024691358027, "ram_util_percent": 35.19999999999999}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 256.9075205008452, "episode_reward_mean": 1741.4379781893458, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2591.477636259695, 2322.0586153995982, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.916023578352264, "mean_processing_ms": 1.3222674011617612, "mean_inference_ms": 0.6788716641270396}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 441000, "timers": {"learn_time_ms": 3.53, "learn_throughput": 18131.405, "update_time_ms": 0.621}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -69.98512268066406, "critic_loss": 0.0031181371305137873, "mean_q": 69.8515625, "max_q": 95.67935180664062, "min_q": 17.891447067260742, "mean_td_error": -0.04623377323150635, "td_error": "[-0.01515198 -0.1317215  -0.07943726 -0.06424713 -0.05982208 -0.06863403\n -0.15717316 -0.04833984 -0.05833817 -0.05332947 -0.14488983 -0.00792313\n -0.11378479  0.01187897 -0.09111786 -0.0632515  -0.04226685 -0.08233261\n -0.1378212   0.02888489 -0.10186005 -0.066185   -0.05922699  0.02659607\n -0.06001282 -0.08414459  0.00268555  0.11050415 -0.01858521 -0.02018738\n -0.04827118 -0.20879745 -0.04188919 -0.06486893 -0.01956558  0.03225327\n  0.07028961 -0.04171753 -0.10292816 -0.110672    0.01892853 -0.06663513\n -0.14339066  0.00990295 -0.04296875 -0.03496552  0.00591278 -0.12135315\n  0.02120972  0.00648499 -0.0399437   0.04841614  0.01153564  0.01752472\n -0.01610565 -0.07857513 -0.03302383 -0.03132248 -0.06491852 -0.13796616\n -0.04206467 -0.0688324   0.0039444   0.0046463 ]"}}, "num_steps_sampled": 441000, "num_steps_trained": 28032064, "last_target_update_ts": 441000, "num_target_updates": 438001}, "done": false, "episodes_total": 147, "training_iteration": 147, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-16-54", "timestamp": 1609823814, "time_this_iter_s": 56.44679570198059, "time_total_s": 7891.303745746613, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54dd08>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 7891.303745746613, "timesteps_since_restore": 0, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 13.407499999999999, "ram_util_percent": 35.199999999999996}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 256.9075205008452, "episode_reward_mean": 1740.6230704845648, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2240.567844921512, 1560.9038311743677, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.91697345519764, "mean_processing_ms": 1.3223570265675952, "mean_inference_ms": 0.6790680118817269}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 444000, "timers": {"learn_time_ms": 4.483, "learn_throughput": 14277.722, "update_time_ms": 0.772}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -65.4031753540039, "critic_loss": 0.0025386589113622904, "mean_q": 65.24713897705078, "max_q": 96.32595825195312, "min_q": -0.17355652153491974, "mean_td_error": 0.0064700813964009285, "td_error": "[ 0.05058289  0.02494431 -0.04345703  0.01359749 -0.05765915  0.04013062\n -0.01104736  0.02919388  0.0683403  -0.04685974 -0.01769257  0.12223816\n -0.04386902  0.24196625 -0.02046204  0.0537262   0.00466919  0.00572968\n -0.04156494  0.03417206 -0.02394104 -0.01026917 -0.03920364 -0.05303955\n -0.11081696 -0.09844971 -0.04504776 -0.02208328  0.01431656  0.0681076\n -0.04718018 -0.03840275  0.03588104  0.01379395 -0.01753235  0.03041077\n  0.01724434  0.07814789  0.09203339  0.04508591  0.06761169 -0.08441162\n -0.04839325 -0.05912018  0.00839615 -0.03653717 -0.08583069 -0.03166962\n -0.06231689  0.05766296 -0.00372314  0.14554596  0.02796936 -0.04992676\n  0.00799561 -0.05648422 -0.06254578 -0.01496124  0.13478088  0.03040695\n  0.14001465 -0.07321167  0.08535767  0.08174133]"}}, "num_steps_sampled": 444000, "num_steps_trained": 28224064, "last_target_update_ts": 444000, "num_target_updates": 441001}, "done": false, "episodes_total": 148, "training_iteration": 148, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-17-50", "timestamp": 1609823870, "time_this_iter_s": 56.579123735427856, "time_total_s": 7947.88286948204, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 7947.88286948204, "timesteps_since_restore": 0, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 13.697530864197534, "ram_util_percent": 35.19999999999999}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 256.9075205008452, "episode_reward_mean": 1748.9897069105075, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2397.5674737686113, 2357.9920242765315, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.91793075810173, "mean_processing_ms": 1.32244889751187, "mean_inference_ms": 0.6792669534421174}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 447000, "timers": {"learn_time_ms": 4.182, "learn_throughput": 15303.141, "update_time_ms": 0.732}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -69.1625747680664, "critic_loss": 0.0022511000279337168, "mean_q": 69.0321273803711, "max_q": 95.7326889038086, "min_q": 5.328553199768066, "mean_td_error": 0.014275245368480682, "td_error": "[ 0.10399628 -0.00888062  0.00506973  0.00801468 -0.00073242 -0.10274506\n -0.07601166  0.0568161  -0.05926514 -0.00182343  0.01404572  0.05723572\n -0.14608002  0.0219841   0.06773758  0.12069321  0.01442719 -0.02353287\n  0.06822205  0.06356812  0.00604248  0.0413208   0.10840607 -0.03684235\n  0.05368423 -0.09544039  0.06086731  0.04634857 -0.02329254  0.0626297\n  0.13184357 -0.06078339  0.06339264 -0.05840302 -0.03026581  0.00309372\n -0.03536606 -0.04930115  0.02518463  0.05261993  0.02755737 -0.01751709\n  0.04147339 -0.03015137 -0.01890564  0.01154327  0.00996399  0.03447723\n -0.00322723 -0.09534073 -0.00932312  0.06152344  0.00502777  0.17923737\n -0.00058746  0.09420395  0.00325775 -0.02354431  0.1222229   0.01567459\n  0.0190506  -0.0147171  -0.02963257  0.08287048]"}}, "num_steps_sampled": 447000, "num_steps_trained": 28416064, "last_target_update_ts": 447000, "num_target_updates": 444001}, "done": false, "episodes_total": 149, "training_iteration": 149, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-18-48", "timestamp": 1609823928, "time_this_iter_s": 57.366358518600464, "time_total_s": 8005.249228000641, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d1e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 8005.249228000641, "timesteps_since_restore": 0, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 14.496341463414634, "ram_util_percent": 35.208536585365856}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 256.9075205008452, "episode_reward_mean": 1742.6227566437155, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1721.296997597343, 2225.984432028312, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.918844264023317, "mean_processing_ms": 1.3225423368618439, "mean_inference_ms": 0.6794670673626214}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 450000, "timers": {"learn_time_ms": 4.606, "learn_throughput": 13896.261, "update_time_ms": 0.827}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -71.94287872314453, "critic_loss": 0.003189080860465765, "mean_q": 71.8064956665039, "max_q": 93.92424774169922, "min_q": 25.629833221435547, "mean_td_error": 0.015818923711776733, "td_error": "[ 6.61201477e-02 -1.65863037e-02  5.48896790e-02 -9.69848633e-02\n  3.43856812e-02  1.55792236e-02  5.63468933e-02 -1.37886047e-01\n  7.04193115e-03 -2.31018066e-02  1.00563049e-01  5.92956543e-02\n  9.47875977e-02  4.05731201e-02  6.50024414e-03  6.52313232e-02\n  2.10266113e-02 -1.68838501e-02  2.48222351e-02  7.15408325e-02\n  2.16674805e-03  5.00183105e-02  6.87160492e-02  8.66088867e-02\n  2.79159546e-02  2.00241089e-01  1.32705688e-01  2.65998840e-02\n -7.20710754e-02 -4.02832031e-02 -2.74345398e-01  4.67453003e-02\n -1.28097534e-02  2.08892822e-02 -9.18273926e-02  2.10800171e-02\n -4.69970703e-02 -2.78396606e-02  1.32362366e-01 -6.34841919e-02\n -2.16979980e-02 -2.00653076e-03 -2.06756592e-03 -6.92329407e-02\n -1.17530823e-02 -1.00364685e-02 -5.45959473e-02  1.05056763e-01\n  1.39694214e-02 -6.56890869e-02  3.08761597e-02 -2.49557495e-02\n  5.28526306e-02  1.12457275e-01  1.89510345e-01 -4.14886475e-02\n -3.49998474e-02 -9.15527344e-05  3.75518799e-02 -2.62527466e-02\n  2.56347656e-02  4.24423218e-02  6.08444214e-02  9.24301147e-02]"}}, "num_steps_sampled": 450000, "num_steps_trained": 28608064, "last_target_update_ts": 450000, "num_target_updates": 447001}, "done": false, "episodes_total": 150, "training_iteration": 150, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-19-44", "timestamp": 1609823984, "time_this_iter_s": 55.97055196762085, "time_total_s": 8061.219779968262, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2488>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 8061.219779968262, "timesteps_since_restore": 0, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 14.196250000000001, "ram_util_percent": 35.300000000000004}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 256.9075205008452, "episode_reward_mean": 1738.9979833321736, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1863.5071008741188, 426.1876983063981, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.919709786652719, "mean_processing_ms": 1.3226392960151585, "mean_inference_ms": 0.6796680152326953}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 453000, "timers": {"learn_time_ms": 4.355, "learn_throughput": 14695.908, "update_time_ms": 0.709}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -64.94799041748047, "critic_loss": 0.007543129846453667, "mean_q": 64.79027557373047, "max_q": 94.6875, "min_q": 1.1196603775024414, "mean_td_error": 0.07800174504518509, "td_error": "[ 0.20655441  0.1233139   0.01734161  0.03569031 -0.06416321  0.02613068\n  0.11633301  0.06177521  0.04396057  0.270298    0.09223557  0.06489944\n -0.01270294  0.12768555  0.00123978  0.13185883  0.06384659  0.03087616\n -0.16615295  0.2024765   0.05783844  0.2252121   0.12332153  0.19042969\n  0.08850098  0.15057373  0.215868    0.15565109 -0.03782654  0.17692566\n  0.07835007  0.06092072  0.14531898 -0.09811401 -0.04051971  0.03925323\n -0.02338409  0.07346725  0.0716095   0.0414505   0.23649448  0.05361938\n  0.16542816  0.03052139  0.11997223  0.08187485 -0.01771545  0.04257202\n  0.05238724 -0.04103851  0.09218979  0.04506683  0.12854004  0.1822815\n  0.02744293  0.01796913  0.2338562   0.10279083 -0.1929245   0.16431427\n  0.1429596   0.11969757  0.06661987  0.06884766]"}}, "num_steps_sampled": 453000, "num_steps_trained": 28800064, "last_target_update_ts": 453000, "num_target_updates": 450001}, "done": false, "episodes_total": 151, "training_iteration": 151, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-20-40", "timestamp": 1609824040, "time_this_iter_s": 56.86904048919678, "time_total_s": 8118.0888204574585, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a29d8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 8118.0888204574585, "timesteps_since_restore": 0, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 14.019753086419755, "ram_util_percent": 35.30000000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 256.9075205008452, "episode_reward_mean": 1757.561063276862, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2282.495692775196, 1706.759429673675, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.92064177269031, "mean_processing_ms": 1.3227400054893022, "mean_inference_ms": 0.6798730599439456}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 456000, "timers": {"learn_time_ms": 4.175, "learn_throughput": 15328.308, "update_time_ms": 0.789}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -70.67183685302734, "critic_loss": 0.03035495989024639, "mean_q": 70.5241928100586, "max_q": 95.73436737060547, "min_q": 21.625368118286133, "mean_td_error": -0.23252078890800476, "td_error": "[-0.20291138 -0.28749657 -0.1546402  -0.3296814  -0.24063873 -0.13378525\n -0.23034668 -0.2961731  -0.23234558 -0.12380981 -0.25165176 -0.00582123\n -0.4104042  -0.17927551 -0.3364029  -0.29505157 -0.20596313 -0.2671013\n -0.25267792 -0.27861404 -0.3023224  -0.22823334 -0.20613861 -0.24810791\n -0.25344086 -0.1604538  -0.15882874 -0.13882446 -0.24177551 -0.17761993\n -0.2307663  -0.24303055 -0.18312073 -0.31386948 -0.38505554 -0.29742432\n -0.127594   -0.15325928 -0.2499237  -0.30759048 -0.23793793 -0.20748138\n -0.27724457 -0.16952515 -0.24815369 -0.25350952 -0.18285751 -0.25354767\n -0.18776703 -0.23813248 -0.2781067  -0.06380463 -0.31497192 -0.07556152\n -0.13376999 -0.3302307  -0.35858154 -0.19221497 -0.24588776 -0.3234291\n -0.2873726  -0.23643494 -0.13014984 -0.3324852 ]"}}, "num_steps_sampled": 456000, "num_steps_trained": 28992064, "last_target_update_ts": 456000, "num_target_updates": 453001}, "done": false, "episodes_total": 152, "training_iteration": 152, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-21-38", "timestamp": 1609824098, "time_this_iter_s": 57.23081684112549, "time_total_s": 8175.319637298584, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a27b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 8175.319637298584, "timesteps_since_restore": 0, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 13.369135802469136, "ram_util_percent": 35.30000000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 256.9075205008452, "episode_reward_mean": 1757.2399855328663, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1674.6516552741286, 1491.1493369300204, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.921557001763355, "mean_processing_ms": 1.3228403531345865, "mean_inference_ms": 0.6800796055522373}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 459000, "timers": {"learn_time_ms": 4.227, "learn_throughput": 15139.501, "update_time_ms": 0.661}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -69.38196563720703, "critic_loss": 0.03723285347223282, "mean_q": 69.25714111328125, "max_q": 94.61264038085938, "min_q": 37.906253814697266, "mean_td_error": -0.2603911757469177, "td_error": "[-0.32985687 -0.2491684  -0.26623535 -0.3610382  -0.3152237  -0.2789383\n -0.26965332 -0.23554993 -0.26854706 -0.21240997 -0.37418747 -0.15385818\n -0.26460266 -0.3128662  -0.2674408  -0.30530548 -0.2003479  -0.2806015\n -0.36530685 -0.07553101 -0.30077362 -0.2873459  -0.141716   -0.18752289\n -0.3693161  -0.22130966 -0.2128067  -0.14743805 -0.22356415 -0.317482\n -0.33648682 -0.31531143 -0.262825   -0.36190796 -0.20172119 -0.2119751\n -0.3613968  -0.2734604  -0.20817947 -0.34773254 -0.2810669  -0.18086243\n -0.29075623 -0.0452919  -0.25535202 -0.19152069 -0.22773743 -0.29567719\n -0.30764008 -0.36855316 -0.36237335 -0.1508789  -0.2863083  -0.2812271\n -0.21684265 -0.21609497 -0.2381401  -0.2819748  -0.29504395 -0.19651794\n -0.38228607 -0.26822662 -0.33828735 -0.0294342 ]"}}, "num_steps_sampled": 459000, "num_steps_trained": 29184064, "last_target_update_ts": 459000, "num_target_updates": 456001}, "done": false, "episodes_total": 153, "training_iteration": 153, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-22-34", "timestamp": 1609824154, "time_this_iter_s": 56.13130736351013, "time_total_s": 8231.450944662094, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2c80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 8231.450944662094, "timesteps_since_restore": 0, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 11.760000000000002, "ram_util_percent": 35.19250000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 256.9075205008452, "episode_reward_mean": 1758.9109818851957, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1658.2489721629365, 2184.1350596249517, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.922450986891595, "mean_processing_ms": 1.3229424859616037, "mean_inference_ms": 0.6802841547990123}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 462000, "timers": {"learn_time_ms": 4.807, "learn_throughput": 13312.741, "update_time_ms": 0.601}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -68.67455291748047, "critic_loss": 0.0033967033959925175, "mean_q": 68.55538940429688, "max_q": 95.59490966796875, "min_q": 4.484702110290527, "mean_td_error": -0.03999144583940506, "td_error": "[ 0.03610229 -0.06332779  0.043396   -0.0177269  -0.04029846 -0.05986023\n -0.04517365 -0.07026672  0.05392838  0.00984955 -0.03819275  0.03012848\n -0.0411377   0.09153366 -0.02241325 -0.11898041 -0.01045227  0.01578522\n -0.027771   -0.17619324 -0.03048706 -0.14782715  0.00300598 -0.14146042\n -0.01623154  0.11718369 -0.04153442 -0.03013659 -0.03157806  0.05338478\n -0.08535004 -0.0526123  -0.03975677 -0.12349701  0.05634689 -0.0439682\n -0.09411621  0.10171509 -0.09089661 -0.07458496 -0.03889465 -0.12032318\n -0.05796814 -0.07039642 -0.02465057  0.08816528 -0.05701447 -0.0479126\n -0.05374908 -0.05545807 -0.13331604 -0.2520218  -0.01559448  0.01625824\n -0.01633453 -0.04469299 -0.12553406 -0.08642578 -0.07520294 -0.06813812\n -0.06285095 -0.122612    0.0091629   0.01952362]"}}, "num_steps_sampled": 462000, "num_steps_trained": 29376064, "last_target_update_ts": 462000, "num_target_updates": 459001}, "done": false, "episodes_total": 154, "training_iteration": 154, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-23-29", "timestamp": 1609824209, "time_this_iter_s": 54.89084482192993, "time_total_s": 8286.341789484024, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54dae8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 8286.341789484024, "timesteps_since_restore": 0, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 9.622784810126584, "ram_util_percent": 35.30000000000002}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 256.9075205008452, "episode_reward_mean": 1756.2110467149405, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1914.1415425994983, 2286.187270759327, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.9233153077324685, "mean_processing_ms": 1.3230417279268467, "mean_inference_ms": 0.680487072048982}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 465000, "timers": {"learn_time_ms": 4.091, "learn_throughput": 15645.827, "update_time_ms": 0.661}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -65.52642822265625, "critic_loss": 0.007237456273287535, "mean_q": 65.42042541503906, "max_q": 94.28871154785156, "min_q": 31.665220260620117, "mean_td_error": 0.10254955291748047, "td_error": "[ 0.1639328   0.17429352  0.12505722 -0.01316071  0.18041992  0.12548065\n  0.07487869  0.22146606  0.15385437  0.07544708  0.07994461  0.10968399\n -0.0054245   0.04323196  0.08273697  0.1658783   0.14526749  0.14881134\n  0.08117676  0.11335754  0.09600067  0.06809998  0.01251602  0.1169281\n  0.01815796  0.00563049  0.12877655  0.06323242  0.14299774  0.15696716\n  0.09994125  0.11149597  0.14759827  0.03479767  0.09474182  0.09718323\n  0.0873642   0.09075165  0.11422729  0.05979538  0.07878113  0.12689209\n  0.21873856  0.02355194  0.11941528  0.17190933  0.18760681  0.05641174\n  0.12243652  0.11997223  0.0801506   0.07159424  0.09024429  0.28307343\n  0.12831879  0.0426712   0.0656662   0.15068817  0.0588913   0.03750992\n  0.16691971  0.03738403  0.05882263  0.07198334]"}}, "num_steps_sampled": 465000, "num_steps_trained": 29568064, "last_target_update_ts": 465000, "num_target_updates": 462001}, "done": false, "episodes_total": 155, "training_iteration": 155, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-24-24", "timestamp": 1609824264, "time_this_iter_s": 55.193053245544434, "time_total_s": 8341.534842729568, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d9d8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 8341.534842729568, "timesteps_since_restore": 0, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 8.533333333333331, "ram_util_percent": 35.30000000000002}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 256.9075205008452, "episode_reward_mean": 1751.842167896736, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1849.2993889388276, 1998.8611397378997, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.9241443703925665, "mean_processing_ms": 1.323140879721139, "mean_inference_ms": 0.6806874071825078}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 468000, "timers": {"learn_time_ms": 4.221, "learn_throughput": 15161.819, "update_time_ms": 0.658}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -68.20185089111328, "critic_loss": 0.0065994844771921635, "mean_q": 68.08844757080078, "max_q": 93.9544677734375, "min_q": 26.928791046142578, "mean_td_error": 0.08854225277900696, "td_error": "[-0.07292175  0.10105133  0.0559845   0.16300201  0.0693512   0.01777649\n  0.1228447   0.05839157  0.08579636  0.12555695  0.07973862  0.02137756\n  0.02017975  0.0859375   0.08650589  0.04440308  0.15118408  0.13126183\n  0.12607574  0.05825806  0.06568909  0.09863663  0.10788727  0.02509308\n  0.03678131  0.11676788  0.04714203  0.12408447  0.03846359  0.0189743\n  0.1627655   0.06611633  0.03957367  0.16140747  0.22006989 -0.0526123\n -0.01877594  0.06873703  0.03144836  0.15932465  0.10610199  0.01800537\n  0.09162903  0.21701813  0.24881744  0.17271423  0.02159882  0.06240082\n  0.15699005  0.07157898  0.13228607 -0.05609894  0.17218018  0.13121414\n  0.08957672  0.07013321  0.2757721   0.08480072  0.15080643  0.0729866\n  0.078125    0.16939926  0.01407623  0.06526184]"}}, "num_steps_sampled": 468000, "num_steps_trained": 29760064, "last_target_update_ts": 468000, "num_target_updates": 465001}, "done": false, "episodes_total": 156, "training_iteration": 156, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-25-19", "timestamp": 1609824319, "time_this_iter_s": 55.130863666534424, "time_total_s": 8396.665706396103, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d6a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 8396.665706396103, "timesteps_since_restore": 0, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 8.80506329113924, "ram_util_percent": 35.30000000000002}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 256.9075205008452, "episode_reward_mean": 1746.521054784474, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1466.7498285117438, 878.3967461848575, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.9249388030115275, "mean_processing_ms": 1.3232360744390608, "mean_inference_ms": 0.680886935667983}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 471000, "timers": {"learn_time_ms": 3.862, "learn_throughput": 16571.42, "update_time_ms": 0.733}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -68.8093490600586, "critic_loss": 0.0024301789235323668, "mean_q": 68.67359161376953, "max_q": 94.47835540771484, "min_q": 18.420007705688477, "mean_td_error": 0.020530909299850464, "td_error": "[-0.12870026  0.05029297 -0.02845001 -0.086586   -0.02882385  0.04000092\n  0.05274963 -0.02671051  0.08612061  0.06600571  0.08372498 -0.03972626\n  0.08132935 -0.02103806 -0.16442108  0.00779724  0.01300812  0.02672577\n  0.02054596  0.03268433 -0.08175659 -0.01473236  0.01984406 -0.04291534\n -0.07878494  0.11756134  0.02846146  0.05753326  0.02611542  0.06269836\n  0.13502121 -0.03195572 -0.09578705  0.03230286  0.02918625  0.02352524\n -0.02511215  0.05711365 -0.01409912  0.11058044  0.07034302  0.00622559\n  0.01228333  0.17063522  0.08095169  0.0027504   0.07470703 -0.00157928\n -0.05496979  0.03043365  0.01088715  0.03461456  0.13381577  0.04746246\n  0.03030396 -0.00746918  0.00378418  0.06290436  0.00662231  0.08614349\n  0.05710602  0.0212574   0.02147675  0.06195831]"}}, "num_steps_sampled": 471000, "num_steps_trained": 29952064, "last_target_update_ts": 471000, "num_target_updates": 468001}, "done": false, "episodes_total": 157, "training_iteration": 157, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-26-14", "timestamp": 1609824374, "time_this_iter_s": 54.71566128730774, "time_total_s": 8451.38136768341, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fa60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 8451.38136768341, "timesteps_since_restore": 0, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 9.588461538461537, "ram_util_percent": 35.430769230769215}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 256.9075205008452, "episode_reward_mean": 1754.1204849855455, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1638.3397662920434, 1218.2206151054615, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.925745338498234, "mean_processing_ms": 1.3233223767004965, "mean_inference_ms": 0.6810864354081808}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 474000, "timers": {"learn_time_ms": 3.943, "learn_throughput": 16231.041, "update_time_ms": 0.707}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -68.78931427001953, "critic_loss": 0.002990107284858823, "mean_q": 68.64661407470703, "max_q": 96.64892578125, "min_q": 22.774648666381836, "mean_td_error": -0.0021999776363372803, "td_error": "[-0.06390381 -0.02437592  0.09707642  0.05940247 -0.06911469 -0.04754639\n  0.1328888  -0.03574371 -0.03489685 -0.01996613  0.14113617 -0.02933502\n -0.04605103 -0.02908325 -0.03150177 -0.0064888  -0.0032196   0.06641769\n -0.01647568  0.03128052 -0.03439331  0.06261444 -0.03392792 -0.00733185\n -0.05101013 -0.06699371  0.10438156 -0.1211319  -0.01128387 -0.06522369\n  0.00295258  0.06493378 -0.0013237   0.03323364  0.03033638  0.10375214\n -0.02763367  0.00842285 -0.11077499 -0.00273132 -0.02771759 -0.08882904\n -0.17972946 -0.01335144  0.19850159 -0.04734421 -0.00315857 -0.10643005\n -0.04009247  0.20516968  0.02030945  0.03819656 -0.02593231 -0.08099365\n -0.03619385 -0.04930496  0.02389526 -0.04176712 -0.00317383  0.17721176\n -0.0539856   0.04853821  0.01152039 -0.01350403]"}}, "num_steps_sampled": 474000, "num_steps_trained": 30144064, "last_target_update_ts": 474000, "num_target_updates": 471001}, "done": false, "episodes_total": 158, "training_iteration": 158, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-27-10", "timestamp": 1609824430, "time_this_iter_s": 56.35495090484619, "time_total_s": 8507.736318588257, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fea0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 8507.736318588257, "timesteps_since_restore": 0, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 13.235802469135804, "ram_util_percent": 36.19999999999999}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 256.9075205008452, "episode_reward_mean": 1763.3601380169314, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2142.1859182439935, 1754.8623181059365, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.926577549814822, "mean_processing_ms": 1.3234064923090676, "mean_inference_ms": 0.6812878426268435}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 477000, "timers": {"learn_time_ms": 3.712, "learn_throughput": 17241.663, "update_time_ms": 0.74}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -72.16036987304688, "critic_loss": 0.002405837643891573, "mean_q": 72.04413604736328, "max_q": 95.63472747802734, "min_q": 0.8886958956718445, "mean_td_error": 0.005073068663477898, "td_error": "[-0.07584381  0.00791168  0.07426453 -0.00334167 -0.03358459 -0.01049042\n  0.00144196 -0.09840393  0.02500916 -0.01802826  0.03873825 -0.04957581\n  0.03932953 -0.06394958  0.00491714  0.07876587  0.07380664  0.09855652\n  0.08107758 -0.00295258  0.01443481 -0.07521057 -0.00037003 -0.00627136\n -0.02748108  0.01335526  0.10581207 -0.12129211  0.02515411 -0.06980133\n -0.02962494 -0.09848785 -0.0081749   0.01147461 -0.02856445 -0.00933456\n -0.02664948  0.08869934 -0.08305359  0.02581787  0.01459503 -0.04621887\n  0.05149841 -0.07486725  0.04625702  0.03524017 -0.0381279  -0.04433441\n -0.03765869 -0.00439453  0.05047607  0.0234642  -0.02716827  0.1444664\n  0.02013779 -0.10810852  0.224823    0.06965637  0.06811523  0.02204132\n -0.03261566 -0.05474091  0.12882996  0.02523041]"}}, "num_steps_sampled": 477000, "num_steps_trained": 30336064, "last_target_update_ts": 477000, "num_target_updates": 474001}, "done": false, "episodes_total": 159, "training_iteration": 159, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-28-07", "timestamp": 1609824487, "time_this_iter_s": 57.265764236450195, "time_total_s": 8565.002082824707, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54da60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 8565.002082824707, "timesteps_since_restore": 0, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 15.134567901234568, "ram_util_percent": 36.19999999999999}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 256.9075205008452, "episode_reward_mean": 1770.080346770599, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2426.883193472711, 1853.4264824138777, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.9274034599750385, "mean_processing_ms": 1.3234904120744004, "mean_inference_ms": 0.6814898028998932}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 480000, "timers": {"learn_time_ms": 4.197, "learn_throughput": 15248.376, "update_time_ms": 0.765}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -68.04857635498047, "critic_loss": 0.0022197565995156765, "mean_q": 67.90729522705078, "max_q": 94.88875579833984, "min_q": 11.269289016723633, "mean_td_error": 0.02060195803642273, "td_error": "[ 0.05228424  0.02915955  0.00728607  0.18945312  0.06333923  0.02618408\n  0.00775146 -0.00838947  0.00490952  0.00889969 -0.03944397  0.00821304\n  0.0032196   0.11737823  0.09732819 -0.06270599  0.02484894  0.08228302\n  0.03812408 -0.07881546  0.04217529  0.01826477  0.06983948 -0.04727173\n  0.04064178  0.08355713  0.01862335  0.00627899  0.07137299  0.01192474\n  0.05805969  0.0362072  -0.0539093   0.01676273 -0.0245018  -0.03505325\n -0.13310242  0.06310272  0.04125214  0.02981567  0.0775528  -0.00106812\n -0.01811981  0.06726456  0.02265167  0.04714203 -0.04044342  0.08149719\n -0.10125542 -0.0856514  -0.00762939  0.0269928   0.05763626  0.05752563\n  0.01958847 -0.01663971 -0.01179886  0.1064682  -0.00109291  0.01300812\n  0.09062195  0.03077698 -0.10508728  0.12323761]"}}, "num_steps_sampled": 480000, "num_steps_trained": 30528064, "last_target_update_ts": 480000, "num_target_updates": 477001}, "done": false, "episodes_total": 160, "training_iteration": 160, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-29-05", "timestamp": 1609824545, "time_this_iter_s": 57.23367881774902, "time_total_s": 8622.235761642456, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54dd90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 8622.235761642456, "timesteps_since_restore": 0, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 14.179268292682927, "ram_util_percent": 36.26341463414635}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 256.9075205008452, "episode_reward_mean": 1775.6146623973953, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2406.8580450935324, 1579.3925937465838, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.9282249512117176, "mean_processing_ms": 1.3235767393825215, "mean_inference_ms": 0.68169223516883}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 483000, "timers": {"learn_time_ms": 4.029, "learn_throughput": 15885.447, "update_time_ms": 0.718}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -74.48844909667969, "critic_loss": 0.017568565905094147, "mean_q": 74.38671875, "max_q": 95.67476654052734, "min_q": 37.002685546875, "mean_td_error": 0.12167394161224365, "td_error": "[-0.1656189   0.3061943  -0.21161652  0.17284775  0.16724396  0.02972412\n  0.1301117   0.06575012  0.28192902 -0.09251404  0.21268082  0.38656616\n -0.16332245 -0.07789612  0.16667938 -0.0584259   0.1780777   0.17613983\n  0.25767136 -0.13235474  0.31430817 -0.00619507  0.14111328  0.08998871\n -0.0645752  -0.00106812  0.21953583  0.25065994  0.16169739  0.17289734\n  0.08673859  0.21109009  0.08072662  0.08571243  0.24165344  0.33190918\n  0.13368988  0.24845123 -0.12303162  0.3090973   0.10749817  0.14006042\n  0.27782822  0.2117157   0.15206909 -0.05857086  0.2139206   0.11849213\n -0.08640289  0.15626526  0.35240555  0.04773712 -0.10277557  0.20092773\n  0.14548492  0.23703384  0.11637115  0.17240143  0.17319489  0.21094894\n  0.2240982  -0.04205322  0.1707077   0.13350677]"}}, "num_steps_sampled": 483000, "num_steps_trained": 30720064, "last_target_update_ts": 483000, "num_target_updates": 480001}, "done": false, "episodes_total": 161, "training_iteration": 161, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-30-02", "timestamp": 1609824602, "time_this_iter_s": 57.13786220550537, "time_total_s": 8679.373623847961, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2bf8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 8679.373623847961, "timesteps_since_restore": 0, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 14.929629629629629, "ram_util_percent": 36.42098765432098}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 256.9075205008452, "episode_reward_mean": 1775.3447471088657, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1552.4010648935734, 2492.372862438557, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.929046301656313, "mean_processing_ms": 1.3236615813431456, "mean_inference_ms": 0.6818957169870393}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 486000, "timers": {"learn_time_ms": 4.033, "learn_throughput": 15868.356, "update_time_ms": 0.683}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -69.32770538330078, "critic_loss": 0.014570744708180428, "mean_q": 69.19408416748047, "max_q": 95.05242156982422, "min_q": 24.69361686706543, "mean_td_error": -0.15232554078102112, "td_error": "[-0.20503998 -0.1189003  -0.14714813 -0.25966263 -0.24015045 -0.20750046\n -0.19656372 -0.00122833 -0.1791687  -0.27803802 -0.1554718  -0.14648056\n -0.1557846  -0.0433197  -0.13551712 -0.11344528 -0.09463501 -0.05736542\n -0.15388489 -0.16329193 -0.17953491 -0.1237793  -0.27707672 -0.1527443\n -0.14659882  0.00335312 -0.2154541  -0.21845245 -0.15208817 -0.0983963\n -0.0752182  -0.01360321 -0.26198578 -0.16846466 -0.21493912 -0.19339752\n -0.10243607 -0.11220551 -0.14179993 -0.15752411 -0.140419   -0.23936462\n -0.22074127 -0.15177155 -0.0981369  -0.02774048 -0.19108582 -0.13591385\n -0.18870544 -0.0920639  -0.21925163 -0.19758606 -0.18110657 -0.270298\n -0.24147797 -0.2549057  -0.13404465 -0.03784561 -0.10607147 -0.1740036\n -0.06747437 -0.09631348  0.01989746 -0.24746704]"}}, "num_steps_sampled": 486000, "num_steps_trained": 30912064, "last_target_update_ts": 486000, "num_target_updates": 483001}, "done": false, "episodes_total": 162, "training_iteration": 162, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-30-58", "timestamp": 1609824658, "time_this_iter_s": 56.387654304504395, "time_total_s": 8735.761278152466, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 8735.761278152466, "timesteps_since_restore": 0, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 14.862962962962968, "ram_util_percent": 36.35555555555556}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 256.9075205008452, "episode_reward_mean": 1770.944671132262, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2052.365264778214, 2219.0924787491767, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.9298450785453225, "mean_processing_ms": 1.3237492264914972, "mean_inference_ms": 0.682101334020755}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 489000, "timers": {"learn_time_ms": 4.192, "learn_throughput": 15267.455, "update_time_ms": 0.638}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -73.51309204101562, "critic_loss": 0.012434927746653557, "mean_q": 73.36061096191406, "max_q": 94.28366088867188, "min_q": 22.1044864654541, "mean_td_error": 0.1255715787410736, "td_error": "[ 0.1632843   0.3085785  -0.1266861   0.13215637  0.06820679  0.1407013\n  0.08307648  0.21386719  0.15487671  0.11242294  0.20265579  0.01784515\n  0.20030975  0.13209534  0.1125412   0.0093689   0.20678711  0.14376831\n  0.09130096  0.163414   -0.04398346  0.17474365  0.08242035  0.13652802\n  0.15283966 -0.09655762  0.16661835  0.16788483  0.18399811  0.11942291\n  0.09447479  0.03729248  0.15525818  0.08946228  0.22710037  0.04692841\n -0.02397919  0.2625656   0.25034332  0.16841888  0.07884979  0.3238659\n  0.23071289  0.0759201   0.09409332  0.17445374 -0.00085449  0.092453\n  0.14722443  0.14948273  0.15072632 -0.07413483  0.21051788  0.0004425\n  0.12792206  0.27030563 -0.02518082  0.11177063  0.22966003  0.17673874\n  0.12133026  0.12704468  0.18373108  0.17715454]"}}, "num_steps_sampled": 489000, "num_steps_trained": 31104064, "last_target_update_ts": 489000, "num_target_updates": 486001}, "done": false, "episodes_total": 163, "training_iteration": 163, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-31-55", "timestamp": 1609824715, "time_this_iter_s": 56.836456537246704, "time_total_s": 8792.597734689713, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2268>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 8792.597734689713, "timesteps_since_restore": 0, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 13.191358024691358, "ram_util_percent": 36.34074074074074}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 256.9075205008452, "episode_reward_mean": 1765.376909720149, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1662.3163375378392, 2034.492778835315, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.9306471156241845, "mean_processing_ms": 1.323844157304946, "mean_inference_ms": 0.6823125095962773}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 492000, "timers": {"learn_time_ms": 4.393, "learn_throughput": 14569.089, "update_time_ms": 0.688}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -72.13224029541016, "critic_loss": 0.0022755316458642483, "mean_q": 71.9773178100586, "max_q": 94.08818054199219, "min_q": 36.50279998779297, "mean_td_error": -0.0025253891944885254, "td_error": "[-0.02573395  0.03145599 -0.06575775 -0.0051918  -0.00486755  0.10323334\n  0.10979462 -0.06164551 -0.06272125  0.01882935 -0.01165009 -0.07328796\n -0.06032562 -0.00178528 -0.0901413   0.04461288 -0.03656387  0.00691223\n  0.01239014 -0.00162506  0.00676727 -0.0276947  -0.06433868  0.06449127\n  0.00183487 -0.04688263 -0.04438019 -0.0109787  -0.00260162 -0.00276947\n  0.04409027  0.13975525  0.00206757 -0.00396729 -0.08204651 -0.0302887\n -0.11183929  0.03436279  0.05504608 -0.02318573  0.02052307  0.01118851\n -0.02085495 -0.01485062 -0.02862549 -0.0161438   0.02250671 -0.07848358\n -0.04220581  0.00695801  0.02821732 -0.09225464 -0.09939575 -0.01143646\n -0.01053619  0.03018951 -0.05467987  0.05065536 -0.00792313  0.26771927\n -0.02001953 -0.00054932  0.03450775  0.1404953 ]"}}, "num_steps_sampled": 492000, "num_steps_trained": 31296064, "last_target_update_ts": 492000, "num_target_updates": 489001}, "done": false, "episodes_total": 164, "training_iteration": 164, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-32-52", "timestamp": 1609824772, "time_this_iter_s": 56.976173400878906, "time_total_s": 8849.573908090591, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2ea0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 8849.573908090591, "timesteps_since_restore": 0, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 14.87777777777778, "ram_util_percent": 36.693827160493825}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 256.9075205008452, "episode_reward_mean": 1769.290737785197, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2425.8755853401203, 256.9075205008452, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.931445286372844, "mean_processing_ms": 1.323943036126992, "mean_inference_ms": 0.6825256532650329}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 495000, "timers": {"learn_time_ms": 4.053, "learn_throughput": 15791.807, "update_time_ms": 0.659}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -73.2035903930664, "critic_loss": 0.017901096493005753, "mean_q": 73.05233764648438, "max_q": 95.87149810791016, "min_q": 23.307527542114258, "mean_td_error": -0.12561973929405212, "td_error": "[-0.19540787 -0.1212616  -0.08988953 -0.16059113 -0.15654755 -0.03044891\n -0.21692657 -0.04772186 -0.09210205 -0.2781372  -0.06733704 -0.04701996\n -0.15481949 -0.10996246 -0.15384674 -0.10212708 -0.14556122 -0.13678741\n -0.18177032  0.00878143 -0.17853546 -0.02173615 -0.05114746 -0.01950455\n -0.04132843  0.04586792 -0.1302414  -0.06469727 -0.19216156 -0.17175293\n -0.19355392 -0.08089447 -0.06241608 -0.16792297 -0.2060852   0.07774353\n -0.08989716 -0.17658234 -0.07901001 -0.07157898 -0.03886795 -0.1425476\n -0.21465302 -1.0421371  -0.11445618 -0.05285645 -0.13035583 -0.1373291\n -0.14143372 -0.08604431 -0.1206131  -0.2191391  -0.2312355  -0.02692413\n -0.07787323  0.09617615 -0.20271492 -0.08518219 -0.17806244  0.00532532\n -0.18359375 -0.25073624 -0.04844666 -0.06104279]"}}, "num_steps_sampled": 495000, "num_steps_trained": 31488064, "last_target_update_ts": 495000, "num_target_updates": 492001}, "done": false, "episodes_total": 165, "training_iteration": 165, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-33-49", "timestamp": 1609824829, "time_this_iter_s": 56.6401686668396, "time_total_s": 8906.214076757431, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fd08>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 8906.214076757431, "timesteps_since_restore": 0, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 14.014814814814812, "ram_util_percent": 36.83333333333333}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 425.6771861343114, "episode_reward_mean": 1781.2274274272388, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1450.5764847050748, 1536.5192343606986, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.932298102425444, "mean_processing_ms": 1.3240408449328402, "mean_inference_ms": 0.6827442979451125}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 498000, "timers": {"learn_time_ms": 4.267, "learn_throughput": 14999.495, "update_time_ms": 0.66}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -71.7419204711914, "critic_loss": 0.003182633314281702, "mean_q": 71.61621856689453, "max_q": 96.1264419555664, "min_q": 43.9805908203125, "mean_td_error": 0.012002766132354736, "td_error": "[ 0.07307434  0.02693176 -0.05201721 -0.08634949 -0.00719452  0.00338745\n  0.06113434 -0.0703125   0.04578781  0.00980759  0.07408905  0.0263443\n -0.009758   -0.01730347  0.07305145 -0.06526947  0.13105774  0.02622223\n  0.03500366  0.02326584 -0.05970001  0.03536987 -0.07061768 -0.02581024\n  0.02470398  0.12348938  0.056633   -0.04510498  0.04419708 -0.16049194\n -0.04238892  0.01664734  0.02400589  0.07572556 -0.10530853 -0.04766846\n -0.04890442 -0.09972382  0.18435669  0.01393127  0.06288147  0.06876373\n -0.00074005  0.12282562  0.00019836  0.1495285   0.02980804 -0.05007935\n  0.07051468  0.08480453 -0.09287262  0.05832291  0.05792236 -0.02346802\n -0.08010864  0.17177963  0.04077148  0.03119659  0.02770996 -0.16972351\n -0.0324707  -0.02388763  0.14167023 -0.07146454]"}}, "num_steps_sampled": 498000, "num_steps_trained": 31680064, "last_target_update_ts": 498000, "num_target_updates": 495001}, "done": false, "episodes_total": 166, "training_iteration": 166, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-34-46", "timestamp": 1609824886, "time_this_iter_s": 56.83588266372681, "time_total_s": 8963.049959421158, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f8c8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 8963.049959421158, "timesteps_since_restore": 0, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 15.376543209876543, "ram_util_percent": 36.93333333333333}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 425.6771861343114, "episode_reward_mean": 1785.9877674098427, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2012.5532326210455, 1719.8255694957602, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.933143415525292, "mean_processing_ms": 1.32413618013793, "mean_inference_ms": 0.6829612742069423}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 501000, "timers": {"learn_time_ms": 4.078, "learn_throughput": 15694.584, "update_time_ms": 0.646}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -71.70623016357422, "critic_loss": 0.004267185460776091, "mean_q": 71.58547973632812, "max_q": 96.6895980834961, "min_q": 18.285247802734375, "mean_td_error": 0.06645634770393372, "td_error": "[ 0.16603088  0.10519409  0.16200256  0.07169342  0.15639496  0.07694244\n  0.26177216  0.13643646  0.08589935  0.05524445  0.06082916  0.0565567\n  0.05991364  0.09905243  0.11611176  0.00884247  0.00820923 -0.02159882\n  0.03069305  0.09458923  0.08382416  0.04973221 -0.10715485  0.13420868\n  0.03650665  0.0470047   0.08717346 -0.01751709  0.16973114  0.07789612\n  0.03435516  0.05519104 -0.00997162  0.08132935  0.07478714  0.08254433\n  0.1324768   0.03178406  0.04819107  0.09365082  0.04847336  0.04033661\n -0.01048279  0.0368576   0.1510849   0.08889771  0.05558777  0.0083313\n  0.00296783  0.02286911  0.13122559 -0.03604889  0.05725098  0.10010529\n  0.01229858  0.08041382  0.08391571  0.06429291  0.07702637  0.05056\n -0.00035095  0.1062355   0.10951233 -0.00470734]"}}, "num_steps_sampled": 501000, "num_steps_trained": 31872064, "last_target_update_ts": 501000, "num_target_updates": 498001}, "done": false, "episodes_total": 167, "training_iteration": 167, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-35-42", "timestamp": 1609824942, "time_this_iter_s": 56.5189745426178, "time_total_s": 9019.568933963776, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 9019.568933963776, "timesteps_since_restore": 0, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 13.327160493827163, "ram_util_percent": 36.99382716049383}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 425.6771861343114, "episode_reward_mean": 1787.8912443308395, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1910.1732615954527, 2455.5726822410534, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.933991259698913, "mean_processing_ms": 1.324237469524115, "mean_inference_ms": 0.683180235450234}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 504000, "timers": {"learn_time_ms": 4.259, "learn_throughput": 15026.615, "update_time_ms": 0.71}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -68.80554962158203, "critic_loss": 0.002852242672815919, "mean_q": 68.69385528564453, "max_q": 93.70263671875, "min_q": 21.527769088745117, "mean_td_error": -0.0013167858123779297, "td_error": "[ 0.09810257  0.10375977 -0.0170002   0.04610443 -0.05261993  0.01451111\n  0.04636002 -0.02471161  0.23163605 -0.02806473  0.00811005  0.09429169\n  0.02480316 -0.03375244  0.00235748  0.00452423 -0.02756882  0.05376434\n -0.06624603  0.00889587 -0.05566406 -0.13126373 -0.00567055 -0.07225037\n -0.03229904 -0.07916641 -0.00659943 -0.07926941 -0.01042938 -0.01843262\n  0.03909302 -0.01286316 -0.07978821 -0.05189514 -0.12020874 -0.00384521\n -0.13285065  0.02973175 -0.04366302 -0.01400757  0.08304596  0.05955887\n  0.06416321  0.06906128 -0.01322937  0.10320282 -0.10649872 -0.06147003\n -0.02645111  0.0146904   0.02077866  0.22120667 -0.04999542  0.02532959\n  0.09564209  0.00141144  0.04357147 -0.01441956 -0.05882263  0.01491547\n  0.0459671  -0.04975891 -0.09765625 -0.07443237]"}}, "num_steps_sampled": 504000, "num_steps_trained": 32064064, "last_target_update_ts": 504000, "num_target_updates": 501001}, "done": false, "episodes_total": 168, "training_iteration": 168, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-36-39", "timestamp": 1609824999, "time_this_iter_s": 56.84479522705078, "time_total_s": 9076.413729190826, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2d90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 9076.413729190826, "timesteps_since_restore": 0, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 13.116049382716048, "ram_util_percent": 37.0}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2650.1807029102674, "episode_reward_min": 425.6771861343114, "episode_reward_mean": 1779.1381360682333, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1580.2618559804143, 807.2561888298916, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.93480333250259, "mean_processing_ms": 1.3243420828524484, "mean_inference_ms": 0.6833993944958595}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 507000, "timers": {"learn_time_ms": 4.042, "learn_throughput": 15833.257, "update_time_ms": 0.75}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -67.16461181640625, "critic_loss": 0.0022893999703228474, "mean_q": 67.02722930908203, "max_q": 95.31603240966797, "min_q": 22.049114227294922, "mean_td_error": -6.565451622009277e-05, "td_error": "[ 0.01438141  0.06761932 -0.05017853 -0.15996552  0.10173035  0.02352905\n -0.00280762  0.099617   -0.0070076   0.01076508  0.0263443   0.03398132\n  0.03860092  0.11193085 -0.0386734   0.07696915 -0.01840973  0.05516815\n -0.0570755  -0.04768372 -0.06124115  0.00868607  0.01425171  0.07045364\n -0.01486206  0.00297546 -0.04756546  0.12426758 -0.02635956 -0.08565521\n -0.08773041  0.05898285  0.0021019  -0.06529999  0.14166641 -0.11483002\n -0.07036591 -0.09977722  0.05366516 -0.06512451  0.02441597 -0.01734924\n -0.01311111  0.02734375  0.01422119 -0.04219055 -0.18331146  0.06209564\n  0.00543213 -0.02449036 -0.01449585 -0.02387238 -0.01060104 -0.00156403\n  0.03157425 -0.01785278  0.0152626  -0.01390076  0.01166916  0.08594513\n -0.03507233  0.03240967  0.0204277   0.04573822]"}}, "num_steps_sampled": 507000, "num_steps_trained": 32256064, "last_target_update_ts": 507000, "num_target_updates": 504001}, "done": false, "episodes_total": 169, "training_iteration": 169, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-37-35", "timestamp": 1609825055, "time_this_iter_s": 55.81097173690796, "time_total_s": 9132.224700927734, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54dd08>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 9132.224700927734, "timesteps_since_restore": 0, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 13.393670886075949, "ram_util_percent": 37.0}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 425.6771861343114, "episode_reward_mean": 1798.071530995854, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2700.595681591929, 2340.31714759485, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.935633988968456, "mean_processing_ms": 1.324444070768412, "mean_inference_ms": 0.6836159906794506}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 510000, "timers": {"learn_time_ms": 4.661, "learn_throughput": 13729.801, "update_time_ms": 0.776}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -70.20317077636719, "critic_loss": 0.0017396805342286825, "mean_q": 70.06659698486328, "max_q": 95.46276092529297, "min_q": 29.602407455444336, "mean_td_error": -0.004429936408996582, "td_error": "[-0.07215118  0.01659393  0.06268311  0.00485992 -0.0269165  -0.03820419\n -0.04480743  0.17792511  0.04499817  0.01928711 -0.06004333 -0.01655197\n -0.0243454   0.05434418 -0.05713272 -0.09401321  0.00284576 -0.06887436\n -0.0118103  -0.08345795  0.02454376  0.01227951 -0.02994156  0.02040863\n -0.06367493  0.04221344  0.02251434  0.03281021  0.03321075  0.00500107\n -0.03624725 -0.01256561 -0.01757812 -0.06866455  0.05995178 -0.01351547\n  0.0788765   0.01565552  0.02433014 -0.10457993 -0.0590744   0.00811768\n -0.00675964 -0.06961823 -0.04785156  0.0311203  -0.0385437  -0.03038025\n -0.01295471 -0.09963989  0.05078125 -0.02017975  0.05186462  0.00331879\n -0.01552582  0.00141907 -0.04335022  0.04288864  0.07376099 -0.01922226\n  0.03541565  0.11528015 -0.07217407  0.02753448]"}}, "num_steps_sampled": 510000, "num_steps_trained": 32448064, "last_target_update_ts": 510000, "num_target_updates": 507001}, "done": false, "episodes_total": 170, "training_iteration": 170, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-38-32", "timestamp": 1609825112, "time_this_iter_s": 57.19684290885925, "time_total_s": 9189.421543836594, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d7b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 9189.421543836594, "timesteps_since_restore": 0, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 13.171951219512197, "ram_util_percent": 37.0}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 425.6771861343114, "episode_reward_mean": 1792.301629063031, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1763.3269543125884, 2364.899111061244, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.936431340244658, "mean_processing_ms": 1.3245477649288386, "mean_inference_ms": 0.6838289291894151}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 513000, "timers": {"learn_time_ms": 4.518, "learn_throughput": 14165.609, "update_time_ms": 0.746}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -68.99069213867188, "critic_loss": 0.002698271768167615, "mean_q": 68.85152435302734, "max_q": 94.76045989990234, "min_q": 15.677145957946777, "mean_td_error": 0.008868366479873657, "td_error": "[-0.02501678 -0.03963852 -0.10219574  0.00213623 -0.03263092  0.01899719\n  0.06519318 -0.03475189  0.03600693  0.2111206   0.00546265  0.05038452\n  0.02881622  0.04517746  0.07295227  0.05017853 -0.09081268 -0.01463699\n  0.03207397  0.00112915 -0.05528259  0.03388977 -0.00907898 -0.00634384\n  0.0282135  -0.09436035 -0.01083374  0.05069733  0.0389595   0.00234222\n -0.02752304  0.02116394 -0.10946655 -0.13745117  0.14363098  0.01587677\n -0.06112671  0.05924988  0.00952911  0.02865219 -0.01773071 -0.02945709\n  0.00933838 -0.029953    0.0226059   0.01688004  0.0022049   0.18044281\n -0.08539581 -0.05367279  0.0496521   0.04601288 -0.01476288  0.11611176\n -0.10262299  0.15357971 -0.0453949   0.04734039  0.06918716  0.06075668\n  0.0092392   0.1079216  -0.07426453 -0.07112694]"}}, "num_steps_sampled": 513000, "num_steps_trained": 32640064, "last_target_update_ts": 513000, "num_target_updates": 510001}, "done": false, "episodes_total": 171, "training_iteration": 171, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-39-28", "timestamp": 1609825168, "time_this_iter_s": 56.310548067092896, "time_total_s": 9245.732091903687, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d8c8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 9245.732091903687, "timesteps_since_restore": 0, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 13.05, "ram_util_percent": 37.02375000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 425.6771861343114, "episode_reward_mean": 1784.6240535859686, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1597.1415633550193, 1050.9200995658653, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.9371949505412935, "mean_processing_ms": 1.3246518681126978, "mean_inference_ms": 0.6840402703049144}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 516000, "timers": {"learn_time_ms": 4.198, "learn_throughput": 15245.345, "update_time_ms": 0.812}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -69.03055572509766, "critic_loss": 0.002672166097909212, "mean_q": 68.9063949584961, "max_q": 96.0985336303711, "min_q": 30.34962272644043, "mean_td_error": 0.02424338459968567, "td_error": "[-0.00370026  0.00306702  0.06008148  0.08343506  0.00487518 -0.05059814\n  0.00810242  0.15572357 -0.03573608  0.04432678  0.05970001  0.10350037\n  0.09403229  0.05076599  0.04624939 -0.00502014  0.07218933 -0.00846863\n -0.04045105  0.05628967  0.02169037  0.00062561 -0.01009369 -0.02553177\n  0.12242889 -0.03762054  0.07698059 -0.034832   -0.05187988 -0.05889511\n -0.03477478 -0.05713654  0.09714127 -0.03557587  0.03431702 -0.01488495\n -0.00442505 -0.11906433 -0.02774048  0.10259247  0.08763885  0.11862564\n  0.01361847  0.01795197 -0.09624481  0.09783936  0.09986115  0.07159424\n  0.00938416  0.11104584  0.04416656 -0.04171753 -0.02167511  0.0140419\n  0.00988579  0.07685852  0.05477905  0.03116608  0.23596191 -0.05070496\n  0.0124588   0.04585266 -0.04493332  0.01243591]"}}, "num_steps_sampled": 516000, "num_steps_trained": 32832064, "last_target_update_ts": 516000, "num_target_updates": 513001}, "done": false, "episodes_total": 172, "training_iteration": 172, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-40-25", "timestamp": 1609825225, "time_this_iter_s": 56.788140058517456, "time_total_s": 9302.520231962204, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d488>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 9302.520231962204, "timesteps_since_restore": 0, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 13.59012345679012, "ram_util_percent": 37.1}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 425.6771861343114, "episode_reward_mean": 1787.863262661245, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1374.8410070935004, 1924.0580330451016, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.9379685691825115, "mean_processing_ms": 1.324756519028, "mean_inference_ms": 0.6842544595633011}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 519000, "timers": {"learn_time_ms": 3.786, "learn_throughput": 16903.357, "update_time_ms": 0.689}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -67.36572265625, "critic_loss": 0.009029701352119446, "mean_q": 67.23784637451172, "max_q": 97.1835708618164, "min_q": 18.958097457885742, "mean_td_error": -0.011140108108520508, "td_error": "[-2.56347656e-03 -2.89535522e-03  7.14530945e-02  2.86788940e-02\n  5.44967651e-02 -1.07498169e-02  4.31442261e-02 -1.01509094e-02\n  1.74713135e-03  4.64096069e-02  1.29440308e-01 -4.80575562e-02\n  1.34223938e-01 -1.26693726e-01 -1.29470825e-02 -1.74713135e-02\n -5.87005615e-02 -9.54437256e-03 -1.26571655e-02 -2.62832642e-02\n  4.20837402e-02  2.14767456e-02 -8.66813660e-02  8.62121582e-04\n  3.90853882e-02 -1.05361938e-02 -9.06837463e-01 -4.87136841e-02\n -1.07055664e-01  6.89315796e-02 -3.61480713e-02 -1.55380249e-01\n  5.79109192e-02  7.84301758e-03 -9.86480713e-03  7.89947510e-02\n  6.09092712e-02 -2.23045349e-02 -1.26953125e-02  7.42492676e-02\n  5.68466187e-02  3.64913940e-02 -6.10694885e-02 -6.20498657e-02\n  9.76943970e-02  4.41513062e-02  4.49371338e-02  1.73225403e-02\n -6.86264038e-02 -1.35169983e-01 -4.27017212e-02  1.77581787e-01\n -4.64630127e-02  1.39404297e-01  4.17098999e-02 -4.19235229e-02\n -5.45425415e-02 -2.81867981e-02  7.38220215e-02 -7.97500610e-02\n -1.12007141e-01  8.21456909e-02 -1.50222778e-02 -4.57000732e-03]"}}, "num_steps_sampled": 519000, "num_steps_trained": 33024064, "last_target_update_ts": 519000, "num_target_updates": 516001}, "done": false, "episodes_total": 173, "training_iteration": 173, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-41-21", "timestamp": 1609825281, "time_this_iter_s": 56.05137777328491, "time_total_s": 9358.571609735489, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 9358.571609735489, "timesteps_since_restore": 0, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 13.18375, "ram_util_percent": 37.10000000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 425.6771861343114, "episode_reward_mean": 1783.6377772283863, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1501.5094897592573, 1790.6548269912294, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.938724773752231, "mean_processing_ms": 1.3248579287722344, "mean_inference_ms": 0.684470391597172}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 522000, "timers": {"learn_time_ms": 4.237, "learn_throughput": 15105.678, "update_time_ms": 0.716}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -69.95677185058594, "critic_loss": 0.011692923493683338, "mean_q": 69.8343505859375, "max_q": 97.40335845947266, "min_q": 25.235124588012695, "mean_td_error": -0.1245717704296112, "td_error": "[-0.17170715 -0.23378754 -0.00273132 -0.1665802  -0.15548706 -0.119133\n -0.18019867 -0.11907196 -0.12255096 -0.00959778 -0.06090546 -0.16844559\n -0.04231262 -0.11091614 -0.09632111 -0.1861     -0.07441139 -0.30110168\n -0.27694702 -0.21660614  0.01509094 -0.15963745 -0.17460632 -0.10224152\n  0.00642395 -0.08446503 -0.1084137  -0.08180237  0.04415131 -0.25437927\n -0.05706024 -0.14247131 -0.18655396 -0.15731049 -0.20705414 -0.21251678\n -0.05693817 -0.13632202 -0.07807922 -0.0555687  -0.11804199 -0.11667633\n -0.18184662 -0.21276855 -0.07920074 -0.22045135  0.0457077  -0.21723938\n -0.06402588 -0.28367996 -0.16531754 -0.03838921 -0.14955902 -0.12465668\n -0.12245178 -0.19918823  0.01899719 -0.0734787  -0.06441116 -0.299675\n  0.04648781 -0.15739441 -0.15912628 -0.03153992]"}}, "num_steps_sampled": 522000, "num_steps_trained": 33216064, "last_target_update_ts": 522000, "num_target_updates": 519001}, "done": false, "episodes_total": 174, "training_iteration": 174, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-42-17", "timestamp": 1609825337, "time_this_iter_s": 56.00468993186951, "time_total_s": 9414.576299667358, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 9414.576299667358, "timesteps_since_restore": 0, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 13.03125, "ram_util_percent": 37.10000000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 425.6771861343114, "episode_reward_mean": 1785.5968348072215, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1986.5605848747514, 2248.762304136957, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.9394827300829, "mean_processing_ms": 1.3249617601794301, "mean_inference_ms": 0.6846883279870801}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 525000, "timers": {"learn_time_ms": 4.017, "learn_throughput": 15930.793, "update_time_ms": 0.69}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -68.25646209716797, "critic_loss": 0.002344704931601882, "mean_q": 68.12940979003906, "max_q": 96.37708282470703, "min_q": 14.503471374511719, "mean_td_error": 0.014138638973236084, "td_error": "[ 0.01139069 -0.00814819 -0.10211945 -0.09368134  0.01131439  0.08898163\n  0.10819244  0.05591202  0.05053711 -0.04716492 -0.00286484  0.02885437\n -0.03705597  0.07015228  0.15995026  0.05385971 -0.05371857 -0.05232239\n  0.0199585   0.04785919  0.05962372  0.02160645 -0.01959991  0.09363174\n  0.13800049 -0.11602783  0.03904724  0.01324463  0.0071106  -0.07327652\n  0.06156158 -0.00431824 -0.05657578 -0.07539368  0.01779556  0.07516861\n  0.1342392  -0.0344696   0.07878876  0.05005646  0.03116608  0.01385117\n -0.02916336 -0.06664276 -0.0331955   0.10055542 -0.0340271   0.09379196\n  0.03658676 -0.03182983 -0.10614777  0.0483551   0.00921631  0.02631378\n  0.01434326  0.10835648 -0.01733398 -0.02929688 -0.03812408  0.00219727\n  0.07009888  0.03089142 -0.01620483  0.00101471]"}}, "num_steps_sampled": 525000, "num_steps_trained": 33408064, "last_target_update_ts": 525000, "num_target_updates": 522001}, "done": false, "episodes_total": 175, "training_iteration": 175, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-43-14", "timestamp": 1609825394, "time_this_iter_s": 57.00039052963257, "time_total_s": 9471.576690196991, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54dea0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 9471.576690196991, "timesteps_since_restore": 0, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 13.71341463414634, "ram_util_percent": 37.1}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 425.6771861343114, "episode_reward_mean": 1784.8585924104962, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2174.9380644644257, 1500.539320937984, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.940221183580482, "mean_processing_ms": 1.3250680269655624, "mean_inference_ms": 0.6849056224207922}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 528000, "timers": {"learn_time_ms": 4.436, "learn_throughput": 14427.515, "update_time_ms": 0.681}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -64.70919799804688, "critic_loss": 0.0075723701156675816, "mean_q": 64.59288024902344, "max_q": 95.81843566894531, "min_q": 16.527624130249023, "mean_td_error": -0.10377240180969238, "td_error": "[ 0.04342651 -0.05805969 -0.16324615 -0.10460663 -0.12588501 -0.16391373\n -0.06645203 -0.10752106 -0.00575256 -0.13911438 -0.14417267 -0.0409584\n -0.1044693   0.02037048 -0.12885284 -0.10342789 -0.19055939 -0.19055176\n -0.06151581 -0.1228714  -0.12136841 -0.17160034 -0.1559143  -0.07533646\n -0.09069061 -0.09951782 -0.09263992 -0.29418945 -0.08001709 -0.09893036\n -0.08271027 -0.06477356 -0.08716583 -0.15789413 -0.11909485 -0.14248466\n -0.10015106 -0.1231041  -0.09365845 -0.10463715 -0.11335754 -0.12037659\n -0.08555984 -0.12427902  0.0247345  -0.20389557 -0.20256042 -0.10173798\n -0.09815979 -0.19742966 -0.03760147 -0.03199768 -0.02933502 -0.02852631\n -0.02963257 -0.1958847  -0.13105965 -0.04613113 -0.03351593 -0.03096771\n -0.11233521 -0.10262299 -0.16644287 -0.12874603]"}}, "num_steps_sampled": 528000, "num_steps_trained": 33600064, "last_target_update_ts": 528000, "num_target_updates": 525001}, "done": false, "episodes_total": 176, "training_iteration": 176, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-44-10", "timestamp": 1609825450, "time_this_iter_s": 56.08377933502197, "time_total_s": 9527.660469532013, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54df28>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 9527.660469532013, "timesteps_since_restore": 0, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 13.455000000000002, "ram_util_percent": 37.1075}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 425.6771861343114, "episode_reward_mean": 1791.4345518829741, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2158.1352681857556, 1511.3758327733265, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.9409645792595835, "mean_processing_ms": 1.3251709630213802, "mean_inference_ms": 0.6851247958370452}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 531000, "timers": {"learn_time_ms": 3.93, "learn_throughput": 16283.816, "update_time_ms": 0.732}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -71.46235656738281, "critic_loss": 0.024780690670013428, "mean_q": 71.33112335205078, "max_q": 96.95580291748047, "min_q": 15.501697540283203, "mean_td_error": -0.2100895643234253, "td_error": "[-0.09647751 -0.21569061 -0.35281372 -0.09488297 -0.17089844 -0.249012\n -0.04095459 -0.29660034 -0.18036652 -0.31233215 -0.2849579  -0.19767761\n -0.17707825 -0.11613464 -0.17037201 -0.09270477 -0.2341423  -0.2513199\n -0.15065002 -0.17098236 -0.23296356 -0.2364769  -0.34301758 -0.2590561\n -0.16478729 -0.37486267 -0.2585144  -0.18743134 -0.2337265  -0.23434448\n -0.29642487 -0.28618622 -0.21658325 -0.13856506 -0.08880615 -0.11690903\n -0.14590073 -0.21876335 -0.26058197 -0.21543121 -0.15987396 -0.2603035\n -0.29750824 -0.20735931 -0.17461395 -0.23622894 -0.22520828 -0.12373352\n -0.17604065 -0.21422958 -0.26626587 -0.204216   -0.14640045 -0.1348896\n -0.17754364 -0.30387878 -0.1583023  -0.17952728 -0.21212769 -0.2357254\n -0.2600479  -0.20852661 -0.31410217 -0.2036972 ]"}}, "num_steps_sampled": 531000, "num_steps_trained": 33792064, "last_target_update_ts": 531000, "num_target_updates": 528001}, "done": false, "episodes_total": 177, "training_iteration": 177, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-45-08", "timestamp": 1609825508, "time_this_iter_s": 57.11429166793823, "time_total_s": 9584.774761199951, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 9584.774761199951, "timesteps_since_restore": 0, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 13.451851851851854, "ram_util_percent": 37.19999999999999}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 425.6771861343114, "episode_reward_mean": 1790.4479114024898, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1412.7117847248792, 2556.9146445861616, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.941706323171266, "mean_processing_ms": 1.3252755530751512, "mean_inference_ms": 0.6853444345600346}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 534000, "timers": {"learn_time_ms": 4.441, "learn_throughput": 14411.481, "update_time_ms": 0.616}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -69.98155212402344, "critic_loss": 0.10909199714660645, "mean_q": 69.9030532836914, "max_q": 95.76992797851562, "min_q": 23.343475341796875, "mean_td_error": -0.4546695053577423, "td_error": "[-0.48233795 -0.3971367  -0.4071579  -0.63477325 -0.64544296 -0.46667862\n -0.46909714 -0.25415802 -0.55602264 -0.44768906 -0.26081085 -0.4799118\n -0.54515076 -0.34438324 -0.38988495 -0.4154129  -0.46369934 -0.46909332\n -0.46031952 -0.48565674 -0.5093918  -0.48320007 -0.3999939  -0.49814224\n -0.28244781 -0.2990799  -0.55565643 -0.41915894 -0.4529953  -0.45648956\n -0.44866943 -0.52085876 -0.59171295 -0.23995972 -0.42448044 -0.45758057\n -0.45877838 -0.54956055 -0.45526886 -0.39064026 -0.53432465 -0.45555878\n -0.574173   -0.43766403 -0.5650711  -0.44230652 -0.6224098  -0.4609375\n -0.6148758  -0.3416977  -0.40611267 -0.45923996 -0.5051689  -0.57429504\n -0.5174103  -0.45410538 -0.46587944 -0.61415863 -0.32289886 -0.4064827\n -0.27225494 -0.46069717 -0.09114075 -0.5311012 ]"}}, "num_steps_sampled": 534000, "num_steps_trained": 33984064, "last_target_update_ts": 534000, "num_target_updates": 531001}, "done": false, "episodes_total": 178, "training_iteration": 178, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-46-04", "timestamp": 1609825564, "time_this_iter_s": 56.21146011352539, "time_total_s": 9640.986221313477, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2598>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 9640.986221313477, "timesteps_since_restore": 0, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 14.1875, "ram_util_percent": 37.17999999999999}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 425.6771861343114, "episode_reward_mean": 1788.6855397593713, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2380.6774802743266, 2124.745977564283, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.94241492984211, "mean_processing_ms": 1.3253818332404526, "mean_inference_ms": 0.6855623443075162}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 537000, "timers": {"learn_time_ms": 4.262, "learn_throughput": 15016.948, "update_time_ms": 0.639}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -68.68038940429688, "critic_loss": 0.014382284134626389, "mean_q": 68.53154754638672, "max_q": 98.43655395507812, "min_q": 18.751859664916992, "mean_td_error": 0.1508278250694275, "td_error": "[0.14329529 0.2684803  0.22033691 0.19668579 0.10907745 0.11933136\n 0.26996422 0.16659927 0.13899231 0.12407684 0.20726013 0.0822258\n 0.14799881 0.09877777 0.24573517 0.09101868 0.18214798 0.29745483\n 0.25585175 0.11014938 0.139328   0.25504303 0.09636688 0.01189804\n 0.2117157  0.07608795 0.10635757 0.07312012 0.18870544 0.15579987\n 0.1504631  0.06528473 0.24843597 0.1417923  0.15618134 0.26213074\n 0.1362648  0.1359024  0.1038208  0.12100983 0.04025269 0.17076111\n 0.09185028 0.36655426 0.18295288 0.12511444 0.10990524 0.064785\n 0.1764412  0.30021286 0.06919098 0.15295792 0.08753967 0.22089386\n 0.1466484  0.09188843 0.19611359 0.21967316 0.14014435 0.04505157\n 0.14792633 0.08670044 0.0830307  0.02522278]"}}, "num_steps_sampled": 537000, "num_steps_trained": 34176064, "last_target_update_ts": 537000, "num_target_updates": 534001}, "done": false, "episodes_total": 179, "training_iteration": 179, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-47-01", "timestamp": 1609825621, "time_this_iter_s": 56.636027097702026, "time_total_s": 9697.622248411179, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2c80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 9697.622248411179, "timesteps_since_restore": 0, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 13.202469135802467, "ram_util_percent": 37.2074074074074}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 425.6771861343114, "episode_reward_mean": 1785.1160251103172, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1767.7945126588838, 1545.607248995561, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.943111263443881, "mean_processing_ms": 1.3254908260386637, "mean_inference_ms": 0.6857805234375026}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 540000, "timers": {"learn_time_ms": 4.247, "learn_throughput": 15068.707, "update_time_ms": 0.734}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -71.89988708496094, "critic_loss": 0.0023021106608211994, "mean_q": 71.79302978515625, "max_q": 96.00438690185547, "min_q": 21.69071388244629, "mean_td_error": 0.00885668396949768, "td_error": "[ 0.04933167  0.04789734 -0.01863861  0.08447266  0.05741882  0.07059479\n -0.04019928 -0.01639938 -0.04084778 -0.1566925   0.06760406  0.03669739\n -0.02702713  0.0143013  -0.09122086  0.03177643 -0.06784058  0.00735664\n -0.0012207  -0.02755737 -0.04303169  0.15245056 -0.02345276  0.03811646\n -0.08535004  0.04444504  0.02698517  0.06504059  0.11418915  0.01600647\n  0.02435303 -0.01346588 -0.06978607 -0.08946991  0.01088333  0.05635452\n  0.0194931  -0.05735397 -0.07003021  0.02954865  0.03574371 -0.04060364\n  0.04003906  0.10558701  0.01776886  0.02853394 -0.00259399 -0.04564667\n  0.00234604  0.21588898  0.12224579 -0.03116417 -0.0247879   0.07028961\n  0.01789856  0.0337677   0.04390717 -0.02068329 -0.0404129  -0.03269196\n -0.02153015  0.00998688 -0.06393433  0.02114105]"}}, "num_steps_sampled": 540000, "num_steps_trained": 34368064, "last_target_update_ts": 540000, "num_target_updates": 537001}, "done": false, "episodes_total": 180, "training_iteration": 180, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-47-56", "timestamp": 1609825676, "time_this_iter_s": 55.68362784385681, "time_total_s": 9753.305876255035, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a28c8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 9753.305876255035, "timesteps_since_restore": 0, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 13.37721518987342, "ram_util_percent": 37.23291139240508}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 425.6771861343114, "episode_reward_mean": 1792.05893374424, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2239.8981123878475, 845.5381408817311, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.943811827755301, "mean_processing_ms": 1.3256023911424168, "mean_inference_ms": 0.6859998923370105}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 543000, "timers": {"learn_time_ms": 3.836, "learn_throughput": 16685.757, "update_time_ms": 0.773}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -71.19234466552734, "critic_loss": 0.008869648911058903, "mean_q": 71.08740234375, "max_q": 95.78863525390625, "min_q": 15.87454605102539, "mean_td_error": -0.036792367696762085, "td_error": "[ 0.14087677  0.27186584 -0.03076172 -0.02110672 -0.0871048  -0.1781559\n -0.00631714  0.02662277 -0.05867004  0.05183411  0.00804138 -0.0170517\n -0.0229187  -0.02477264 -0.02455902 -0.07291412 -0.01276398  0.01728821\n  0.05426025  0.00851059 -0.00600433  0.04639435 -0.02964401  0.0419693\n -0.04380798 -0.05861664 -0.01304626 -0.02536392 -0.05475616 -0.02910614\n -0.04282379  0.01961517 -0.03079224 -0.0318222  -0.09483337 -0.06833649\n -0.06255341 -0.08944702  0.00329208  0.06671143 -0.090065   -0.0352478\n  0.1398468  -0.03258514 -0.8593521  -0.0161705  -0.11483765 -0.01568604\n -0.13959122 -0.03213501 -0.02011108 -0.05937958 -0.02313232 -0.0538826\n  0.07687378 -0.08401489 -0.01150513 -0.03820038  0.0056839  -0.00294495\n -0.07222748 -0.19824982 -0.11539459 -0.08163452]"}}, "num_steps_sampled": 543000, "num_steps_trained": 34560064, "last_target_update_ts": 543000, "num_target_updates": 540001}, "done": false, "episodes_total": 181, "training_iteration": 181, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-48-54", "timestamp": 1609825734, "time_this_iter_s": 57.243643045425415, "time_total_s": 9810.54951930046, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f048>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 9810.54951930046, "timesteps_since_restore": 0, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 13.221951219512196, "ram_util_percent": 37.30000000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 425.6771861343114, "episode_reward_mean": 1799.434088691062, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1583.0536355639692, 1573.8400685400861, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.94452545186718, "mean_processing_ms": 1.3257151116085892, "mean_inference_ms": 0.686219981243533}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 546000, "timers": {"learn_time_ms": 3.872, "learn_throughput": 16528.259, "update_time_ms": 0.641}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -69.64712524414062, "critic_loss": 0.005296706221997738, "mean_q": 69.53034973144531, "max_q": 94.77283477783203, "min_q": 17.872114181518555, "mean_td_error": 0.05533802509307861, "td_error": "[-0.04193115  0.06749725 -0.00358582  0.2154007   0.02478027 -0.11782074\n  0.09197235 -0.02726364  0.01422882 -0.07826233  0.05334473 -0.00301361\n  0.07619858  0.09174347 -0.04217529 -0.02294922  0.08393097  0.05306244\n  0.2413559   0.06673431  0.12118149  0.10595703  0.08866501 -0.03460693\n -0.04323578  0.06509399  0.06187439  0.06757355  0.16156769  0.04414368\n  0.01393127  0.07194138 -0.01622772  0.00642395  0.10424805  0.01696777\n -0.03974152 -0.01600647  0.11491776  0.06169891 -0.08498383  0.1721077\n  0.02365112 -0.04452515  0.02146149  0.06235123  0.22936249  0.04618073\n  0.08563614  0.11610413  0.04122925  0.08283615 -0.00939178  0.19641495\n  0.10276794  0.2971344   0.03327179 -0.03549194  0.11355591  0.08618927\n  0.0489502  -0.04927444  0.20491028  0.10157013]"}}, "num_steps_sampled": 546000, "num_steps_trained": 34752064, "last_target_update_ts": 546000, "num_target_updates": 543001}, "done": false, "episodes_total": 182, "training_iteration": 182, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-49-50", "timestamp": 1609825790, "time_this_iter_s": 56.50180220603943, "time_total_s": 9867.0513215065, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f598>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 9867.0513215065, "timesteps_since_restore": 0, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 13.6, "ram_util_percent": 37.30000000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 425.6771861343114, "episode_reward_mean": 1796.6422943019213, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1294.6606296259556, 1150.003801905576, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.945241303413172, "mean_processing_ms": 1.3258274799630378, "mean_inference_ms": 0.6864413777757828}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 549000, "timers": {"learn_time_ms": 4.361, "learn_throughput": 14676.223, "update_time_ms": 0.716}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -71.75262451171875, "critic_loss": 0.005690478719770908, "mean_q": 71.6282730102539, "max_q": 95.97705841064453, "min_q": 18.274660110473633, "mean_td_error": -0.06312975287437439, "td_error": "[-0.09011078 -0.06956482  0.07025909  0.06017685  0.01087952 -0.02095032\n -0.07447052 -0.07253265 -0.0309906  -0.18949127 -0.12989044 -0.03919983\n -0.23661041 -0.08651733 -0.07634354 -0.05895996  0.01178741 -0.04831696\n -0.05445099  0.0615387   0.0371933   0.02371979 -0.18440247  0.08500671\n -0.13817978 -0.14796448  0.09049988 -0.01480865 -0.09881592 -0.06274414\n  0.03808594 -0.09056091 -0.10509491 -0.1128006   0.05158997 -0.08988953\n  0.04342651 -0.12961578 -0.04904175 -0.21492004 -0.12271881 -0.04702759\n -0.17325592 -0.06110382 -0.08101654  0.00396729 -0.18443298  0.02303314\n -0.13417053  0.07144165 -0.01016235  0.05206299 -0.11153412 -0.12356567\n -0.1169281  -0.061409   -0.04359818  0.0100708  -0.22768784 -0.07931519\n -0.0479126  -0.09372711 -0.18960571 -0.15863228]"}}, "num_steps_sampled": 549000, "num_steps_trained": 34944064, "last_target_update_ts": 549000, "num_target_updates": 546001}, "done": false, "episodes_total": 183, "training_iteration": 183, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-50-47", "timestamp": 1609825847, "time_this_iter_s": 56.626147985458374, "time_total_s": 9923.677469491959, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2598>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 9923.677469491959, "timesteps_since_restore": 0, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 15.158024691358024, "ram_util_percent": 37.30000000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 425.6771861343114, "episode_reward_mean": 1798.489111683458, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1334.685540059263, 2071.2826064721016, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.945952507863188, "mean_processing_ms": 1.325934827038113, "mean_inference_ms": 0.6866635304577885}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 552000, "timers": {"learn_time_ms": 4.061, "learn_throughput": 15758.156, "update_time_ms": 0.711}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -66.95121002197266, "critic_loss": 0.0031415841076523066, "mean_q": 66.82888793945312, "max_q": 96.49516296386719, "min_q": 24.57083511352539, "mean_td_error": 0.03088212013244629, "td_error": "[ 0.02706909 -0.03432465  0.07558441 -0.0031929  -0.03594971  0.00927734\n -0.01893616  0.01815796  0.04025269 -0.01185989  0.04828644  0.07209206\n -0.09925842  0.10059357  0.00151825 -0.05605316  0.13047028  0.00379944\n -0.02523041  0.08389282  0.05168152  0.04302979  0.00109482  0.08080292\n  0.00229645  0.10289001  0.00382996  0.03778076  0.12688446 -0.06122208\n -0.02197266  0.18315125  0.04079056  0.10744476  0.0881691   0.03347778\n  0.01328659  0.04721832  0.1359787   0.03992462  0.07062149  0.01054382\n  0.02339554  0.02741241  0.00954056  0.09446716  0.01280975 -0.03143311\n  0.00113678  0.03297424 -0.07827759  0.07681847 -0.00617218 -0.01765442\n  0.02903748  0.08764648  0.34239197 -0.01919556 -0.043396    0.03343201\n -0.00675201  0.01496124 -0.09343719  0.02285767]"}}, "num_steps_sampled": 552000, "num_steps_trained": 35136064, "last_target_update_ts": 552000, "num_target_updates": 549001}, "done": false, "episodes_total": 184, "training_iteration": 184, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-51-43", "timestamp": 1609825903, "time_this_iter_s": 55.96927738189697, "time_total_s": 9979.646746873856, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2400>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 9979.646746873856, "timesteps_since_restore": 0, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 13.52405063291139, "ram_util_percent": 36.712658227848095}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 425.6771861343114, "episode_reward_mean": 1797.601962566143, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1982.56769474058, 425.6771861343114, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.946646801164612, "mean_processing_ms": 1.326045553632235, "mean_inference_ms": 0.6868864234955937}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 555000, "timers": {"learn_time_ms": 3.736, "learn_throughput": 17132.392, "update_time_ms": 0.645}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -67.99890899658203, "critic_loss": 0.009439469315111637, "mean_q": 67.88128662109375, "max_q": 91.83851623535156, "min_q": 23.6639404296875, "mean_td_error": -0.014530777931213379, "td_error": "[-5.2642822e-02 -3.9474487e-02 -6.1714172e-02  4.5642853e-02\n -3.0929565e-02 -1.1177826e-01  9.3933105e-02 -3.6880493e-02\n -2.6201630e-01 -3.7673950e-02  4.1755676e-02 -1.5433502e-01\n  1.2049866e-01  2.9071808e-02  9.1331482e-02  9.9502563e-02\n -9.2975616e-01  1.1062622e-04  3.2802582e-02 -3.8513184e-02\n  4.4639587e-02 -7.5347900e-02 -1.6288757e-02  1.8562317e-02\n -4.7222137e-02 -7.3005676e-02  6.5246582e-02 -4.7096252e-02\n -8.0299377e-03  7.4333191e-02  7.4340820e-02  2.6073456e-02\n  1.8287659e-02  6.0192108e-02 -4.9591064e-04  7.7476501e-02\n  3.5289764e-02  2.9670715e-02 -1.9676208e-02  1.1186981e-01\n  3.4996033e-02  4.2030334e-02 -1.6883850e-02  2.8984070e-02\n  6.4582825e-02 -3.7101746e-02  3.0174255e-02 -3.4767151e-02\n -3.6697388e-02 -4.1755676e-02  7.2639465e-02 -6.1420441e-02\n -1.8966675e-02 -1.1402130e-01  2.4814606e-02  8.5983276e-02\n -2.2933960e-02  1.5285492e-02  2.4757385e-02 -9.4894409e-02\n  6.6596985e-02 -9.7686768e-02 -4.2037964e-02  5.0598145e-02]"}}, "num_steps_sampled": 555000, "num_steps_trained": 35328064, "last_target_update_ts": 555000, "num_target_updates": 552001}, "done": false, "episodes_total": 185, "training_iteration": 185, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-52-40", "timestamp": 1609825960, "time_this_iter_s": 57.50232672691345, "time_total_s": 10037.149073600769, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2d08>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 10037.149073600769, "timesteps_since_restore": 0, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 16.589024390243903, "ram_util_percent": 37.65487804878049}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 555.0377397457366, "episode_reward_mean": 1817.0100842308657, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2366.4893526065944, 555.0377397457366, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.947380943090647, "mean_processing_ms": 1.3261502762381658, "mean_inference_ms": 0.6871091874034763}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 558000, "timers": {"learn_time_ms": 4.247, "learn_throughput": 15070.907, "update_time_ms": 0.693}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -68.57227325439453, "critic_loss": 0.0024955698754638433, "mean_q": 68.46821594238281, "max_q": 96.04072570800781, "min_q": 25.09648895263672, "mean_td_error": 0.006983906030654907, "td_error": "[-0.0341568   0.08110428  0.08066559  0.0936203   0.06408691 -0.03149033\n -0.04055023  0.02622223 -0.00621796  0.0044899   0.04626846 -0.1240387\n -0.0477066   0.00150299  0.03970337  0.15400696  0.0435257  -0.0002594\n  0.04564667 -0.0363884   0.08905029  0.05005646 -0.03502274 -0.09068298\n  0.06084824  0.00180054  0.04545593  0.02899933  0.05767059 -0.08440399\n -0.02557373  0.18330383  0.03484344 -0.00766945 -0.07278061  0.01668549\n -0.02331543  0.1607132  -0.00469208 -0.05535126  0.02242279 -0.11909485\n -0.02470398 -0.06250763  0.03573227  0.03703308  0.03386307 -0.1155014\n  0.0879364   0.01557922  0.02874374 -0.08304977  0.04071426 -0.05558014\n -0.02984619  0.12742615 -0.0296402  -0.07567596 -0.03678894 -0.02409363\n -0.00608826 -0.05042267  0.0200119   0.0205307 ]"}}, "num_steps_sampled": 558000, "num_steps_trained": 35520064, "last_target_update_ts": 558000, "num_target_updates": 555001}, "done": false, "episodes_total": 186, "training_iteration": 186, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-53-37", "timestamp": 1609826017, "time_this_iter_s": 57.04446482658386, "time_total_s": 10094.193538427353, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d1e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 10094.193538427353, "timesteps_since_restore": 0, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 12.948780487804877, "ram_util_percent": 38.19999999999999}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1837.6999493712915, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2624.0242537882987, 1763.4357709403312, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.948152132369904, "mean_processing_ms": 1.3262542195354345, "mean_inference_ms": 0.6873303795690585}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 561000, "timers": {"learn_time_ms": 4.529, "learn_throughput": 14130.934, "update_time_ms": 0.647}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -73.64069366455078, "critic_loss": 0.0036000641994178295, "mean_q": 73.54792785644531, "max_q": 96.82438659667969, "min_q": 43.24123001098633, "mean_td_error": -0.022247612476348877, "td_error": "[ 0.01843262 -0.0213623   0.00350952 -0.12271118 -0.16636658 -0.07037354\n -0.03603745 -0.01199341 -0.0016861   0.00814056  0.00703049 -0.0802002\n  0.34064865 -0.04903412 -0.10324097 -0.12159729 -0.03827667 -0.10124969\n  0.03695679  0.07232285 -0.08452606  0.06949615 -0.07584381 -0.0146637\n -0.05400085 -0.08128357 -0.01177216 -0.13378143  0.01705551 -0.06890106\n -0.10668182 -0.11100769  0.00035858 -0.05345917  0.01354599  0.02329254\n  0.07429886 -0.04067993 -0.05056     0.0311203   0.01532745  0.00663757\n  0.05042267  0.04618835 -0.08924103 -0.02986908  0.04039764 -0.10450745\n -0.01280975 -0.14726257 -0.0446434   0.05457306 -0.06473923 -0.02679062\n -0.01236343  0.07312012 -0.11143494  0.0761261   0.04813385  0.01531982\n -0.00646973 -0.02072144  0.05805969 -0.14221954]"}}, "num_steps_sampled": 561000, "num_steps_trained": 35712064, "last_target_update_ts": 561000, "num_target_updates": 558001}, "done": false, "episodes_total": 187, "training_iteration": 187, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-54-34", "timestamp": 1609826074, "time_this_iter_s": 57.002124547958374, "time_total_s": 10151.195662975311, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d268>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 10151.195662975311, "timesteps_since_restore": 0, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 13.144444444444446, "ram_util_percent": 38.24444444444445}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1835.0450518357557, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1497.9460173867494, 1514.66429201293, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.948913717161019, "mean_processing_ms": 1.3263549218120694, "mean_inference_ms": 0.6875507102437217}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 564000, "timers": {"learn_time_ms": 3.978, "learn_throughput": 16089.009, "update_time_ms": 0.73}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -70.83119201660156, "critic_loss": 0.006650562863796949, "mean_q": 70.71345520019531, "max_q": 96.73768615722656, "min_q": 32.78547286987305, "mean_td_error": -0.06456261873245239, "td_error": "[-0.133564   -0.03591919 -0.01564407 -0.04567719 -0.1557312   0.02495575\n -0.12098694 -0.16759491 -0.01478577 -0.00861359 -0.02799225 -0.05388641\n -0.13954163 -0.06022644 -0.23714447 -0.12043762 -0.12708664 -0.01506805\n  0.04718018  0.18904877 -0.02501678 -0.23531342  0.02347183 -0.23583221\n -0.03045654  0.06700516  0.02131653 -0.06929779 -0.1548233   0.01721954\n -0.14167786 -0.08827209 -0.07860947 -0.10626221 -0.13459778 -0.1591034\n  0.0619812   0.00601196 -0.07383728 -0.08531952 -0.16055298 -0.00546265\n -0.1739502  -0.03682327  0.05672455 -0.08877563 -0.1700592   0.02955627\n  0.17371368 -0.17584991  0.00333786 -0.02435303 -0.07975006 -0.04785919\n -0.19860077 -0.01857376 -0.17237854  0.02043152 -0.22252655  0.05917358\n -0.04796219 -0.02822113 -0.07057953 -0.11253738]"}}, "num_steps_sampled": 564000, "num_steps_trained": 35904064, "last_target_update_ts": 564000, "num_target_updates": 561001}, "done": false, "episodes_total": 188, "training_iteration": 188, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-55-30", "timestamp": 1609826130, "time_this_iter_s": 55.93001437187195, "time_total_s": 10207.125677347183, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 10207.125677347183, "timesteps_since_restore": 0, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 13.1, "ram_util_percent": 38.2025}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1841.4353278471663, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2153.691893154037, 2096.213057819302, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.949680296067402, "mean_processing_ms": 1.3264558467914316, "mean_inference_ms": 0.6877706889538957}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 567000, "timers": {"learn_time_ms": 3.955, "learn_throughput": 16181.046, "update_time_ms": 0.708}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -71.00506591796875, "critic_loss": 0.003962079994380474, "mean_q": 70.9239273071289, "max_q": 93.6729736328125, "min_q": 32.56739807128906, "mean_td_error": 0.06247079372406006, "td_error": "[ 0.13137817  0.05393982  0.08575439  0.08205795  0.07154083  0.1054306\n  0.02018738  0.15562439 -0.02501678  0.0979805  -0.03305817  0.00962067\n  0.07443619  0.02235413  0.03277588  0.05141068  0.22148132  0.06558228\n  0.08917236  0.01280975  0.09922028 -0.0358963   0.09734344  0.09183502\n  0.02240753  0.02614594  0.09937286  0.01722717  0.08634949  0.08813477\n  0.04020691  0.09861755  0.03472137 -0.07555008  0.03966904  0.10646057\n -0.07218933  0.05340576  0.05342865 -0.03269958  0.0555954   0.04768753\n  0.12698364  0.11795425  0.07765961  0.0327301   0.026474    0.13263702\n  0.15956879  0.04670334  0.06716156  0.05531693 -0.0030899   0.0730896\n  0.07848358 -0.00089264  0.05548096  0.03423691  0.10014343 -0.01880646\n  0.17068481  0.10927582  0.13317871  0.15620041]"}}, "num_steps_sampled": 567000, "num_steps_trained": 36096064, "last_target_update_ts": 567000, "num_target_updates": 564001}, "done": false, "episodes_total": 189, "training_iteration": 189, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-56-27", "timestamp": 1609826187, "time_this_iter_s": 56.96611046791077, "time_total_s": 10264.091787815094, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 10264.091787815094, "timesteps_since_restore": 0, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 13.090123456790122, "ram_util_percent": 38.22962962962962}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1835.4870092554247, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1501.3811986451758, 1732.6413567921957, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.950425496651345, "mean_processing_ms": 1.3265551986965227, "mean_inference_ms": 0.6879908480167505}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 570000, "timers": {"learn_time_ms": 3.88, "learn_throughput": 16495.757, "update_time_ms": 0.667}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -68.79127502441406, "critic_loss": 0.006155496463179588, "mean_q": 68.65345764160156, "max_q": 98.11052703857422, "min_q": 34.118587493896484, "mean_td_error": 0.07632237672805786, "td_error": "[ 0.08498383  0.13743591  0.04584503  0.19807434  0.13143921  0.18467712\n  0.06529999 -0.0134964   0.04399872  0.04290771  0.11434937  0.12985992\n  0.02004242 -0.08987045  0.03038788  0.10596466  0.06758881  0.03985596\n  0.05323029  0.02565002  0.01767731 -0.06497955  0.19892883  0.11687469\n  0.06103134  0.03947449  0.27959824  0.01992035  0.20119095  0.09105682\n -0.00216675  0.11958313  0.10140228 -0.05848694 -0.00273895  0.13211823\n  0.1060257   0.09309387  0.06195831  0.10319138  0.13470459  0.09649277\n -0.01931     0.17175293  0.17050934  0.05488968 -0.04486847  0.02523041\n -0.10208893  0.02567291  0.11576843 -0.02445221  0.09479523  0.1482544\n  0.07680511  0.11354065  0.02642822  0.06676865  0.01198196  0.10503006\n  0.0621376   0.18981934  0.16875839  0.18303299]"}}, "num_steps_sampled": 570000, "num_steps_trained": 36288064, "last_target_update_ts": 570000, "num_target_updates": 567001}, "done": false, "episodes_total": 190, "training_iteration": 190, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-57-23", "timestamp": 1609826243, "time_this_iter_s": 55.67683243751526, "time_total_s": 10319.76862025261, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2ae8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 10319.76862025261, "timesteps_since_restore": 0, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 12.805000000000001, "ram_util_percent": 38.24250000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1839.6700866876347, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2150.9491000131643, 964.4313671783724, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.951173174589814, "mean_processing_ms": 1.3266555654637495, "mean_inference_ms": 0.6882132626931953}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 573000, "timers": {"learn_time_ms": 3.701, "learn_throughput": 17291.308, "update_time_ms": 0.682}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -70.57660675048828, "critic_loss": 0.0026434832252562046, "mean_q": 70.46574401855469, "max_q": 95.11846160888672, "min_q": 38.325740814208984, "mean_td_error": 0.011596977710723877, "td_error": "[-1.80053711e-03  6.97326660e-03  5.83648682e-03 -1.83486938e-02\n  6.34536743e-02  2.92968750e-03  1.46713257e-02  6.45751953e-02\n -8.56094360e-02  8.85772705e-02  5.92651367e-02  1.72767639e-02\n -7.97119141e-02 -2.39334106e-02  1.63848877e-01 -4.58908081e-03\n  6.00738525e-02  7.35397339e-02 -3.39775085e-02  3.21998596e-02\n -5.20935059e-02  4.69703674e-02 -4.37698364e-02  2.77023315e-02\n -3.09524536e-02 -1.16943359e-01 -6.96487427e-02 -2.66876221e-02\n -3.00827026e-02  1.03065491e-01 -1.09092712e-01  1.06582642e-01\n -7.13653564e-02  5.50079346e-02 -1.79443359e-02  1.61285400e-02\n -6.29653931e-02  2.46124268e-02  7.46688843e-02  1.10893250e-01\n  1.82723999e-02 -3.15780640e-02 -2.77328491e-02  5.39245605e-02\n  4.32128906e-02 -1.80931091e-02  1.06575012e-01 -2.12860107e-03\n -1.17866516e-01 -3.04336548e-02 -2.22244263e-02  3.69949341e-02\n  2.75878906e-02  1.10626221e-04  5.81741333e-02  5.69915771e-03\n  7.98568726e-02 -4.90608215e-02 -1.94473267e-02  2.47474670e-01\n  5.38482666e-02 -8.44726562e-02  8.07685852e-02 -6.59179688e-03]"}}, "num_steps_sampled": 573000, "num_steps_trained": 36480064, "last_target_update_ts": 573000, "num_target_updates": 570001}, "done": false, "episodes_total": 191, "training_iteration": 191, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-58-19", "timestamp": 1609826299, "time_this_iter_s": 56.26307535171509, "time_total_s": 10376.031695604324, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f7b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 10376.031695604324, "timesteps_since_restore": 0, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 13.541249999999996, "ram_util_percent": 38.333749999999995}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1856.2731449359894, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2624.737192013852, 1405.0539937888561, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.9519466859594035, "mean_processing_ms": 1.3267530959393588, "mean_inference_ms": 0.6884362477792745}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 576000, "timers": {"learn_time_ms": 3.913, "learn_throughput": 16356.446, "update_time_ms": 0.645}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -69.925048828125, "critic_loss": 0.0020478360820561647, "mean_q": 69.83009338378906, "max_q": 96.01323699951172, "min_q": 33.0253791809082, "mean_td_error": -0.006954789161682129, "td_error": "[ 6.66046143e-03  6.68716431e-02  4.43954468e-02 -4.57229614e-02\n  3.87229919e-02 -6.90078735e-03 -1.01600647e-01  2.98080444e-02\n -8.61358643e-03  4.30297852e-02 -4.95529175e-03 -6.23855591e-02\n -1.13716125e-01 -6.24160767e-02 -9.73358154e-02 -1.56974792e-02\n  5.40924072e-03 -3.69796753e-02  4.76799011e-02  1.78527832e-02\n -1.52587891e-05 -2.97698975e-02 -1.10095978e-01 -6.15386963e-02\n  9.59854126e-02 -1.07147217e-01  4.01535034e-02 -3.18679810e-02\n -5.03387451e-02 -4.57458496e-02 -7.51190186e-02  2.14080811e-02\n  1.44729614e-02 -1.61514282e-02  5.02700806e-02  4.91485596e-02\n -1.89895630e-02  3.34167480e-02 -7.89260864e-02 -5.53894043e-02\n  1.15928650e-01  3.64685059e-02 -1.53427124e-02 -5.79223633e-02\n  2.11830139e-02  7.33604431e-02 -1.56707764e-02 -4.73480225e-02\n -1.26953125e-01 -3.23638916e-02 -7.66639709e-02  4.83093262e-02\n  5.53207397e-02 -6.66046143e-03 -9.53674316e-04  2.78472900e-02\n -2.74047852e-02  1.41906738e-01  6.56356812e-02  9.38034058e-02\n -1.73645020e-02 -2.31246948e-02 -3.22456360e-02 -1.27182007e-02]"}}, "num_steps_sampled": 576000, "num_steps_trained": 36672064, "last_target_update_ts": 576000, "num_target_updates": 573001}, "done": false, "episodes_total": 192, "training_iteration": 192, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_14-59-16", "timestamp": 1609826356, "time_this_iter_s": 56.86522626876831, "time_total_s": 10432.896921873093, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 10432.896921873093, "timesteps_since_restore": 0, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 13.866666666666664, "ram_util_percent": 38.407407407407405}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1863.9014743161033, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2167.8869318002257, 1372.1616749125517, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.9527309900698935, "mean_processing_ms": 1.3268518460908587, "mean_inference_ms": 0.6886603685727914}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 579000, "timers": {"learn_time_ms": 4.337, "learn_throughput": 14755.93, "update_time_ms": 0.621}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -68.47630310058594, "critic_loss": 0.0076245940290391445, "mean_q": 68.37367248535156, "max_q": 96.66736602783203, "min_q": 28.627981185913086, "mean_td_error": 0.0003655850887298584, "td_error": "[-2.29110718e-02  8.15773010e-02  8.72650146e-02  6.11038208e-02\n  2.34832764e-02  3.50418091e-02  7.35015869e-02  2.47573853e-02\n -5.25856018e-02  1.24511719e-02 -4.46929932e-02 -8.65592957e-02\n -4.75044250e-02  2.61039734e-02 -4.54940796e-02  6.81533813e-02\n -2.37731934e-02 -1.51901245e-02  3.85055542e-02  3.54843140e-02\n  2.54135132e-02  1.44477844e-01  5.09643555e-02  7.27157593e-02\n -2.39410400e-02 -5.47790527e-03 -6.79016113e-03 -3.62815857e-02\n -8.78772736e-02  1.66702271e-02  4.46624756e-02 -8.03337097e-02\n  4.76493835e-02 -1.75476074e-03 -3.17916870e-02 -4.52880859e-02\n  1.13937378e-01 -2.28347778e-02  3.89060974e-02 -4.16717529e-02\n -8.97216797e-03  9.53063965e-02  5.27496338e-02  4.96444702e-02\n -2.39868164e-02 -6.60858154e-02 -2.29721069e-02  2.28881836e-05\n  7.82775879e-03  9.20791626e-02  6.26716614e-02  7.74688721e-02\n  6.80236816e-02  1.05895996e-02 -3.64074707e-02 -7.08999634e-02\n  7.46307373e-02  1.49307251e-02  4.30908203e-02  8.60977173e-02\n  9.41467285e-03 -1.10549927e-02 -8.62342834e-01 -1.85012817e-02]"}}, "num_steps_sampled": 579000, "num_steps_trained": 36864064, "last_target_update_ts": 579000, "num_target_updates": 576001}, "done": false, "episodes_total": 193, "training_iteration": 193, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-00-13", "timestamp": 1609826413, "time_this_iter_s": 56.636366844177246, "time_total_s": 10489.53328871727, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d268>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 10489.53328871727, "timesteps_since_restore": 0, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 13.46172839506173, "ram_util_percent": 38.4}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1876.2468645065755, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2606.7006939597627, 1049.0020932198336, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.953531791256717, "mean_processing_ms": 1.3269541662906832, "mean_inference_ms": 0.6888854108108288}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 582000, "timers": {"learn_time_ms": 4.672, "learn_throughput": 13699.321, "update_time_ms": 0.787}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -73.35823822021484, "critic_loss": 0.07810103893280029, "mean_q": 73.25181579589844, "max_q": 96.77793884277344, "min_q": 32.23236846923828, "mean_td_error": -0.38328611850738525, "td_error": "[-0.37350082 -0.37879944 -0.51517487 -0.28513336 -0.29769135 -0.48007965\n -0.21096802 -0.2762375  -0.39113617 -0.4480667  -0.4219818  -0.31911469\n -0.42332458 -0.38006973 -0.4893875  -0.4407425  -0.37994385 -0.1964035\n -0.3446579  -0.2651825  -0.544487   -0.37669373 -0.44781876 -0.3124771\n -0.36032867 -0.28814697 -0.507988   -0.30286407 -0.44769287 -0.19334412\n -0.40353394 -0.39918518 -0.36854553 -0.49819946 -0.42055893 -0.44180298\n -0.2589569  -0.39056015 -0.21961212 -0.44939423 -0.51052856 -0.1722641\n -0.4120102  -0.2899704  -0.4110489  -0.28939438 -0.45267105 -0.4836502\n -0.42713165 -0.47457886 -0.42414093 -0.49240875 -0.2165451  -0.321846\n -0.39653778 -0.43513107 -0.4525566  -0.48883057 -0.4131012  -0.4860649\n -0.49999237 -0.3527298  -0.4291458  -0.24824524]"}}, "num_steps_sampled": 582000, "num_steps_trained": 37056064, "last_target_update_ts": 582000, "num_target_updates": 579001}, "done": false, "episodes_total": 194, "training_iteration": 194, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-01-10", "timestamp": 1609826470, "time_this_iter_s": 57.43912124633789, "time_total_s": 10546.972409963608, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d1e0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 10546.972409963608, "timesteps_since_restore": 0, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 13.774390243902438, "ram_util_percent": 38.4}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1888.6478589331143, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2289.101535873718, 1087.8881364159554, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.954360361172307, "mean_processing_ms": 1.3270531041253772, "mean_inference_ms": 0.689112846489229}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 585000, "timers": {"learn_time_ms": 4.113, "learn_throughput": 15562.107, "update_time_ms": 0.668}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -70.4420394897461, "critic_loss": 0.03959617763757706, "mean_q": 70.32572937011719, "max_q": 97.14751434326172, "min_q": 16.222570419311523, "mean_td_error": -0.2597966194152832, "td_error": "[-0.38894653 -0.37474823 -0.23524475 -0.21798706 -0.35157776 -0.23381042\n -0.25014496 -0.3548584  -0.12286377 -0.23773956 -0.39476013 -0.15739822\n -0.22763824 -0.42034912 -0.0213623  -0.1008606  -0.23357391 -0.28751373\n -0.02204132 -0.04542542 -0.26630402 -0.19898987 -0.36310577 -0.16536713\n -0.09735107 -0.28831863 -0.2616272  -0.36267853 -0.28414536 -0.1955185\n -0.26314926 -0.36603546 -0.33343506 -0.24733734 -0.29480362 -0.29808807\n -0.38884735 -0.4207611  -0.23552704 -0.31523895 -0.3600006  -0.28586578\n -0.32984924 -0.29666138 -0.3945999  -0.24730682 -0.07279968 -0.33070374\n -0.16648483 -0.2982483  -0.00872803 -0.16849136 -0.1370697  -0.39777374\n -0.252182   -0.17475891 -0.32460403 -0.22727966 -0.38090515 -0.18395233\n -0.23412323 -0.38197327 -0.2443161  -0.40283203]"}}, "num_steps_sampled": 585000, "num_steps_trained": 37248064, "last_target_update_ts": 585000, "num_target_updates": 582001}, "done": false, "episodes_total": 195, "training_iteration": 195, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-02-08", "timestamp": 1609826528, "time_this_iter_s": 57.6509473323822, "time_total_s": 10604.62335729599, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d9d8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 10604.62335729599, "timesteps_since_restore": 0, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 13.12560975609756, "ram_util_percent": 38.4}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1899.2574813764957, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2148.8503807540537, 2083.233568978157, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.95520112793346, "mean_processing_ms": 1.3271514065495174, "mean_inference_ms": 0.689340326410122}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 588000, "timers": {"learn_time_ms": 4.101, "learn_throughput": 15606.531, "update_time_ms": 0.673}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -72.89218139648438, "critic_loss": 0.010448804125189781, "mean_q": 72.8043441772461, "max_q": 98.60800170898438, "min_q": 29.67879867553711, "mean_td_error": -0.001664876937866211, "td_error": "[-3.17077637e-02 -6.26983643e-02 -1.07879639e-02 -6.16302490e-02\n -4.11987305e-03  7.42263794e-02  6.74438477e-03  3.81469727e-03\n  1.10877991e-01 -9.96437073e-01  5.29403687e-02 -9.11178589e-02\n  1.54701233e-01 -3.59573364e-02 -5.24520874e-03  1.24687195e-01\n  1.24671936e-01 -4.36172485e-02 -1.51519775e-02  9.65881348e-03\n -6.23817444e-02 -5.88836670e-02 -8.53729248e-03  3.32031250e-02\n -1.35574341e-01 -4.19464111e-02  1.09436035e-01  1.21200562e-01\n  1.89132690e-02  5.91278076e-03  5.82084656e-02  1.39762878e-01\n  1.23073578e-01  9.00268555e-04  1.09909058e-01  1.12854004e-01\n -1.33666992e-02  4.50897217e-03  4.64859009e-02  2.07290649e-02\n  1.46865845e-02  1.65557861e-03 -3.46374512e-03 -6.14738464e-02\n -2.08587646e-02  5.58700562e-02  2.42080688e-02  1.58660889e-01\n -6.17790222e-02 -7.09609985e-02  2.71759033e-02 -7.84950256e-02\n -2.80761719e-02  5.48553467e-03  2.42233276e-02 -1.17004395e-01\n -5.12084961e-02 -9.09042358e-03  1.66244507e-02  1.00517273e-02\n  1.11175537e-01  2.70690918e-02  2.88085938e-02  1.90353394e-03]"}}, "num_steps_sampled": 588000, "num_steps_trained": 37440064, "last_target_update_ts": 588000, "num_target_updates": 585001}, "done": false, "episodes_total": 196, "training_iteration": 196, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-03-04", "timestamp": 1609826584, "time_this_iter_s": 56.15594482421875, "time_total_s": 10660.779302120209, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc55d0d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 10660.779302120209, "timesteps_since_restore": 0, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 13.561250000000001, "ram_util_percent": 38.40999999999999}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1894.8262227139712, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1640.1077027257454, 1288.3782655134846, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.956021421912698, "mean_processing_ms": 1.3272537806915374, "mean_inference_ms": 0.6895698788636174}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 591000, "timers": {"learn_time_ms": 3.792, "learn_throughput": 16877.638, "update_time_ms": 0.712}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -71.29293060302734, "critic_loss": 0.00744183175265789, "mean_q": 71.17415618896484, "max_q": 96.61045837402344, "min_q": 31.090192794799805, "mean_td_error": -0.09677326679229736, "td_error": "[-0.18583679 -0.12922287 -0.11470032 -0.14719391 -0.15872192 -0.06604767\n -0.21613312 -0.10692596 -0.04824829 -0.02735901 -0.12034607 -0.08487701\n -0.05523682 -0.04161835 -0.15070343 -0.02570343 -0.09991455 -0.04203796\n -0.07902145 -0.18154144 -0.2518463  -0.21731567 -0.02690887 -0.09234238\n -0.22223663 -0.09745026 -0.23914337  0.08460999 -0.02803802 -0.1088562\n -0.09882355 -0.15173721 -0.04800034 -0.13798904  0.0213089  -0.14976501\n  0.02561188  0.02238464 -0.10415649 -0.08150482 -0.12571716 -0.01114655\n -0.202034   -0.20674133 -0.03073883 -0.09002686 -0.00348663 -0.11117554\n -0.1185379  -0.10217285 -0.04940796 -0.07817841 -0.11415863 -0.14504242\n -0.05405807 -0.01306915 -0.03411865 -0.07187653 -0.10225296 -0.14588928\n -0.16215515 -0.08271027 -0.03544617 -0.11975861]"}}, "num_steps_sampled": 591000, "num_steps_trained": 37632064, "last_target_update_ts": 591000, "num_target_updates": 588001}, "done": false, "episodes_total": 197, "training_iteration": 197, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-04-01", "timestamp": 1609826641, "time_this_iter_s": 56.573302030563354, "time_total_s": 10717.352604150772, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d620>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 10717.352604150772, "timesteps_since_restore": 0, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 13.525925925925925, "ram_util_percent": 38.5}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1904.9252458061612, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2298.2805747324824, 1525.6197181165674, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.956852072723056, "mean_processing_ms": 1.3273568111981608, "mean_inference_ms": 0.6897990811487305}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 594000, "timers": {"learn_time_ms": 4.399, "learn_throughput": 14548.243, "update_time_ms": 0.711}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -74.11516571044922, "critic_loss": 0.002349790185689926, "mean_q": 73.99878692626953, "max_q": 96.12171936035156, "min_q": 48.284000396728516, "mean_td_error": -0.0014116168022155762, "td_error": "[-2.56080627e-02  7.97271729e-03  4.65545654e-02  7.49168396e-02\n -6.99691772e-02 -1.16119385e-01  9.42611694e-02  4.53186035e-02\n  4.16641235e-02 -5.32836914e-02  8.27026367e-03 -1.22070312e-04\n  6.41937256e-02  1.57928467e-03 -3.97644043e-02 -7.30667114e-02\n  1.99089050e-02  2.59246826e-02 -4.49371338e-02 -3.26156616e-02\n -1.73721313e-02 -2.64434814e-02 -4.41284180e-02  4.83932495e-02\n -4.14276123e-02 -1.57218933e-01  4.84924316e-02 -8.68988037e-03\n -2.69927979e-02 -7.89985657e-02 -3.87916565e-02 -5.46951294e-02\n  2.96936035e-02  4.67605591e-02 -5.41992188e-02  3.11508179e-02\n -8.59565735e-02 -3.52478027e-03  3.53736877e-02  3.95431519e-02\n -5.69534302e-02 -2.21786499e-02  2.91442871e-02  1.63345337e-02\n  1.91802979e-02  1.12144470e-01 -3.16696167e-02  5.54504395e-02\n -1.22276306e-01 -3.50189209e-02 -2.13203430e-02 -3.54537964e-02\n -7.77435303e-02 -1.94778442e-02  1.76414490e-01  1.22268677e-01\n  1.33323669e-01  2.10723877e-02  2.42538452e-02  1.15646362e-01\n -3.28063965e-02 -4.65278625e-02 -7.23419189e-02  4.21447754e-02]"}}, "num_steps_sampled": 594000, "num_steps_trained": 37824064, "last_target_update_ts": 594000, "num_target_updates": 591001}, "done": false, "episodes_total": 198, "training_iteration": 198, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-04-59", "timestamp": 1609826699, "time_this_iter_s": 57.84898924827576, "time_total_s": 10775.201593399048, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54da60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 10775.201593399048, "timesteps_since_restore": 0, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 15.408536585365853, "ram_util_percent": 38.5}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1908.969117725417, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1930.00691004212, 2122.312162722068, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.957692348690402, "mean_processing_ms": 1.3274617996095415, "mean_inference_ms": 0.6900298373496776}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 597000, "timers": {"learn_time_ms": 4.523, "learn_throughput": 14150.599, "update_time_ms": 0.71}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -71.1000747680664, "critic_loss": 0.0022346987389028072, "mean_q": 70.97384643554688, "max_q": 97.7702865600586, "min_q": 37.28255844116211, "mean_td_error": -0.010172665119171143, "td_error": "[ 0.00442505 -0.03486633  0.02340698  0.02396774  0.04767227 -0.01262283\n  0.02624512  0.00024414 -0.05526733  0.01391983 -0.01714325 -0.01417542\n -0.02265167  0.00112915 -0.07319641 -0.072052    0.01131439  0.04663086\n -0.03123474 -0.00028229 -0.05854797  0.0012207   0.06841278  0.05392456\n  0.00177383 -0.07588196  0.00989532 -0.06887054 -0.0475769  -0.05631638\n  0.03736115 -0.04587555  0.1211586  -0.07831573 -0.02578354 -0.01945496\n -0.12593079 -0.07935333  0.04292297 -0.0078125   0.05209351  0.05027771\n -0.09866333 -0.03111267  0.00884247  0.01706696 -0.03170776  0.1959343\n -0.04053497  0.06959534  0.0276947  -0.00830078  0.00309753 -0.05106354\n  0.1167984  -0.06284332 -0.13292694 -0.11060333 -0.02432251  0.09147644\n -0.07038116 -0.09357452 -0.06344604  0.02313995]"}}, "num_steps_sampled": 597000, "num_steps_trained": 38016064, "last_target_update_ts": 597000, "num_target_updates": 594001}, "done": false, "episodes_total": 199, "training_iteration": 199, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-05-55", "timestamp": 1609826755, "time_this_iter_s": 56.79573321342468, "time_total_s": 10831.997326612473, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f400>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 10831.997326612473, "timesteps_since_restore": 0, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 13.32716049382716, "ram_util_percent": 38.5}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1914.1732087590563, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2642.7212660860387, 1060.4595759580993, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.958525979218504, "mean_processing_ms": 1.3275687917490635, "mean_inference_ms": 0.6902612685357522}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 600000, "timers": {"learn_time_ms": 3.98, "learn_throughput": 16081.105, "update_time_ms": 0.759}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -71.51335144042969, "critic_loss": 0.011012100614607334, "mean_q": 71.41305541992188, "max_q": 93.96959686279297, "min_q": 32.00853729248047, "mean_td_error": 0.111501544713974, "td_error": "[ 0.32315063  0.02722168  0.18874359  0.04314423  0.07914734  0.07097244\n  0.23633194  0.13915253 -0.02326965 -0.00431824  0.12703323  0.18304443\n  0.05030441  0.10895538  0.2897644   0.09933472  0.00487518  0.20777893\n -0.07367706  0.07191086  0.02123451  0.10094452  0.05547333  0.03561401\n  0.31219864  0.35977173  0.1796875  -0.03334045  0.12882996  0.01959229\n  0.21407318  0.18836975  0.09082794  0.1450882  -0.00926208  0.10660553\n  0.03250122  0.12194061 -0.00289917  0.06417847  0.15018463  0.09486008\n  0.08019257  0.0146637   0.08148193  0.04729462  0.11815643  0.24017334\n  0.21226501  0.32858276  0.20542526  0.12861633  0.1945839   0.02608871\n  0.1851387   0.14910889  0.01306152  0.15154266  0.03030396  0.14614868\n  0.06244659  0.04442596  0.07401276  0.0763092 ]"}}, "num_steps_sampled": 600000, "num_steps_trained": 38208064, "last_target_update_ts": 600000, "num_target_updates": 597001}, "done": false, "episodes_total": 200, "training_iteration": 200, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-06-52", "timestamp": 1609826812, "time_this_iter_s": 56.53910517692566, "time_total_s": 10888.536431789398, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f9d8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 10888.536431789398, "timesteps_since_restore": 0, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 13.559259259259258, "ram_util_percent": 38.5}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1920.552006395905, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1698.3393396429403, 1778.9495721997735, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.95936837469053, "mean_processing_ms": 1.3276732167737766, "mean_inference_ms": 0.6904931886101552}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 603000, "timers": {"learn_time_ms": 4.196, "learn_throughput": 15252.188, "update_time_ms": 0.713}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -75.81265258789062, "critic_loss": 0.0025093359872698784, "mean_q": 75.68959045410156, "max_q": 98.18085479736328, "min_q": 38.19488525390625, "mean_td_error": 0.010734498500823975, "td_error": "[ 5.63049316e-03 -1.24824524e-01 -6.53114319e-02 -6.15310669e-02\n -6.39648438e-02  9.96093750e-02 -4.47120667e-02 -5.10444641e-02\n  4.05502319e-02 -6.75888062e-02 -3.52745056e-02  4.12216187e-02\n -1.59072876e-02  9.69467163e-02  6.57653809e-02  4.25949097e-02\n  3.43322754e-04  6.16912842e-02  6.26678467e-02 -2.07824707e-02\n  9.20104980e-03 -1.39694214e-02 -2.92968750e-03 -2.27050781e-02\n  4.02603149e-02 -4.12750244e-03 -7.64465332e-03 -6.21795654e-03\n  1.20170593e-01 -8.44573975e-02 -8.04061890e-02  3.45611572e-02\n  1.55616760e-01 -7.03964233e-02 -3.25508118e-02  2.69622803e-02\n  2.16140747e-02 -1.91497803e-03 -3.15628052e-02 -9.03396606e-02\n  3.86657715e-02  4.02984619e-02  6.88858032e-02 -7.78961182e-03\n  1.58477783e-01  2.25296021e-02  4.01458740e-02  1.66130066e-02\n -1.23062134e-02 -4.73632812e-02  7.86476135e-02  3.54614258e-02\n  6.21032715e-03  6.26831055e-02  1.43127441e-02  1.73965454e-01\n -7.45239258e-02 -3.90625000e-03  1.73858643e-01  1.52587891e-05\n  6.15768433e-02  6.83593750e-03 -9.15679932e-02  3.81469727e-05]"}}, "num_steps_sampled": 603000, "num_steps_trained": 38400064, "last_target_update_ts": 603000, "num_target_updates": 600001}, "done": false, "episodes_total": 201, "training_iteration": 201, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-07-49", "timestamp": 1609826869, "time_this_iter_s": 57.19679808616638, "time_total_s": 10945.733229875565, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fc80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 10945.733229875565, "timesteps_since_restore": 0, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 13.634146341463415, "ram_util_percent": 38.5}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1924.1565065996585, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2139.399592575111, 1559.3776902116174, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.960204731180666, "mean_processing_ms": 1.3277805099873308, "mean_inference_ms": 0.6907240215359087}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 606000, "timers": {"learn_time_ms": 4.266, "learn_throughput": 15002.848, "update_time_ms": 0.744}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -71.56622314453125, "critic_loss": 0.004148263018578291, "mean_q": 71.48038482666016, "max_q": 99.15501403808594, "min_q": 29.80244255065918, "mean_td_error": -0.046477824449539185, "td_error": "[ 0.08283997 -0.11352539  0.1635437   0.01876831 -0.05349731 -0.09115601\n -0.02029037  0.0113678  -0.05447388 -0.06229401 -0.07888794 -0.03780365\n  0.05721283 -0.05915833 -0.06334305  0.01451111 -0.15351868 -0.08903122\n -0.02794647 -0.12204742 -0.04766846 -0.01939392 -0.00631714 -0.04174042\n -0.08573151  0.02562714 -0.04686737 -0.13482666 -0.12099075 -0.04333496\n -0.14408875  0.00756073 -0.04418182  0.02508545 -0.15984344  0.00061035\n -0.17650604  0.02310181 -0.01679993 -0.1297226  -0.03284454 -0.13456154\n -0.04771423 -0.12235641  0.02651596 -0.15211487 -0.14208221 -0.02334213\n  0.11936188 -0.03783417 -0.00021362 -0.03751373 -0.07498169 -0.15228271\n -0.0918541  -0.06884003 -0.05716705 -0.04958344 -0.09671021 -0.04102325\n -0.07259369  0.2034378  -0.01727295 -0.05625153]"}}, "num_steps_sampled": 606000, "num_steps_trained": 38592064, "last_target_update_ts": 606000, "num_target_updates": 603001}, "done": false, "episodes_total": 202, "training_iteration": 202, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-08-45", "timestamp": 1609826925, "time_this_iter_s": 56.32546305656433, "time_total_s": 11002.058692932129, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2598>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 11002.058692932129, "timesteps_since_restore": 0, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 13.373750000000001, "ram_util_percent": 38.508750000000006}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2700.595681591929, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1930.4888548307076, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2192.6125133165697, 929.6504046468336, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.961037403647929, "mean_processing_ms": 1.3278894309798859, "mean_inference_ms": 0.6909539772757677}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 609000, "timers": {"learn_time_ms": 4.421, "learn_throughput": 14474.972, "update_time_ms": 0.802}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -70.998291015625, "critic_loss": 0.004123949911445379, "mean_q": 70.91549682617188, "max_q": 97.18334197998047, "min_q": 29.207683563232422, "mean_td_error": -0.06973385810852051, "td_error": "[ 0.01177216 -0.14900208 -0.11131668 -0.12753296  0.02594757 -0.0914917\n -0.13908386  0.01726532 -0.1357193  -0.12081909 -0.05317688 -0.09236908\n -0.0851593  -0.00434113 -0.0681076  -0.12895966 -0.1629715  -0.05787659\n -0.06478119 -0.09189606 -0.07115555 -0.12903595  0.0164566  -0.14380646\n -0.02457428  0.03996277 -0.03357697 -0.03896332 -0.06056213 -0.1345253\n -0.04974365  0.04949188 -0.14903641 -0.13469696 -0.06832886 -0.049263\n -0.12723541 -0.09932709 -0.03013229 -0.06178284 -0.03775787 -0.1161499\n -0.07989883 -0.06650543 -0.12737274 -0.07324219 -0.10692596  0.00891876\n -0.03142548 -0.09942627 -0.01535797 -0.02724457 -0.052948   -0.05405807\n -0.06273651 -0.05675507 -0.10713196 -0.07992554 -0.11904144 -0.05050659\n -0.02809143 -0.07248306 -0.09929657  0.02185059]"}}, "num_steps_sampled": 609000, "num_steps_trained": 38784064, "last_target_update_ts": 609000, "num_target_updates": 606001}, "done": false, "episodes_total": 203, "training_iteration": 203, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-09-43", "timestamp": 1609826983, "time_this_iter_s": 57.38223934173584, "time_total_s": 11059.440932273865, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a26a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 11059.440932273865, "timesteps_since_restore": 0, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 15.071951219512195, "ram_util_percent": 38.57439024390244}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2719.1968736108493, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1948.3843195203478, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2719.1968736108493, 2338.3385235509663, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.961884869968982, "mean_processing_ms": 1.327999320619287, "mean_inference_ms": 0.6911832759953296}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 612000, "timers": {"learn_time_ms": 4.584, "learn_throughput": 13961.743, "update_time_ms": 0.681}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -73.50897979736328, "critic_loss": 0.008126993663609028, "mean_q": 73.4226303100586, "max_q": 96.77827453613281, "min_q": 50.44198989868164, "mean_td_error": -0.008424460887908936, "td_error": "[-1.46026611e-02  8.25195312e-02  3.81851196e-02 -6.07490540e-02\n  5.50308228e-02  7.21740723e-03 -4.81796265e-02  1.10740662e-02\n -5.12619019e-02 -1.01654053e-01  5.10940552e-02  8.27178955e-02\n  4.10537720e-02 -9.39178467e-03  7.05184937e-02  4.05349731e-02\n -8.19931030e-02  3.34815979e-02 -5.47714233e-02 -1.12735748e-01\n  1.32904053e-02  9.99984741e-02  2.86026001e-02 -9.23919678e-03\n -1.03607178e-02 -8.80027771e-01  8.03642273e-02  7.13272095e-02\n -4.82101440e-02  1.18865967e-02  1.81083679e-02 -3.65104675e-02\n  1.00784302e-01 -1.95922852e-02 -3.24783325e-02 -1.20208740e-01\n  2.45628357e-02 -4.37927246e-02  1.01882935e-01 -5.25817871e-02\n  1.39083862e-01 -1.28707886e-02 -1.97601318e-03 -9.46273804e-02\n  9.28726196e-02 -2.35176086e-02 -5.13153076e-02 -6.18591309e-02\n -3.42712402e-02  9.30786133e-03 -3.15818787e-02  3.64074707e-02\n -2.02178955e-02  3.76892090e-02 -7.24792480e-04  6.84318542e-02\n -6.02340698e-02  9.03701782e-02  8.71887207e-02  6.19583130e-02\n -2.28424072e-02 -2.67105103e-02 -1.58691406e-02  2.02484131e-02]"}}, "num_steps_sampled": 612000, "num_steps_trained": 38976064, "last_target_update_ts": 612000, "num_target_updates": 609001}, "done": false, "episodes_total": 204, "training_iteration": 204, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-10-40", "timestamp": 1609827040, "time_this_iter_s": 56.97626233100891, "time_total_s": 11116.417194604874, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc55a0d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 11116.417194604874, "timesteps_since_restore": 0, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 13.430864197530866, "ram_util_percent": 38.6}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2719.1968736108493, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1943.8181431914209, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1881.7208906582616, 1565.5911817629587, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.962711978940884, "mean_processing_ms": 1.3281058604830827, "mean_inference_ms": 0.6914116990979104}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 615000, "timers": {"learn_time_ms": 4.347, "learn_throughput": 14723.556, "update_time_ms": 0.656}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -74.40673065185547, "critic_loss": 0.008401875384151936, "mean_q": 74.2992172241211, "max_q": 98.35480499267578, "min_q": 44.365623474121094, "mean_td_error": 0.08682769536972046, "td_error": "[ 0.25984192  0.09622192  0.13111115  0.0045929   0.0402832   0.04343796\n  0.08743286  0.07052231 -0.03038025  0.13681793  0.13076782  0.13604736\n  0.0842514   0.1197052   0.13331604  0.12697601  0.00455475  0.0226059\n  0.14103699  0.06829071  0.03245544  0.08218384  0.12414551  0.02462006\n  0.11411285  0.20417786 -0.16507721 -0.03459167  0.09580994  0.0125351\n  0.137043    0.12329865  0.12343979  0.12436676  0.05764771  0.15322113\n  0.09307098 -0.18517303  0.0589447   0.03201675  0.15624237  0.0776062\n  0.26270294 -0.01049042  0.16657257  0.21395493 -0.09716797  0.04987335\n  0.20842743  0.10381317 -0.17591858  0.09749603  0.06271362  0.11227417\n  0.10671997  0.21747589  0.05866241  0.22999573  0.14622498  0.12069702\n  0.15127563  0.10347366  0.21535492 -0.03668976]"}}, "num_steps_sampled": 615000, "num_steps_trained": 39168064, "last_target_update_ts": 615000, "num_target_updates": 612001}, "done": false, "episodes_total": 205, "training_iteration": 205, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-11-36", "timestamp": 1609827096, "time_this_iter_s": 56.55787396430969, "time_total_s": 11172.975068569183, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2d08>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 11172.975068569183, "timesteps_since_restore": 0, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 13.727160493827158, "ram_util_percent": 38.6}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2719.1968736108493, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1939.345148971612, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1118.2917597820328, 2013.8765761514996, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.963535972308115, "mean_processing_ms": 1.328214801133756, "mean_inference_ms": 0.6916390350316624}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 618000, "timers": {"learn_time_ms": 4.349, "learn_throughput": 14716.775, "update_time_ms": 0.672}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -74.24234771728516, "critic_loss": 0.0029086775612086058, "mean_q": 74.13943481445312, "max_q": 98.39270782470703, "min_q": 37.09536361694336, "mean_td_error": 0.002304673194885254, "td_error": "[-0.01380157 -0.14975739 -0.06545258  0.06700134 -0.01693726 -0.02841568\n  0.03927612  0.07530975 -0.02797699 -0.07070923 -0.01501465 -0.02444077\n  0.03926086  0.03382874  0.025177    0.08111191 -0.0619278   0.02189255\n -0.04547119 -0.02744293  0.0873642   0.06349945  0.08548355 -0.08496857\n  0.02378845  0.23595047 -0.1244812   0.15792847  0.06986237  0.00967407\n -0.00770187  0.00548553 -0.04310608  0.01967621 -0.13169861  0.07042694\n -0.06767273  0.00484467  0.05580139  0.10097504  0.0047226  -0.05239105\n -0.112854   -0.02220535  0.01480865 -0.08472443  0.0151825  -0.11032104\n -0.00966263  0.04633331  0.10335541 -0.00449371 -0.06446075  0.01502991\n  0.00108337  0.03939819  0.00432587 -0.01799774  0.13452148 -0.03030396\n -0.09236908 -0.02734756 -0.05099106  0.08221817]"}}, "num_steps_sampled": 618000, "num_steps_trained": 39360064, "last_target_update_ts": 618000, "num_target_updates": 615001}, "done": false, "episodes_total": 206, "training_iteration": 206, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-12-33", "timestamp": 1609827153, "time_this_iter_s": 56.13236331939697, "time_total_s": 11229.10743188858, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 11229.10743188858, "timesteps_since_restore": 0, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 13.689999999999998, "ram_util_percent": 38.67999999999999}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2719.1968736108493, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1937.9547909118885, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1874.84077017914, 2494.3375578999, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.964347974451154, "mean_processing_ms": 1.3283254380200373, "mean_inference_ms": 0.6918662767894665}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 621000, "timers": {"learn_time_ms": 4.56, "learn_throughput": 14035.914, "update_time_ms": 0.771}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -72.29598999023438, "critic_loss": 0.0026394608430564404, "mean_q": 72.20691680908203, "max_q": 97.35458374023438, "min_q": 34.200218200683594, "mean_td_error": 0.014821529388427734, "td_error": "[-0.02045441 -0.07839966  0.04099274 -0.01737976 -0.12916565  0.01891327\n  0.08798599 -0.0116272   0.03443146 -0.02622986  0.10326767 -0.02040863\n  0.00312042  0.00878906  0.07325363  0.02632904  0.0705719  -0.03920746\n  0.0400238  -0.10375214  0.10938263  0.04257965  0.0454483  -0.00656891\n  0.0048027   0.12598419 -0.02754211 -0.07553101  0.00678253 -0.09523773\n -0.01712036 -0.12693787 -0.04349518  0.04090881 -0.02416229  0.11158752\n  0.13298798  0.0367775   0.08343124 -0.03854752  0.1150589  -0.02168274\n  0.0634079  -0.03419113  0.02664948  0.00963211  0.02634048  0.05437088\n -0.06682205  0.05179596 -0.04667664  0.01425171  0.02812958  0.04140472\n  0.04319763  0.02207184  0.07472229  0.04340363 -0.03862381  0.19638062\n  0.0473938  -0.07491684 -0.08454132  0.11123657]"}}, "num_steps_sampled": 621000, "num_steps_trained": 39552064, "last_target_update_ts": 621000, "num_target_updates": 618001}, "done": false, "episodes_total": 207, "training_iteration": 207, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-13-30", "timestamp": 1609827210, "time_this_iter_s": 57.219297647476196, "time_total_s": 11286.326729536057, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f9d8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 11286.326729536057, "timesteps_since_restore": 0, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 14.075308641975308, "ram_util_percent": 38.69999999999999}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2726.602781874578, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1940.277443151635, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2726.602781874578, 2222.244341795145, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.965144759219239, "mean_processing_ms": 1.3284366962588419, "mean_inference_ms": 0.6920928647278052}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 624000, "timers": {"learn_time_ms": 4.38, "learn_throughput": 14612.709, "update_time_ms": 0.732}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -72.24470520019531, "critic_loss": 0.002832108875736594, "mean_q": 72.14945983886719, "max_q": 95.40234375, "min_q": 16.347227096557617, "mean_td_error": 0.011688172817230225, "td_error": "[-0.01548004 -0.09500122  0.07993317 -0.01377869  0.03662872 -0.01576233\n  0.08963013  0.09560394  0.05604553 -0.04531097 -0.11200714  0.04451752\n -0.03048706 -0.00743866  0.02468109 -0.05110168 -0.00778961 -0.01069641\n  0.00652313 -0.08311462 -0.00223541  0.13833618 -0.03394318  0.14917755\n  0.04572296 -0.0333786   0.01043701 -0.01716614 -0.02960205  0.05661011\n -0.09761047  0.05144501 -0.03726959  0.08771515 -0.00790405 -0.01724243\n  0.08069611 -0.13306427  0.02484131  0.02499771  0.10057831  0.15099716\n -0.08267212 -0.00405121  0.16878128  0.05928421 -0.13973999  0.00975037\n  0.04481506 -0.07909775  0.07546616 -0.05563354 -0.02070618  0.08695602\n  0.10082245 -0.01074982  0.07386017 -0.02890015  0.04490662  0.11015701\n  0.03232956  0.00558472 -0.06221771 -0.03863525]"}}, "num_steps_sampled": 624000, "num_steps_trained": 39744064, "last_target_update_ts": 624000, "num_target_updates": 621001}, "done": false, "episodes_total": 208, "training_iteration": 208, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-14-27", "timestamp": 1609827267, "time_this_iter_s": 57.38512587547302, "time_total_s": 11343.71185541153, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 11343.71185541153, "timesteps_since_restore": 0, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 13.774390243902438, "ram_util_percent": 38.70121951219511}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2726.602781874578, "episode_reward_min": 760.0794040989045, "episode_reward_mean": 1944.8845579912004, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2682.955825751686, 760.0794040989045, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.965932815117469, "mean_processing_ms": 1.3285467597975835, "mean_inference_ms": 0.6923178560545638}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 627000, "timers": {"learn_time_ms": 4.125, "learn_throughput": 15516.321, "update_time_ms": 0.687}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -74.46428680419922, "critic_loss": 0.003015924710780382, "mean_q": 74.36163330078125, "max_q": 95.56184387207031, "min_q": 31.231048583984375, "mean_td_error": -0.02446955442428589, "td_error": "[-0.09186554 -0.00289536 -0.13077164 -0.07039642  0.01716232 -0.01509476\n -0.05472565 -0.02690887 -0.17618561  0.07445526  0.02464294  0.0304985\n  0.06964874 -0.04460144 -0.03984833  0.11787033 -0.1522522  -0.02576447\n -0.07130432 -0.03269196  0.0248642   0.03343201  0.03673935 -0.04676819\n -0.02484894 -0.25515747 -0.11937714  0.06836319 -0.01069641 -0.09907532\n  0.0486908  -0.03337097  0.03460693 -0.05436707  0.00099182  0.00554657\n -0.1257782  -0.16041565  0.09801483  0.056633    0.03649139 -0.03113556\n -0.0668869  -0.00968933  0.02462387 -0.0776062   0.08071136 -0.00285339\n -0.03451157 -0.04876709 -0.06777191 -0.03538895 -0.02746582 -0.01352692\n -0.03403473  0.00609589 -0.00157928 -0.07718658 -0.00644684 -0.0459671\n -0.02992249 -0.03194427  0.09698486 -0.04527283]"}}, "num_steps_sampled": 627000, "num_steps_trained": 39936064, "last_target_update_ts": 627000, "num_target_updates": 624001}, "done": false, "episodes_total": 209, "training_iteration": 209, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-15-24", "timestamp": 1609827324, "time_this_iter_s": 56.571293115615845, "time_total_s": 11400.283148527145, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d268>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 11400.283148527145, "timesteps_since_restore": 0, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 12.055555555555555, "ram_util_percent": 38.7320987654321}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2726.602781874578, "episode_reward_min": 1026.029765251664, "episode_reward_mean": 1957.7943696493353, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2051.0605699124058, 1302.6241395198547, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.966737129693599, "mean_processing_ms": 1.32865651834496, "mean_inference_ms": 0.6925412367125129}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 630000, "timers": {"learn_time_ms": 4.176, "learn_throughput": 15324.457, "update_time_ms": 0.751}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -70.23128509521484, "critic_loss": 0.0026003115344792604, "mean_q": 70.1339111328125, "max_q": 95.7255859375, "min_q": 41.90215301513672, "mean_td_error": 0.01892763376235962, "td_error": "[-0.03250122  0.01762009  0.03660583  0.00367737  0.02568817  0.02835083\n  0.00688934  0.06280518  0.00822067  0.0328598  -0.07301331 -0.07582092\n  0.09529114 -0.09921265  0.09729004 -0.06717682 -0.00611115  0.00382996\n -0.05403519 -0.0691452  -0.04108429 -0.00486374  0.05849838  0.0366745\n  0.07576752 -0.00868225  0.06763458 -0.01968384 -0.01853561  0.0375824\n -0.13477325  0.03021622 -0.07408905  0.04273224  0.056427    0.14051056\n  0.05724335  0.05998993 -0.03232574  0.17755127 -0.16526031  0.19283295\n  0.07335663  0.03417206 -0.01304626 -0.03920746  0.07268524  0.0553627\n -0.0202179   0.03183746  0.06745911  0.008255   -0.0096283   0.07226562\n  0.00797653  0.07841492  0.04357147  0.0275116   0.00470734  0.10196686\n  0.06101227  0.04275513  0.0086441   0.02503967]"}}, "num_steps_sampled": 630000, "num_steps_trained": 40128064, "last_target_update_ts": 630000, "num_target_updates": 627001}, "done": false, "episodes_total": 210, "training_iteration": 210, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-16-19", "timestamp": 1609827379, "time_this_iter_s": 55.17755198478699, "time_total_s": 11455.460700511932, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d488>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 11455.460700511932, "timesteps_since_restore": 0, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 10.505063291139242, "ram_util_percent": 38.8493670886076}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2726.602781874578, "episode_reward_min": 1026.029765251664, "episode_reward_mean": 1962.6375233303029, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1786.9395076166045, 1530.1558081086016, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.967545532649877, "mean_processing_ms": 1.328768052090077, "mean_inference_ms": 0.6927662670502599}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 633000, "timers": {"learn_time_ms": 4.337, "learn_throughput": 14756.823, "update_time_ms": 0.67}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -71.18634033203125, "critic_loss": 0.002543302020058036, "mean_q": 71.08120727539062, "max_q": 94.35458374023438, "min_q": 32.99644470214844, "mean_td_error": 0.020775020122528076, "td_error": "[ 0.01070404  0.07566071  0.02535248  0.09423828  0.04152679  0.02168274\n  0.00831604  0.03704071 -0.01625061  0.00476837 -0.01991272  0.05181885\n  0.05490112  0.0653801   0.0282135  -0.02870178 -0.02854156  0.01695633\n  0.16664886  0.13147736  0.05922699 -0.14266205 -0.02329254  0.2490387\n -0.09418488  0.01979065 -0.00570679  0.03659821  0.10324097 -0.04489899\n  0.07815552 -0.03456116  0.05439758 -0.01728058 -0.02694321 -0.08501816\n  0.04157257  0.08508301  0.08264923 -0.00344849 -0.01856995  0.05235291\n -0.02293015  0.06150055  0.01184082 -0.0693512  -0.0066452   0.04841614\n  0.07574463  0.03551102  0.00856018  0.04406738  0.13378143  0.00597763\n -0.02887726  0.02910614 -0.04600525 -0.01799011  0.00940704 -0.08505249\n  0.06208038 -0.01533508  0.01422119 -0.02524567]"}}, "num_steps_sampled": 633000, "num_steps_trained": 40320064, "last_target_update_ts": 633000, "num_target_updates": 630001}, "done": false, "episodes_total": 211, "training_iteration": 211, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-17-16", "timestamp": 1609827436, "time_this_iter_s": 56.96508717536926, "time_total_s": 11512.425787687302, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54df28>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 11512.425787687302, "timesteps_since_restore": 0, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 13.25185185185185, "ram_util_percent": 39.6}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2726.602781874578, "episode_reward_min": 1026.029765251664, "episode_reward_mean": 1966.2569334967766, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1892.096824756025, 1202.6165357364655, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.968352051851509, "mean_processing_ms": 1.3288767470614422, "mean_inference_ms": 0.6929919477429705}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 636000, "timers": {"learn_time_ms": 3.651, "learn_throughput": 17531.395, "update_time_ms": 0.671}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -74.08818817138672, "critic_loss": 0.0020589232444763184, "mean_q": 74.00170135498047, "max_q": 97.73856353759766, "min_q": 33.82673263549805, "mean_td_error": -0.004906058311462402, "td_error": "[ 0.08170319  0.05325317  0.05709839 -0.00836182 -0.00366974 -0.08440399\n  0.07434845 -0.01914215 -0.10804367 -0.10183716 -0.07498169 -0.00125885\n  0.06324768 -0.05695343 -0.03171539  0.02367401  0.04640961  0.03868103\n  0.16736603  0.05350494 -0.01085281 -0.07438278 -0.01944733  0.01570892\n  0.07055664  0.00233459 -0.04318237 -0.09082413 -0.05750275 -0.08698273\n -0.04282379  0.01702118 -0.05670929 -0.16921234 -0.09791183  0.01921844\n -0.04548264 -0.00418854 -0.00609589 -0.0422287   0.02706909  0.04776382\n -0.00395966 -0.01313019 -0.03158951 -0.01498795 -0.04210663 -0.04174042\n -0.01457214 -0.01136017  0.05367661 -0.00935364  0.0151062   0.02187347\n -0.02069855  0.04458618  0.0381546   0.05991364 -0.05484772  0.05610657\n  0.04174042  0.11408997 -0.01306915 -0.00858307]"}}, "num_steps_sampled": 636000, "num_steps_trained": 40512064, "last_target_update_ts": 636000, "num_target_updates": 633001}, "done": false, "episodes_total": 212, "training_iteration": 212, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-18-13", "timestamp": 1609827493, "time_this_iter_s": 56.73725891113281, "time_total_s": 11569.163046598434, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54dae8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 11569.163046598434, "timesteps_since_restore": 0, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 12.959259259259257, "ram_util_percent": 39.61975308641975}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2726.602781874578, "episode_reward_min": 1026.029765251664, "episode_reward_mean": 1978.5571648675402, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2432.639672812784, 1380.0147698608052, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.969158363117401, "mean_processing_ms": 1.3289822324318834, "mean_inference_ms": 0.6932150072954109}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 639000, "timers": {"learn_time_ms": 4.39, "learn_throughput": 14577.871, "update_time_ms": 0.707}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -73.06185913085938, "critic_loss": 28.05668067932129, "mean_q": 72.95006561279297, "max_q": 94.91062927246094, "min_q": 39.716552734375, "mean_td_error": 0.8935774564743042, "td_error": "[-3.3195496e-02 -1.3911438e-01 -2.0370483e-03 -7.5222015e-02\n -9.0377808e-02  3.3378601e-02 -6.6337585e-02 -1.1475372e-01\n -1.1374664e-01 -4.8698425e-02  7.7514648e-03 -1.6071320e-01\n  2.0730591e-01  4.3010712e-02 -3.2981873e-02 -4.6493530e-02\n  7.4691772e-03 -9.5962524e-02 -1.4904022e-01 -5.5763245e-02\n -4.5227051e-02 -8.5700989e-02  7.1105957e-02 -7.8720093e-02\n  2.3704529e-02 -1.2634277e-01  2.0103455e-02 -1.3919067e-01\n  1.2400818e-01 -6.8443298e-02 -5.8738708e-02 -7.5294495e-02\n -9.4810486e-02  7.3303223e-02 -1.8640900e-01  2.2148132e-02\n -1.1001587e-02 -1.0280609e-01  7.1334839e-02 -4.7714233e-02\n -5.2383423e-02 -2.0828247e-03 -8.1413269e-02 -6.1546326e-02\n  3.4126282e-02 -5.0971985e-02 -6.3667297e-02  5.1651001e-02\n -2.8099060e-02  3.9009094e-02 -1.7380524e-01 -8.8211060e-02\n -2.2987366e-02  5.9922565e+01 -7.1350098e-02  4.5265198e-02\n -2.8789520e-02 -1.8402100e-02 -9.2224121e-02  9.6656799e-02\n -1.4636993e-01 -1.4375305e-01 -1.6588593e-01 -6.8161011e-02]"}}, "num_steps_sampled": 639000, "num_steps_trained": 40704064, "last_target_update_ts": 639000, "num_target_updates": 636001}, "done": false, "episodes_total": 213, "training_iteration": 213, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-19-08", "timestamp": 1609827548, "time_this_iter_s": 55.579596281051636, "time_total_s": 11624.742642879486, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d7b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 11624.742642879486, "timesteps_since_restore": 0, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 10.058227848101268, "ram_util_percent": 39.892405063291136}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2726.602781874578, "episode_reward_min": 1026.029765251664, "episode_reward_mean": 1990.5758993783231, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2581.8882209391063, 1098.3963369132414, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.969981375500194, "mean_processing_ms": 1.329089220660335, "mean_inference_ms": 0.6934389838515088}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 642000, "timers": {"learn_time_ms": 3.962, "learn_throughput": 16151.643, "update_time_ms": 0.643}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -75.90745544433594, "critic_loss": 0.02434968203306198, "mean_q": 75.81646728515625, "max_q": 98.0524673461914, "min_q": 50.56698226928711, "mean_td_error": -0.1737304925918579, "td_error": "[-0.1583023  -0.17214203 -0.14090347 -0.23542023 -0.3458557  -0.09159088\n -0.10758209 -0.21949005 -0.21639252 -0.24287415 -0.06246948 -0.04936218\n -0.11491394 -0.16616058 -0.23287582 -0.08693695 -0.15511322 -0.16138458\n -0.15925598 -0.16565704 -0.14203644 -0.14002228 -0.28939056 -0.10055161\n -0.06311798 -0.3356781  -0.3090973  -0.3833313  -0.1567154  -0.09894562\n -0.17811584 -0.2361908  -0.21035004 -0.21177292 -0.17646408 -0.08181381\n -0.01837158 -0.04693604 -0.36675262 -0.10639191 -0.08296204 -0.08751678\n -0.1792221  -0.21105957 -0.10997772 -0.30651474 -0.04702759 -0.12120819\n -0.1530304  -0.1214447  -0.16288757 -0.9995117  -0.19276428 -0.12960815\n -0.07601929 -0.1340828  -0.12906647 -0.04907227 -0.10301208 -0.07955933\n -0.2341156  -0.05245209 -0.14646149 -0.27344513]"}}, "num_steps_sampled": 642000, "num_steps_trained": 40896064, "last_target_update_ts": 642000, "num_target_updates": 639001}, "done": false, "episodes_total": 214, "training_iteration": 214, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-20-05", "timestamp": 1609827605, "time_this_iter_s": 56.99806475639343, "time_total_s": 11681.74070763588, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f9d8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 11681.74070763588, "timesteps_since_restore": 0, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 10.540243902439025, "ram_util_percent": 40.04024390243902}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1026.029765251664, "episode_reward_mean": 2007.2576851852914, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2766.57491761004, 2292.0292424148865, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.970814963658962, "mean_processing_ms": 1.3291939884959416, "mean_inference_ms": 0.6936617440846402}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 645000, "timers": {"learn_time_ms": 4.273, "learn_throughput": 14978.153, "update_time_ms": 0.675}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -73.59306335449219, "critic_loss": 0.006883704103529453, "mean_q": 73.50381469726562, "max_q": 95.9168930053711, "min_q": 34.904788970947266, "mean_td_error": -0.011795759201049805, "td_error": "[ 5.0949097e-02 -2.0591736e-02 -1.3536072e-01 -1.0630798e-01\n  4.1160583e-02 -1.3732910e-02  8.9950562e-02 -6.9984436e-02\n -3.1860352e-02 -3.0578613e-02  3.2585144e-02 -3.2447815e-02\n  2.9827118e-02  5.1879883e-04 -1.2169647e-01  7.2990417e-02\n -1.5708923e-02  3.9367676e-03  1.5505600e-01  1.9836426e-04\n  2.5421143e-02 -4.8919678e-02  3.9497375e-02 -5.7701111e-02\n -8.0795288e-03 -8.6761475e-02  8.1214905e-03  7.2391510e-02\n -5.9944153e-02  1.2184143e-01 -2.0118713e-02  6.3316345e-02\n -5.7678223e-03  6.9580078e-02 -7.3471069e-03 -2.9418945e-02\n  2.4787903e-02 -5.2963257e-02 -5.1910400e-02  2.3380280e-02\n -9.6145630e-02 -3.7727356e-02 -1.9760132e-03  6.7703247e-02\n  6.7588806e-02 -2.7847290e-03  6.4628601e-02  3.4645081e-02\n  6.9595337e-02  7.0636749e-02  1.4125824e-02 -4.3502808e-02\n -1.9855499e-02 -7.3692322e-02 -3.2424927e-02  2.6046753e-02\n -7.8448486e-01  7.6709747e-02  1.1089325e-02 -2.8076172e-02\n -9.1163635e-02 -1.0757446e-02 -2.9380798e-02  7.5965881e-02]"}}, "num_steps_sampled": 645000, "num_steps_trained": 41088064, "last_target_update_ts": 645000, "num_target_updates": 642001}, "done": false, "episodes_total": 215, "training_iteration": 215, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-21-02", "timestamp": 1609827662, "time_this_iter_s": 56.16497874259949, "time_total_s": 11737.905686378479, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f598>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 11737.905686378479, "timesteps_since_restore": 0, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 9.346250000000001, "ram_util_percent": 39.77499999999999}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1026.029765251664, "episode_reward_mean": 2010.8891597373413, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2655.1766976199006, 2156.9836314578047, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.971641290682118, "mean_processing_ms": 1.3292954904938796, "mean_inference_ms": 0.6938830657965758}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 648000, "timers": {"learn_time_ms": 4.23, "learn_throughput": 15129.091, "update_time_ms": 0.65}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -74.50700378417969, "critic_loss": 0.011496901512145996, "mean_q": 74.44658660888672, "max_q": 96.5933609008789, "min_q": 40.72713088989258, "mean_td_error": -0.13256514072418213, "td_error": "[-0.20162201  0.01848221 -0.01888275 -0.06021881 -0.0269928  -0.21537781\n -0.05014801 -0.15377045 -0.23120117 -0.20751953 -0.1454544  -0.13065338\n -0.08569336 -0.16101837 -0.12682724 -0.08152008 -0.21317673 -0.0372467\n -0.22063446 -0.13854599 -0.32086945 -0.19463348 -0.12329102  0.04698944\n -0.10548401 -0.0878067  -0.26826477 -0.10652924 -0.17073059 -0.008255\n -0.1207428  -0.13162231 -0.14102173 -0.07571411 -0.22001648 -0.11719513\n -0.1948204  -0.07670975 -0.09619904 -0.06813431 -0.25413513 -0.09216309\n -0.16884613 -0.15354538 -0.16216278 -0.10514832 -0.15010834 -0.0455246\n -0.20337677 -0.1330719  -0.195755   -0.13603973 -0.1367569  -0.17481232\n -0.11941528 -0.1916275  -0.15693665 -0.08647919 -0.12897491 -0.17610931\n -0.10158539 -0.14645386 -0.07880402 -0.11726379]"}}, "num_steps_sampled": 648000, "num_steps_trained": 41280064, "last_target_update_ts": 648000, "num_target_updates": 645001}, "done": false, "episodes_total": 216, "training_iteration": 216, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-21-58", "timestamp": 1609827718, "time_this_iter_s": 56.273183822631836, "time_total_s": 11794.17887020111, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2ae8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 11794.17887020111, "timesteps_since_restore": 0, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 9.7575, "ram_util_percent": 39.89375000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1026.029765251664, "episode_reward_mean": 2014.6182851737426, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2529.8961750979374, 2493.7747525558207, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.972467992534932, "mean_processing_ms": 1.3293968506023555, "mean_inference_ms": 0.6941063791945729}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 651000, "timers": {"learn_time_ms": 4.083, "learn_throughput": 15673.782, "update_time_ms": 0.706}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -75.1364974975586, "critic_loss": 0.002352521289139986, "mean_q": 75.01205444335938, "max_q": 97.28765106201172, "min_q": 33.9332389831543, "mean_td_error": 0.01468437910079956, "td_error": "[-0.07948303  0.03910065  0.01514435 -0.01307678 -0.01908112  0.09596634\n  0.10282135 -0.06757355 -0.04063797  0.13179016  0.0688858  -0.00809479\n  0.08238602 -0.02774048 -0.00067139 -0.05220795 -0.05525208 -0.04504395\n  0.07476807  0.06416321  0.03515625  0.04084778 -0.02310944  0.06729889\n  0.03003693  0.00292206  0.00191116 -0.07116699  0.04927826 -0.05426788\n  0.03488159  0.04676819 -0.08171844  0.10696411 -0.03440094  0.06954575\n -0.01626205  0.02011108  0.07047272 -0.09635925  0.0912323  -0.07518768\n  0.07660675  0.01420593  0.04008484 -0.07780457  0.00862503  0.02400208\n -0.04138947  0.02906799  0.0317688   0.01766205  0.08836365 -0.133255\n  0.11172485  0.09267426  0.07448959  0.02327728 -0.05834961  0.05469513\n -0.07849121  0.00181961  0.05555725  0.10334778]"}}, "num_steps_sampled": 651000, "num_steps_trained": 41472064, "last_target_update_ts": 651000, "num_target_updates": 648001}, "done": false, "episodes_total": 217, "training_iteration": 217, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-22-55", "timestamp": 1609827775, "time_this_iter_s": 56.87910842895508, "time_total_s": 11851.057978630066, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2c80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 11851.057978630066, "timesteps_since_restore": 0, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 10.895061728395062, "ram_util_percent": 40.58024691358024}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1026.029765251664, "episode_reward_mean": 2004.841463497242, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1516.0925849057278, 2101.430394410294, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.973267168025903, "mean_processing_ms": 1.329498588313322, "mean_inference_ms": 0.6943273477787001}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 654000, "timers": {"learn_time_ms": 4.051, "learn_throughput": 15797.848, "update_time_ms": 0.712}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -74.48584747314453, "critic_loss": 0.0029641003347933292, "mean_q": 74.36235809326172, "max_q": 95.12474060058594, "min_q": 34.24856185913086, "mean_td_error": 0.02759230136871338, "td_error": "[ 0.16096878 -0.06723785 -0.03291321 -0.00118256  0.08332825 -0.03313446\n  0.01000977  0.1007309   0.10959244 -0.11553192  0.03884888  0.0329895\n  0.03900146 -0.11638641  0.05112076  0.06090546  0.08761597  0.07010651\n -0.03192902  0.04920197  0.08695984  0.20302582  0.02806091  0.00547409\n  0.14427185  0.00137711 -0.01670837  0.0471344   0.03948212  0.0295639\n -0.00229645 -0.04250336 -0.02067566 -0.02460861  0.08030701 -0.08457947\n  0.07546997 -0.11323547 -0.00941467 -0.02841187  0.11174774  0.03300476\n -0.00214386  0.02789307  0.0190239  -0.03363037  0.1317749   0.05499268\n -0.02026367  0.04254913  0.05679321  0.02555847 -0.07131958 -0.02741241\n  0.0218277   0.06219482  0.1296997   0.09962845 -0.02217865  0.03111267\n -0.01003265  0.03242493  0.02156067  0.1563034 ]"}}, "num_steps_sampled": 654000, "num_steps_trained": 41664064, "last_target_update_ts": 654000, "num_target_updates": 651001}, "done": false, "episodes_total": 218, "training_iteration": 218, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-23-50", "timestamp": 1609827830, "time_this_iter_s": 55.548951387405396, "time_total_s": 11906.606930017471, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a29d8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 11906.606930017471, "timesteps_since_restore": 0, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 11.467088607594937, "ram_util_percent": 40.773417721519}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1026.029765251664, "episode_reward_mean": 2007.345679215716, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2351.8519662577087, 1250.0018133478984, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.974059405494132, "mean_processing_ms": 1.3295995351529009, "mean_inference_ms": 0.6945458150419129}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 657000, "timers": {"learn_time_ms": 3.693, "learn_throughput": 17328.814, "update_time_ms": 0.637}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -73.13776397705078, "critic_loss": 0.0027190507389605045, "mean_q": 73.06429290771484, "max_q": 96.84751892089844, "min_q": 37.019683837890625, "mean_td_error": -0.022209346294403076, "td_error": "[-0.0249176  -0.09778595 -0.02870178 -0.05265045 -0.02025604  0.07769775\n  0.05871964 -0.06777191  0.01817703 -0.07473755  0.0717392  -0.10015106\n -0.03343964 -0.02033997 -0.0194397  -0.01173401 -0.05388641  0.01242447\n  0.0174942   0.0033493   0.01303101 -0.03675079  0.15853119 -0.1180191\n -0.02448273 -0.01259613  0.02459717 -0.05839539 -0.03093719 -0.02848053\n -0.05313873 -0.09515762 -0.04279327 -0.03414917 -0.0738678   0.04478073\n -0.10961914 -0.007164   -0.0245285   0.06802368 -0.04814148 -0.05680084\n -0.04814911 -0.09429169  0.18579102 -0.08009338  0.03733063  0.02189636\n -0.0460434  -0.17238617 -0.0763092   0.02560043 -0.00228119 -0.00174713\n -0.03176117 -0.03507233  0.13241577 -0.11042786 -0.12419891  0.05536652\n -0.10276031 -0.01589203 -0.01919937 -0.0269165 ]"}}, "num_steps_sampled": 657000, "num_steps_trained": 41856064, "last_target_update_ts": 657000, "num_target_updates": 654001}, "done": false, "episodes_total": 219, "training_iteration": 219, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-24-45", "timestamp": 1609827885, "time_this_iter_s": 54.32926297187805, "time_total_s": 11960.93619298935, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f7b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 11960.93619298935, "timesteps_since_restore": 0, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 8.514102564102567, "ram_util_percent": 40.80000000000002}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1026.029765251664, "episode_reward_mean": 2015.6837166393293, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2083.805555709208, 1933.1602835959102, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.97485787625892, "mean_processing_ms": 1.3297018999252088, "mean_inference_ms": 0.6947619795006941}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 660000, "timers": {"learn_time_ms": 4.384, "learn_throughput": 14599.119, "update_time_ms": 0.736}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -75.992919921875, "critic_loss": 0.0033870271872729063, "mean_q": 75.8951416015625, "max_q": 99.48971557617188, "min_q": 49.61891555786133, "mean_td_error": -0.03907698392868042, "td_error": "[-0.22898102 -0.07885361  0.05564117  0.01068115  0.07007599 -0.03730011\n -0.11478424 -0.18814087 -0.05110168  0.01075745 -0.01124573  0.02159119\n  0.05708694 -0.0206604  -0.05580902 -0.04013062 -0.09527588 -0.08797455\n -0.14451599  0.01187515 -0.06984711 -0.10699081  0.01568222 -0.08524704\n -0.11580658  0.00051117  0.07672119 -0.0591507   0.00090027 -0.00370026\n -0.02360535 -0.0506134  -0.00263214 -0.00636292  0.00749207 -0.11710358\n -0.01091003  0.11689758 -0.11940002 -0.045784    0.0066452  -0.01089478\n -0.05520248 -0.0221405   0.00984955  0.03968811  0.04947662 -0.09046936\n -0.15555573 -0.11193848 -0.08044434  0.03231812 -0.03001404 -0.09635925\n -0.04838562 -0.06134033 -0.01634216 -0.19242096 -0.05757904  0.05954742\n -0.0557785  -0.02146912 -0.03275299 -0.04335022]"}}, "num_steps_sampled": 660000, "num_steps_trained": 42048064, "last_target_update_ts": 660000, "num_target_updates": 657001}, "done": false, "episodes_total": 220, "training_iteration": 220, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-25-41", "timestamp": 1609827941, "time_this_iter_s": 55.7950701713562, "time_total_s": 12016.731263160706, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d400>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 12016.731263160706, "timesteps_since_restore": 0, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 8.926582278481016, "ram_util_percent": 40.80000000000002}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1026.029765251664, "episode_reward_mean": 2019.7659867830807, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2341.387297971071, 2650.1807029102674, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.975650626032121, "mean_processing_ms": 1.3298030610150056, "mean_inference_ms": 0.694976977911131}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 663000, "timers": {"learn_time_ms": 4.224, "learn_throughput": 15151.977, "update_time_ms": 0.727}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -74.71510314941406, "critic_loss": 0.0033797051291912794, "mean_q": 74.61283111572266, "max_q": 97.24468994140625, "min_q": 45.12893295288086, "mean_td_error": -0.031326353549957275, "td_error": "[ 0.00335693  0.07050323 -0.00177002 -0.0749054  -0.00380707 -0.00637054\n -0.06691742 -0.09270477 -0.01313782  0.03531647 -0.08483887 -0.13002777\n  0.00231171 -0.10546875  0.13968658 -0.00511169 -0.03236389 -0.11284637\n -0.04211426 -0.01818848  0.05376434  0.02191162 -0.1405487  -0.10494995\n -0.00667572 -0.12006378 -0.13608551 -0.03659821  0.02359009 -0.02038956\n -0.00205994 -0.01921844 -0.04663086 -0.09204865 -0.12690735 -0.18074799\n -0.03621674 -0.11460114 -0.15676117 -0.0644989   0.11067963 -0.10307693\n -0.03752518  0.05647278 -0.11660767 -0.01381683  0.11572266 -0.03087616\n -0.09380341 -0.10155487 -0.05741882  0.02077484 -0.00782776  0.07645416\n  0.07740021  0.04404449 -0.0296402   0.05580902  0.05194855 -0.10655594\n -0.04174805 -0.0666008  -0.00138092  0.03937531]"}}, "num_steps_sampled": 663000, "num_steps_trained": 42240064, "last_target_update_ts": 663000, "num_target_updates": 660001}, "done": false, "episodes_total": 221, "training_iteration": 221, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-26-37", "timestamp": 1609827997, "time_this_iter_s": 56.31644344329834, "time_total_s": 12073.047706604004, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54dbf8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 12073.047706604004, "timesteps_since_restore": 0, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 10.44814814814815, "ram_util_percent": 40.85925925925926}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1026.029765251664, "episode_reward_mean": 2015.2726785180578, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2200.8498764079895, 2342.750950623029, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.976424347209543, "mean_processing_ms": 1.3299051317493527, "mean_inference_ms": 0.6951899844634221}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 666000, "timers": {"learn_time_ms": 4.24, "learn_throughput": 15093.787, "update_time_ms": 0.767}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -74.05596923828125, "critic_loss": 0.0022223428823053837, "mean_q": 73.95453643798828, "max_q": 98.46920013427734, "min_q": 36.412750244140625, "mean_td_error": 0.010365307331085205, "td_error": "[ 0.16028214  0.05747604  0.0681076   0.0666008   0.14089966 -0.00341797\n -0.03069305 -0.06011581  0.11878967  0.10808563 -0.05910492 -0.05910492\n -0.06933594  0.00458527  0.07657623 -0.07363129  0.04672241  0.02901459\n  0.03320312 -0.12297058  0.07259369 -0.04440308 -0.03328705 -0.06393433\n  0.02487946 -0.02441025  0.06143951  0.0282402  -0.00244141  0.00949097\n  0.15896225 -0.02696991 -0.01132202 -0.1086731   0.0318985   0.01378632\n  0.05063629  0.05121613  0.08863831 -0.04190063  0.01282501 -0.04336548\n  0.03911591 -0.0704155   0.00735474 -0.04667664 -0.00518799  0.04045105\n  0.01839066  0.05117035 -0.010849    0.04327393 -0.03804779 -0.02167511\n  0.0883255  -0.05821991  0.02542877 -0.03647614  0.01858902  0.02657318\n  0.01472855 -0.01378632 -0.0342865  -0.01026917]"}}, "num_steps_sampled": 666000, "num_steps_trained": 42432064, "last_target_update_ts": 666000, "num_target_updates": 663001}, "done": false, "episodes_total": 222, "training_iteration": 222, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-27-33", "timestamp": 1609828053, "time_this_iter_s": 56.1388156414032, "time_total_s": 12129.186522245407, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 12129.186522245407, "timesteps_since_restore": 0, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 8.903749999999999, "ram_util_percent": 40.775}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1026.029765251664, "episode_reward_mean": 2009.0754246303895, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1723.025561856211, 2073.5024420911536, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.977182467671237, "mean_processing_ms": 1.330005334816696, "mean_inference_ms": 0.6954029921390632}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 669000, "timers": {"learn_time_ms": 4.318, "learn_throughput": 14822.253, "update_time_ms": 0.743}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -70.64429473876953, "critic_loss": 0.0029781253542751074, "mean_q": 70.56861114501953, "max_q": 95.77710723876953, "min_q": 36.79423141479492, "mean_td_error": -0.019367635250091553, "td_error": "[-0.00640488  0.06938934 -0.04359436 -0.00817108 -0.11991119 -0.14739227\n  0.04934692 -0.03341293  0.05378723 -0.01067352 -0.01957703 -0.09746552\n -0.00179291  0.03966522 -0.0843811  -0.08843994 -0.05966187  0.0344696\n  0.01195526 -0.02742386  0.06557465 -0.05659103 -0.01882172 -0.00125122\n -0.03643417  0.01689148 -0.02885437  0.04499054  0.03266907  0.00391388\n  0.00327301 -0.03752899 -0.01867676  0.00157166 -0.0973587   0.3035431\n  0.05770874 -0.00694275  0.0535965   0.0079422  -0.12880707 -0.07683563\n -0.06529236 -0.06930542 -0.01066208  0.01711655 -0.12683105 -0.01657104\n -0.03967285 -0.02931595 -0.02086639 -0.07233429 -0.05418396 -0.14019012\n  0.00386429 -0.00710297  0.00106049  0.10160828 -0.15171814  0.04292297\n -0.01968384 -0.11626434 -0.03981018 -0.02017975]"}}, "num_steps_sampled": 669000, "num_steps_trained": 42624064, "last_target_update_ts": 669000, "num_target_updates": 666001}, "done": false, "episodes_total": 223, "training_iteration": 223, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-28-29", "timestamp": 1609828109, "time_this_iter_s": 56.016923904418945, "time_total_s": 12185.203446149826, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2c80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 12185.203446149826, "timesteps_since_restore": 0, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 10.236250000000002, "ram_util_percent": 41.0075}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1026.029765251664, "episode_reward_mean": 2003.0840782811533, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1474.367807167513, 1287.1780010113807, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.977922547234389, "mean_processing_ms": 1.3301025266476336, "mean_inference_ms": 0.6956146815207862}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 672000, "timers": {"learn_time_ms": 3.851, "learn_throughput": 16618.406, "update_time_ms": 0.703}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -72.53570556640625, "critic_loss": 0.0038594703655689955, "mean_q": 72.45576477050781, "max_q": 96.25668334960938, "min_q": 43.42595291137695, "mean_td_error": 0.06383311748504639, "td_error": "[ 0.01594543  0.07535934  0.03450012  0.04585266  0.0708313   0.12213135\n  0.1587677   0.10506439  0.03334045  0.04970551  0.0160675   0.16539764\n  0.03421783  0.05860901 -0.03596497 -0.03399658  0.1209259   0.01119995\n  0.09745407  0.00934601  0.10803986  0.00333405 -0.03373718  0.12916565\n  0.10588074  0.03480911  0.05274963  0.03581238  0.04231262 -0.02061081\n  0.10322571  0.03483582  0.18598175  0.03492737  0.06743622  0.16675568\n  0.05867004  0.1377945   0.04186249  0.07918549  0.14063263  0.08479309\n  0.06302643  0.1075058   0.11694336  0.04394531  0.00830841  0.04869843\n  0.00112152  0.10868835  0.07498169  0.07001495  0.07795715  0.06848907\n  0.09306335  0.0352478   0.0541153   0.13684082 -0.00595856  0.07707214\n  0.09387207  0.06105042  0.09345245 -0.09172821]"}}, "num_steps_sampled": 672000, "num_steps_trained": 42816064, "last_target_update_ts": 672000, "num_target_updates": 669001}, "done": false, "episodes_total": 224, "training_iteration": 224, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-29-24", "timestamp": 1609828164, "time_this_iter_s": 54.92115354537964, "time_total_s": 12240.124599695206, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2400>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 12240.124599695206, "timesteps_since_restore": 0, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 9.062820512820512, "ram_util_percent": 41.03076923076923}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1026.029765251664, "episode_reward_mean": 2010.9977293384675, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2078.543106742795, 2209.0755342138714, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.97866287692718, "mean_processing_ms": 1.3301963763352171, "mean_inference_ms": 0.6958249298316334}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 675000, "timers": {"learn_time_ms": 4.291, "learn_throughput": 14913.578, "update_time_ms": 0.685}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -75.60844421386719, "critic_loss": 0.0027551145758479834, "mean_q": 75.54037475585938, "max_q": 98.03614044189453, "min_q": 52.26258087158203, "mean_td_error": 0.004678249359130859, "td_error": "[ 0.08848572  0.00439835  0.03757477  0.02900696 -0.04740143 -0.04100037\n  0.07629776 -0.07180023 -0.03814697 -0.07730103  0.04304886 -0.1349945\n -0.01199341  0.13160706 -0.05521393  0.04527664  0.08995819  0.01384735\n  0.02855682 -0.02479553 -0.07724762 -0.01628494 -0.00570679  0.00518799\n -0.18658066  0.03629303  0.04098892 -0.07061386 -0.04221344  0.06138611\n  0.11027527  0.04462433  0.08364868  0.07284546 -0.11045837 -0.0031662\n -0.07465363 -0.00725555 -0.07536316  0.00880814 -0.00886536  0.1175766\n  0.13451385  0.04051971 -0.01366425  0.19616699 -0.0344162   0.02611542\n -0.02040482  0.00073624 -0.08930206  0.02528381 -0.11659241 -0.03405762\n  0.01022339 -0.01306152  0.06926727 -0.00259399 -0.05059052 -0.00978088\n  0.02062988  0.07946014  0.04384232  0.04847717]"}}, "num_steps_sampled": 675000, "num_steps_trained": 43008064, "last_target_update_ts": 675000, "num_target_updates": 672001}, "done": false, "episodes_total": 225, "training_iteration": 225, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-30-19", "timestamp": 1609828219, "time_this_iter_s": 55.104686975479126, "time_total_s": 12295.229286670685, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2d08>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 12295.229286670685, "timesteps_since_restore": 0, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 9.263291139240508, "ram_util_percent": 41.053164556962024}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1026.029765251664, "episode_reward_mean": 2008.0838078954332, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1917.6833899104238, 1994.1965328918413, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.979387409963563, "mean_processing_ms": 1.3302868101654093, "mean_inference_ms": 0.6960331684552217}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 678000, "timers": {"learn_time_ms": 4.187, "learn_throughput": 15285.626, "update_time_ms": 0.644}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -75.27823638916016, "critic_loss": 0.0024508910719305277, "mean_q": 75.15403747558594, "max_q": 97.19435119628906, "min_q": 33.63108825683594, "mean_td_error": 0.0223274827003479, "td_error": "[-0.02961731  0.05256653  0.0827713   0.09896851  0.04694366  0.08898544\n -0.07614899  0.13939667 -0.09353638 -0.03157043 -0.03655243 -0.07995605\n  0.01436615 -0.0066452   0.12491608  0.03608704  0.04831696 -0.05935669\n  0.11840057  0.01081467  0.02442169  0.04965591  0.0610733  -0.12635803\n  0.01546478 -0.05017853 -0.0304718   0.04399109  0.0500946   0.0345993\n  0.05043411  0.07139587  0.07368088 -0.00829697  0.02720642  0.07796478\n  0.049263   -0.02032471  0.02951813  0.10934448  0.02529144  0.0937767\n  0.01476669  0.19583893  0.01352692  0.00305939  0.02079773  0.02202606\n  0.01535797 -0.04199982  0.04653549  0.11205292 -0.02207947  0.00109482\n -0.02315521 -0.00295258 -0.03467941  0.09794617 -0.00415802 -0.09996796\n  0.00569153 -0.02374268  0.00209045  0.0302124 ]"}}, "num_steps_sampled": 678000, "num_steps_trained": 43200064, "last_target_update_ts": 678000, "num_target_updates": 675001}, "done": false, "episodes_total": 226, "training_iteration": 226, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-31-15", "timestamp": 1609828275, "time_this_iter_s": 55.41841149330139, "time_total_s": 12350.647698163986, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc51d268>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 12350.647698163986, "timesteps_since_restore": 0, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 9.363291139240504, "ram_util_percent": 41.12531645569619}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1026.029765251664, "episode_reward_mean": 2007.0748536649733, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1893.3011098458885, 2574.1031472621157, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.980100896170221, "mean_processing_ms": 1.3303734797956446, "mean_inference_ms": 0.6962397900625181}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 681000, "timers": {"learn_time_ms": 4.154, "learn_throughput": 15408.551, "update_time_ms": 0.679}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -72.28955841064453, "critic_loss": 0.0019180970266461372, "mean_q": 72.1861572265625, "max_q": 96.4365234375, "min_q": 42.38455581665039, "mean_td_error": 0.010696768760681152, "td_error": "[ 3.8394928e-02  4.2495728e-03 -9.4085693e-02  4.8992157e-02\n -6.7008972e-02  3.6926270e-02  5.5122375e-03  4.7325134e-02\n -1.2248993e-01 -5.2448273e-02  9.2720032e-02 -5.0163269e-02\n  4.6844482e-02 -7.3493958e-02 -1.5075684e-02  3.6933899e-02\n  8.9942932e-02 -2.4703979e-02  2.0980835e-02  1.9401550e-02\n -1.1451721e-02  1.2069702e-02  1.3427734e-02 -5.5404663e-02\n  6.7749023e-02  4.8019409e-02 -1.0185242e-02 -8.5693359e-02\n  6.9694519e-02  1.8592834e-02 -6.4239502e-03 -5.4473877e-03\n  1.2184143e-01 -3.7879944e-02  8.9073181e-03  8.5083008e-02\n -3.8108826e-03  5.7209015e-02 -1.2399292e-01  4.9018860e-02\n -2.3246765e-02  5.4733276e-02 -3.2409668e-02  3.6857605e-02\n  6.1859131e-02  7.9650879e-02  5.3710938e-02 -1.3694763e-02\n -6.5452576e-02  1.2756348e-02  8.2679749e-02 -4.8526764e-02\n  6.4750671e-02  3.2341003e-02  1.9729614e-02 -1.0299683e-02\n -1.3729095e-02  1.0482788e-02  2.2274017e-02  4.5486450e-02\n -6.1035156e-05 -2.6885986e-02 -1.8539429e-03  1.4336395e-01]"}}, "num_steps_sampled": 681000, "num_steps_trained": 43392064, "last_target_update_ts": 681000, "num_target_updates": 678001}, "done": false, "episodes_total": 227, "training_iteration": 227, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-32-10", "timestamp": 1609828330, "time_this_iter_s": 55.14983916282654, "time_total_s": 12405.797537326813, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a27b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 12405.797537326813, "timesteps_since_restore": 0, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 8.739743589743588, "ram_util_percent": 40.52692307692308}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1026.029765251664, "episode_reward_mean": 1997.8482901924954, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1651.4468000143213, 1026.029765251664, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.980788253805098, "mean_processing_ms": 1.330461632284066, "mean_inference_ms": 0.6964440561405622}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 684000, "timers": {"learn_time_ms": 4.159, "learn_throughput": 15386.56, "update_time_ms": 0.699}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -76.03389739990234, "critic_loss": 0.006683877669274807, "mean_q": 75.9517822265625, "max_q": 94.89532470703125, "min_q": 50.9592399597168, "mean_td_error": -0.08728569746017456, "td_error": "[-0.07497406 -0.17731476 -0.15857697 -0.12875366 -0.18891907 -0.11638641\n -0.05136871 -0.11515427 -0.03486633 -0.16218567 -0.12711334 -0.21317291\n -0.11548233 -0.06299591 -0.07050323  0.1236496  -0.10477829 -0.04065704\n -0.08403778 -0.04178619 -0.09344101 -0.07353973 -0.03450775 -0.08687592\n -0.10092163 -0.1182251  -0.13105011 -0.13282776 -0.0750618  -0.15210724\n -0.03562546 -0.17944336 -0.07479858 -0.06842804 -0.18626022  0.01794434\n -0.11458206 -0.01697922 -0.07532501 -0.16365051 -0.0430336  -0.14839172\n -0.15291595  0.0929184  -0.16677094 -0.051651    0.05709839  0.00296783\n -0.05921936 -0.06830597 -0.10430145 -0.03987885 -0.13005829 -0.00302124\n -0.1067276  -0.09122467 -0.22505188 -0.06263733  0.03070068 -0.00396729\n -0.1693573  -0.00209045 -0.20201111 -0.09827042]"}}, "num_steps_sampled": 684000, "num_steps_trained": 43584064, "last_target_update_ts": 684000, "num_target_updates": 681001}, "done": false, "episodes_total": 228, "training_iteration": 228, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-33-05", "timestamp": 1609828385, "time_this_iter_s": 54.92737364768982, "time_total_s": 12460.724910974503, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d0d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 12460.724910974503, "timesteps_since_restore": 0, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 9.606329113924051, "ram_util_percent": 40.73164556962026}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2004.8354850743424, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1724.7492534363578, 1451.0960005428904, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.9814818679138435, "mean_processing_ms": 1.3305483246019687, "mean_inference_ms": 0.696647917876226}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 687000, "timers": {"learn_time_ms": 4.357, "learn_throughput": 14687.385, "update_time_ms": 0.684}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -73.50028228759766, "critic_loss": 0.0027398739475756884, "mean_q": 73.39840698242188, "max_q": 95.50337219238281, "min_q": 42.21238327026367, "mean_td_error": -0.02036339044570923, "td_error": "[-0.02545929 -0.00794983  0.01648712  0.07711792  0.11114502 -0.00363159\n  0.01137924  0.03077698 -0.10088348 -0.00907898 -0.01856232 -0.08149719\n -0.1089859  -0.07618713 -0.02709961 -0.04155731  0.04899597 -0.03096008\n -0.08997726 -0.19381714  0.09335327 -0.03372955 -0.04582977 -0.051651\n  0.0448761  -0.02614975 -0.04135132  0.09049988 -0.03243637  0.03168488\n  0.05345917  0.00645447 -0.06488037 -0.07162857 -0.02520752 -0.14376068\n -0.11533356 -0.1672287  -0.14305115 -0.05212402 -0.01449966  0.00351334\n -0.0007019   0.10506439  0.00384521  0.05669403 -0.03915787 -0.09825897\n -0.06246948  0.02209473  0.01200867 -0.07064056 -0.05979538 -0.04415131\n -0.07237244  0.06893158  0.00811768  0.04823303  0.01486206  0.05303955\n  0.0206604  -0.05955505 -0.06233978  0.07740021]"}}, "num_steps_sampled": 687000, "num_steps_trained": 43776064, "last_target_update_ts": 687000, "num_target_updates": 684001}, "done": false, "episodes_total": 229, "training_iteration": 229, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-34-00", "timestamp": 1609828440, "time_this_iter_s": 55.64134669303894, "time_total_s": 12516.366257667542, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54dc80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 12516.366257667542, "timesteps_since_restore": 0, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 10.90632911392405, "ram_util_percent": 40.937974683544304}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2014.9660994945175, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2464.1574425603785, 1346.724523506024, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.982178314197642, "mean_processing_ms": 1.3306347830290306, "mean_inference_ms": 0.6968511415919443}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 690000, "timers": {"learn_time_ms": 4.252, "learn_throughput": 15050.627, "update_time_ms": 0.724}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -76.56696319580078, "critic_loss": 0.0024083643220365047, "mean_q": 76.48096466064453, "max_q": 94.15541076660156, "min_q": 42.187713623046875, "mean_td_error": 0.020853519439697266, "td_error": "[ 0.05696869  0.13013458 -0.04130554  0.05490494  0.01660919  0.05299377\n -0.07413483 -0.05992889  0.01078796  0.0238266   0.08412933  0.01990509\n -0.03805542  0.06534576 -0.02518463  0.07958221  0.05648041  0.08670425\n -0.01647949 -0.0541687   0.02634048 -0.05600739  0.11148834  0.13397217\n -0.03204346  0.06986237  0.08943176  0.04612732  0.07067871 -0.04685974\n -0.10151672 -0.08449936  0.05422974 -0.02809143  0.0226593   0.05195999\n -0.00644684 -0.00699615  0.055336   -0.01698303  0.05763245  0.10372925\n -0.02941895  0.06077576  0.06021881  0.00419617  0.03275299 -0.11233521\n  0.07144165  0.14032745 -0.08166504  0.01743317  0.01583862  0.08531952\n  0.0542984   0.01525879  0.02275467 -0.05780792 -0.0320816  -0.02859497\n  0.02015686 -0.03747559  0.04032898  0.12978363]"}}, "num_steps_sampled": 690000, "num_steps_trained": 43968064, "last_target_update_ts": 690000, "num_target_updates": 687001}, "done": false, "episodes_total": 230, "training_iteration": 230, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-34-56", "timestamp": 1609828496, "time_this_iter_s": 55.93418025970459, "time_total_s": 12572.300437927246, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d400>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 12572.300437927246, "timesteps_since_restore": 0, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 8.5475, "ram_util_percent": 40.91375}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2016.6005923729704, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1510.173811351318, 1847.427602587799, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.9828696755964605, "mean_processing_ms": 1.330721814984114, "mean_inference_ms": 0.6970518990904107}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 693000, "timers": {"learn_time_ms": 4.034, "learn_throughput": 15865.824, "update_time_ms": 0.637}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -74.65568542480469, "critic_loss": 0.002339692087844014, "mean_q": 74.56917572021484, "max_q": 96.95536804199219, "min_q": 41.267250061035156, "mean_td_error": 0.00279390811920166, "td_error": "[ 0.05747604 -0.04946136  0.02590179  0.07280731 -0.02120209  0.00806427\n  0.12120819  0.04183197 -0.08099365  0.08354187  0.20006561 -0.07419586\n  0.02721024  0.05008698  0.04357147 -0.06486511 -0.02890396  0.05143738\n  0.12646484 -0.03414917 -0.00211334 -0.01874542 -0.04715729 -0.02914429\n  0.02342987 -0.00881195 -0.01636505 -0.05935669  0.0352211   0.07187653\n  0.07077408 -0.0250473   0.1109848  -0.02750397  0.04509735  0.09664154\n -0.090271   -0.00772858 -0.02972412  0.1055069   0.09869385 -0.00961304\n -0.0115242   0.02370071 -0.03105164 -0.08093262 -0.10221863 -0.06301117\n -0.06088257 -0.0595932   0.0117569  -0.04633713  0.00302124 -0.00247192\n -0.05936432  0.05534363  0.03128052 -0.00350952 -0.10105133  0.00976562\n -0.07121277 -0.01641846 -0.01979065 -0.06922913]"}}, "num_steps_sampled": 693000, "num_steps_trained": 44160064, "last_target_update_ts": 693000, "num_target_updates": 690001}, "done": false, "episodes_total": 231, "training_iteration": 231, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-35-51", "timestamp": 1609828551, "time_this_iter_s": 54.75729441642761, "time_total_s": 12627.057732343674, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f7b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 12627.057732343674, "timesteps_since_restore": 0, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 8.26025641025641, "ram_util_percent": 40.94230769230769}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2014.1985763880978, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1607.226004100511, 2592.936574701262, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.983548140676994, "mean_processing_ms": 1.3308092558082634, "mean_inference_ms": 0.6972501588472859}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 696000, "timers": {"learn_time_ms": 4.321, "learn_throughput": 14809.824, "update_time_ms": 0.685}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -72.76873016357422, "critic_loss": 0.012329055927693844, "mean_q": 72.67655181884766, "max_q": 95.0409927368164, "min_q": 40.90018844604492, "mean_td_error": -0.015548467636108398, "td_error": "[ 0.15286255  0.04718781  0.07698822 -0.05561066  0.05461121  0.05540466\n -0.01455688 -0.13804626 -0.07798767 -0.01669312  0.02575684 -0.02422333\n  0.00731659  0.00856018  0.04325867  0.04534912 -0.04776764 -0.04674149\n  0.01430511 -0.04853058  0.0017662   0.04428482  0.01506424  0.05590439\n  0.04735565  0.00874329  0.04270935 -0.07888794 -0.01112366  0.06194687\n -0.02662659  0.08600616  0.00675201 -0.08482361 -0.08681488  0.00728607\n  0.02194595 -0.04747772  0.01908493 -0.10266876 -0.08262634  0.00405884\n  0.0694046   0.08567047 -0.06240082 -0.09940338 -1.1288681   0.01360321\n  0.10496902  0.01380157  0.01398468  0.01966858 -0.02819824 -0.05296707\n -0.13770294 -0.09121704  0.08452606 -0.01815033 -0.06764221  0.12992096\n  0.02845764 -0.00306702  0.04634857  0.12085724]"}}, "num_steps_sampled": 696000, "num_steps_trained": 44352064, "last_target_update_ts": 696000, "num_target_updates": 693001}, "done": false, "episodes_total": 232, "training_iteration": 232, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-36-46", "timestamp": 1609828606, "time_this_iter_s": 54.66998243331909, "time_total_s": 12681.727714776993, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fa60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 12681.727714776993, "timesteps_since_restore": 0, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 8.469230769230771, "ram_util_percent": 41.0}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2012.9954080301825, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2472.619738909729, 1277.0003366635679, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.984211892906961, "mean_processing_ms": 1.3308936517008831, "mean_inference_ms": 0.6974474402246666}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 699000, "timers": {"learn_time_ms": 4.49, "learn_throughput": 14254.749, "update_time_ms": 0.74}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -76.36613464355469, "critic_loss": 0.006784282624721527, "mean_q": 76.26587677001953, "max_q": 96.6031723022461, "min_q": 48.49248504638672, "mean_td_error": 0.0907977819442749, "td_error": "[ 0.2056427   0.08734131  0.09562683  0.09204865  0.17951965  0.06497192\n  0.04203796  0.12132263 -0.07357788  0.07801056  0.04838562  0.15268707\n  0.0969162   0.15536499  0.13132858  0.02072906  0.01544189  0.01628113\n  0.21938705  0.04077148  0.05030441  0.15982056  0.05592346  0.09727478\n  0.16065216  0.04336548 -0.06355286  0.10199738  0.20970154  0.15814972\n  0.09146118  0.13587952  0.03192902  0.22802734  0.1592102   0.11576462\n  0.07439041  0.06800842  0.06204987  0.1745758   0.1683197   0.18156433\n  0.00911713  0.13233185  0.1099472   0.00988007  0.05496216 -0.04748535\n  0.10836029  0.04780197 -0.03517914  0.15454102  0.12343597  0.12197113\n  0.12394714  0.13357544  0.02332306  0.04980469  0.02674866  0.07661438\n  0.03085327  0.03186798  0.15515137  0.11443329]"}}, "num_steps_sampled": 699000, "num_steps_trained": 44544064, "last_target_update_ts": 699000, "num_target_updates": 696001}, "done": false, "episodes_total": 233, "training_iteration": 233, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-37-41", "timestamp": 1609828661, "time_this_iter_s": 55.42428731918335, "time_total_s": 12737.152002096176, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f950>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 12737.152002096176, "timesteps_since_restore": 0, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 8.574683544303797, "ram_util_percent": 41.0}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2019.417980223941, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1919.2575560394316, 2300.556084883419, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.984874442265385, "mean_processing_ms": 1.330977097338287, "mean_inference_ms": 0.6976423958367041}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 702000, "timers": {"learn_time_ms": 4.23, "learn_throughput": 15129.346, "update_time_ms": 0.686}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -74.24430084228516, "critic_loss": 0.009770767763257027, "mean_q": 74.1759262084961, "max_q": 95.92298889160156, "min_q": 48.93522644042969, "mean_td_error": -0.10869574546813965, "td_error": "[-0.06256866 -0.15596771 -0.00443268 -0.20392609 -0.10534668 -0.02004242\n -0.01981354 -0.23143768 -0.1603241  -0.08478546 -0.19709778 -0.06290436\n -0.1713028   0.0406723   0.12831497 -0.07666016 -0.00107574  0.08869934\n -0.03404236 -0.12719727 -0.18254852 -0.04507446 -0.17674637 -0.10361481\n -0.20749664 -0.21000671  0.07652283 -0.10456467 -0.20750427 -0.03540802\n  0.0070343  -0.15274811 -0.03747559 -0.12220764 -0.13241577 -0.17100525\n -0.11692047 -0.06165314 -0.18684387 -0.05966187 -0.25360107 -0.1688919\n -0.11301422 -0.19498444 -0.19244003 -0.08773041 -0.17636108 -0.11400604\n -0.1482315  -0.16311646 -0.18257904 -0.10086823 -0.09802246 -0.19851685\n  0.07627106 -0.03687668 -0.13135529 -0.11750031 -0.09301376 -0.13174057\n -0.16475677 -0.19116211 -0.19010925 -0.09234238]"}}, "num_steps_sampled": 702000, "num_steps_trained": 44736064, "last_target_update_ts": 702000, "num_target_updates": 699001}, "done": false, "episodes_total": 234, "training_iteration": 234, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-38-37", "timestamp": 1609828717, "time_this_iter_s": 55.40882992744446, "time_total_s": 12792.56083202362, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc4f7268>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 12792.56083202362, "timesteps_since_restore": 0, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 8.38101265822785, "ram_util_percent": 41.0}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2016.7102397077285, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2029.7820332621882, 1608.7032745194804, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.98552195125788, "mean_processing_ms": 1.33105931484598, "mean_inference_ms": 0.6978351192345318}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 705000, "timers": {"learn_time_ms": 4.097, "learn_throughput": 15622.789, "update_time_ms": 0.747}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -74.84159851074219, "critic_loss": 0.002667310880497098, "mean_q": 74.7635726928711, "max_q": 99.78113555908203, "min_q": 37.1630744934082, "mean_td_error": 0.011748015880584717, "td_error": "[ 0.0609436   0.10129547  0.00682831  0.02476883 -0.01836395 -0.07723999\n -0.00354004 -0.02290344  0.00791168  0.03399658 -0.09741211  0.01120758\n -0.00588989  0.01065445 -0.00965881  0.05442429 -0.04176331 -0.03101349\n  0.07206726  0.04734802  0.00278854 -0.06347656 -0.00810242  0.08649826\n -0.00153351  0.06861877 -0.02963257 -0.01931381 -0.16488647  0.07814026\n  0.01726151  0.08552551  0.05104065  0.07946777  0.02822113  0.11003113\n  0.07685089 -0.03221893  0.1131897  -0.02721405  0.0305481   0.20361328\n -0.02346039 -0.05529022 -0.02322388 -0.05524445  0.06082916 -0.01854706\n  0.00147247  0.0782547  -0.03717041  0.12435532 -0.0304184  -0.14866638\n -0.02638245 -0.0369873   0.00341034 -0.0097084   0.00352097  0.09170532\n  0.17177582 -0.08479309 -0.01149368 -0.03114319]"}}, "num_steps_sampled": 705000, "num_steps_trained": 44928064, "last_target_update_ts": 705000, "num_target_updates": 702001}, "done": false, "episodes_total": 235, "training_iteration": 235, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-39-32", "timestamp": 1609828772, "time_this_iter_s": 54.896838665008545, "time_total_s": 12847.45767068863, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f048>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 12847.45767068863, "timesteps_since_restore": 0, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 8.584615384615384, "ram_util_percent": 41.0}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2018.054134498293, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1743.0927535759215, 2500.30267327401, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.98616899773598, "mean_processing_ms": 1.331142964714912, "mean_inference_ms": 0.6980269555604279}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 708000, "timers": {"learn_time_ms": 4.53, "learn_throughput": 14127.81, "update_time_ms": 0.629}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -74.05963897705078, "critic_loss": 0.00246399431489408, "mean_q": 73.98237609863281, "max_q": 97.32625579833984, "min_q": 39.882568359375, "mean_td_error": -0.001440882682800293, "td_error": "[-0.04597473 -0.03164673  0.03153992  0.02392578 -0.04780197 -0.04450226\n -0.06395721 -0.03665924 -0.05473709  0.05394745 -0.03611755  0.02792358\n  0.07304764  0.1945343  -0.05052185 -0.05422974  0.10715485 -0.05657959\n  0.11937714 -0.05013275  0.07966614 -0.07736206 -0.07038879  0.02024841\n  0.12560272 -0.13059235  0.0324173  -0.03385925 -0.06895447  0.01725388\n -0.00363922 -0.04998016  0.03395081 -0.07010651 -0.05558014  0.06067276\n  0.08460236 -0.05828094  0.00099945  0.16986084  0.08617401  0.08383179\n -0.01451874  0.02233124 -0.01320648 -0.02424622 -0.05475616 -0.06548309\n  0.02129364  0.00370026 -0.01024628 -0.02114105 -0.00611496  0.01709747\n -0.05042267 -0.06856537  0.08448029 -0.02425766 -0.03985596 -0.01361847\n -0.01144028 -0.09028625 -0.02422333  0.05613708]"}}, "num_steps_sampled": 708000, "num_steps_trained": 45120064, "last_target_update_ts": 708000, "num_target_updates": 705001}, "done": false, "episodes_total": 236, "training_iteration": 236, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-40-28", "timestamp": 1609828828, "time_this_iter_s": 56.08219361305237, "time_total_s": 12903.539864301682, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d9d8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 12903.539864301682, "timesteps_since_restore": 0, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 10.625, "ram_util_percent": 41.0}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2013.3142091841391, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2026.3101418586573, 2418.324268453947, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.986799236568734, "mean_processing_ms": 1.3312240970127633, "mean_inference_ms": 0.6982169644186704}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 711000, "timers": {"learn_time_ms": 3.705, "learn_throughput": 17272.505, "update_time_ms": 0.662}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -74.48558044433594, "critic_loss": 0.0038966399151831865, "mean_q": 74.38194274902344, "max_q": 98.64706420898438, "min_q": 43.7796745300293, "mean_td_error": 0.03301268815994263, "td_error": "[ 0.03456116 -0.0572052   0.02362061  0.07363892  0.10815811 -0.03521729\n -0.03370667  0.19439697 -0.05375671  0.09350204  0.01248169 -0.00736618\n -0.07871246 -0.04367065  0.06209564  0.00427246  0.06949615  0.09785461\n  0.14517212 -0.00260925  0.04127121  0.00698471  0.18318939  0.07115173\n  0.01704025 -0.01673889  0.24825287  0.0012207  -0.09600067  0.17704773\n  0.09889221 -0.05937195  0.01212692  0.03944397  0.00465393 -0.02229309\n -0.04795074 -0.03681183  0.04891205  0.11689758 -0.01167297 -0.12390137\n -0.04541779  0.05023193  0.09324646 -0.03958893 -0.05947113  0.08569336\n  0.03964233  0.08227539 -0.00039673  0.00812531 -0.0020256  -0.02794266\n  0.13793564  0.07257843  0.00792694  0.14227295  0.1181488   0.15136719\n  0.03562927 -0.04254532  0.1113472  -0.06557083]"}}, "num_steps_sampled": 711000, "num_steps_trained": 45312064, "last_target_update_ts": 711000, "num_target_updates": 708001}, "done": false, "episodes_total": 237, "training_iteration": 237, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-41-23", "timestamp": 1609828883, "time_this_iter_s": 55.19632863998413, "time_total_s": 12958.736192941666, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d7b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 12958.736192941666, "timesteps_since_restore": 0, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 8.724050632911396, "ram_util_percent": 41.00632911392405}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2006.8798625396987, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1774.8896040099157, 1381.279854987665, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.987405210927196, "mean_processing_ms": 1.3313062289493975, "mean_inference_ms": 0.6984044303774121}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 714000, "timers": {"learn_time_ms": 4.247, "learn_throughput": 15067.692, "update_time_ms": 0.69}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -73.96857452392578, "critic_loss": 0.003540937788784504, "mean_q": 73.89794158935547, "max_q": 94.82070922851562, "min_q": 49.92564010620117, "mean_td_error": -0.006979525089263916, "td_error": "[ 0.0970459  -0.05866241 -0.04649353  0.02885056 -0.05001831 -0.10287857\n  0.02101135  0.07197571 -0.07339478 -0.16075134 -0.00628662 -0.06177521\n -0.04548645  0.04508591  0.24196625  0.0774765  -0.01959229 -0.03660583\n  0.04145813  0.05852509  0.0459404   0.02174377 -0.04788971 -0.16962433\n -0.09975052 -0.05821991 -0.00695801 -0.02746582 -0.04222107  0.0098114\n -0.02008057 -0.06858063  0.01224136 -0.09613037 -0.0711441   0.03179169\n -0.03149414  0.01640701  0.03115845 -0.04646301  0.08392334  0.00531769\n -0.04445648  0.01069641 -0.08853912  0.15100098  0.01792908  0.04824066\n  0.10984039 -0.15560913  0.09380341  0.26940155  0.02035904  0.02957153\n -0.04286194 -0.05679321 -0.04039001 -0.06757355 -0.06439972  0.01598358\n -0.00578308 -0.06708145 -0.00526428 -0.06852722]"}}, "num_steps_sampled": 714000, "num_steps_trained": 45504064, "last_target_update_ts": 714000, "num_target_updates": 711001}, "done": false, "episodes_total": 238, "training_iteration": 238, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-42-18", "timestamp": 1609828938, "time_this_iter_s": 55.069594383239746, "time_total_s": 13013.805787324905, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d0d0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 13013.805787324905, "timesteps_since_restore": 0, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 8.81139240506329, "ram_util_percent": 41.077215189873414}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2020.5017377720362, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2743.4673782214154, 1898.3507175136865, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.9880206030117415, "mean_processing_ms": 1.331388638392307, "mean_inference_ms": 0.6985920122109275}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 717000, "timers": {"learn_time_ms": 3.979, "learn_throughput": 16085.923, "update_time_ms": 0.677}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -70.02903747558594, "critic_loss": 0.0023669074289500713, "mean_q": 69.93577575683594, "max_q": 96.0998764038086, "min_q": 50.29195022583008, "mean_td_error": 0.010499894618988037, "td_error": "[ 0.01371765 -0.04769897 -0.03559875  0.03532791  0.02188873 -0.03118896\n  0.08315277  0.0662117   0.13977051 -0.04566193  0.04861069  0.03361511\n -0.07089996  0.00354767  0.00202942 -0.08011627  0.02674103 -0.11969757\n -0.09915924  0.0449295  -0.06033325  0.03901672 -0.02222443 -0.05080414\n -0.04560089  0.07040787 -0.03337097  0.05669403 -0.03432465  0.09254837\n -0.0250473   0.09683228 -0.03427887  0.14013672  0.07894135  0.13400269\n -0.02178955 -0.02796936 -0.03222275  0.03237915  0.03713226 -0.02279663\n -0.08864594 -0.06711197 -0.03258896  0.05833435  0.03607178  0.01489258\n  0.12257385 -0.09396362 -0.00152588  0.01266479 -0.00360107  0.01896286\n  0.13707352  0.00901413 -0.04908371  0.03955841  0.11598206  0.01947021\n -0.00566101 -0.02550125  0.05601501  0.04221344]"}}, "num_steps_sampled": 717000, "num_steps_trained": 45696064, "last_target_update_ts": 717000, "num_target_updates": 714001}, "done": false, "episodes_total": 239, "training_iteration": 239, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-43-15", "timestamp": 1609828995, "time_this_iter_s": 56.80388569831848, "time_total_s": 13070.609673023224, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a22f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 13070.609673023224, "timesteps_since_restore": 0, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 9.228395061728396, "ram_util_percent": 41.1}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2019.980010613092, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1846.1780016192542, 1294.9200160818639, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.988621967983717, "mean_processing_ms": 1.3314705669785745, "mean_inference_ms": 0.6987754352269502}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 720000, "timers": {"learn_time_ms": 4.538, "learn_throughput": 14103.76, "update_time_ms": 0.721}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -71.51829528808594, "critic_loss": 0.002605430083349347, "mean_q": 71.43954467773438, "max_q": 96.31195831298828, "min_q": 44.4896125793457, "mean_td_error": -0.00027483701705932617, "td_error": "[ 0.03175354  0.07868195 -0.07230377 -0.01988983  0.05070496  0.09136963\n  0.05845642 -0.03106689  0.09924316 -0.1548233  -0.04460144  0.0477829\n  0.02992249  0.05934143 -0.08428192  0.02931976  0.03816986 -0.0242691\n  0.02702332 -0.03016663 -0.04325867 -0.03904724 -0.11482239 -0.09589386\n -0.03016663  0.01817322 -0.0318222   0.06591415  0.0619278   0.01062012\n -0.05998611  0.07505035  0.07671738 -0.07875061 -0.08188248  0.07553101\n -0.01322937 -0.00526428  0.03497696 -0.00710297  0.02526093  0.02442169\n -0.05416107  0.06752014 -0.05635071  0.02864075  0.00761414 -0.00737762\n -0.06264496  0.04633713 -0.02283478  0.19140625 -0.04970551 -0.02025223\n -0.05482483  0.03386688 -0.20816803  0.01691437  0.11752319 -0.00966644\n -0.03313828 -0.0827179   0.05292511  0.03377151]"}}, "num_steps_sampled": 720000, "num_steps_trained": 45888064, "last_target_update_ts": 720000, "num_target_updates": 717001}, "done": false, "episodes_total": 240, "training_iteration": 240, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-44-09", "timestamp": 1609829049, "time_this_iter_s": 54.72465753555298, "time_total_s": 13125.334330558777, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2ae8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 13125.334330558777, "timesteps_since_restore": 0, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 9.549999999999999, "ram_util_percent": 41.099999999999994}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2031.1060510409661, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2407.524058869236, 2434.2522875861764, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.9892281308693756, "mean_processing_ms": 1.3315516155010676, "mean_inference_ms": 0.6989551082298755}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 723000, "timers": {"learn_time_ms": 4.058, "learn_throughput": 15770.098, "update_time_ms": 0.583}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -77.08343505859375, "critic_loss": 0.00352919427677989, "mean_q": 77.01368713378906, "max_q": 98.14205169677734, "min_q": 37.83375549316406, "mean_td_error": 0.02749115228652954, "td_error": "[ 0.110466    0.05652618 -0.0235672   0.04898834 -0.03152084 -0.12892151\n  0.14006805  0.09377289 -0.03975677  0.09867096  0.03740692  0.09612274\n -0.00363922  0.02438354  0.02402496 -0.11821747  0.05573273  0.05021667\n -0.01109314 -0.02410889  0.09354401 -0.05950546  0.03577423  0.34059906\n -0.12976837  0.0297699   0.08367538 -0.0254364   0.03294373  0.07041931\n  0.00046539  0.13342285 -0.1177597   0.06338501  0.08557892  0.08452606\n  0.13158035 -0.00034332 -0.00133514  0.01393509  0.00833893  0.07376099\n -0.03107452  0.02857971 -0.01655579  0.05278778  0.03837585  0.11315918\n  0.06034851 -0.06509399  0.09308624  0.06066132 -0.00942993 -0.06050873\n -0.05120087  0.01194763  0.01069641  0.00514984 -0.05962372  0.0625\n  0.06604004  0.06378174  0.00624084 -0.02355957]"}}, "num_steps_sampled": 723000, "num_steps_trained": 46080064, "last_target_update_ts": 723000, "num_target_updates": 720001}, "done": false, "episodes_total": 241, "training_iteration": 241, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-45-05", "timestamp": 1609829105, "time_this_iter_s": 55.295323848724365, "time_total_s": 13180.629654407501, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2ea0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 13180.629654407501, "timesteps_since_restore": 0, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 9.451898734177215, "ram_util_percent": 39.37848101265822}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2022.460556457048, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1569.7028291943654, 2167.4695881102925, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.989811582945037, "mean_processing_ms": 1.331630663325569, "mean_inference_ms": 0.6991325883052047}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 726000, "timers": {"learn_time_ms": 3.986, "learn_throughput": 16054.848, "update_time_ms": 0.679}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -74.29521179199219, "critic_loss": 0.0036255735903978348, "mean_q": 74.21870422363281, "max_q": 98.90109252929688, "min_q": 43.9318962097168, "mean_td_error": -0.014777958393096924, "td_error": "[ 3.77731323e-02  6.95343018e-02 -1.37626648e-01 -4.11834717e-02\n  5.18264771e-02  7.53746033e-02  7.90100098e-02 -2.26593018e-02\n -8.87985229e-02 -6.14242554e-02  5.95092773e-03  3.12805176e-04\n -5.28717041e-03  1.11358643e-01 -4.47006226e-02  2.38304138e-02\n -2.08892822e-02  9.37652588e-03  2.62451172e-03 -8.89129639e-02\n -9.78622437e-02 -1.03332520e-01 -4.91828918e-02  2.16140747e-02\n  3.25012207e-03  4.20684814e-02 -5.97457886e-02  7.56759644e-02\n -1.00585938e-01 -1.08608246e-01  2.20642090e-02  3.56445312e-02\n  1.44088745e-01 -9.91821289e-05  1.75018311e-02 -4.15954590e-02\n  1.24084473e-01  8.54568481e-02 -2.88314819e-02 -1.21841431e-02\n -2.84797668e-01 -3.55453491e-02 -6.02569580e-02  2.86026001e-02\n  5.19790649e-02 -3.24516296e-02 -2.02903748e-02  2.33154297e-02\n -1.20521545e-01 -1.11869812e-01  2.05703735e-01 -9.20791626e-02\n  1.99546814e-02 -5.76705933e-02 -6.43157959e-02 -4.46395874e-02\n -8.19396973e-02 -1.89704895e-01 -7.31964111e-02 -3.84254456e-02\n  1.27029419e-03  3.24401855e-02 -2.21252441e-04  7.39593506e-02]"}}, "num_steps_sampled": 726000, "num_steps_trained": 46272064, "last_target_update_ts": 726000, "num_target_updates": 723001}, "done": false, "episodes_total": 242, "training_iteration": 242, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-46-00", "timestamp": 1609829160, "time_this_iter_s": 55.24460959434509, "time_total_s": 13235.874264001846, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2268>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 13235.874264001846, "timesteps_since_restore": 0, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 8.883544303797466, "ram_util_percent": 37.11518987341772}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2022.3530422277963, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2156.7181651851515, 2330.535776974537, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.990386656080672, "mean_processing_ms": 1.331709598029633, "mean_inference_ms": 0.6993085381219002}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 729000, "timers": {"learn_time_ms": 3.852, "learn_throughput": 16614.601, "update_time_ms": 0.673}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -75.43663787841797, "critic_loss": 0.003222588449716568, "mean_q": 75.34754943847656, "max_q": 97.09231567382812, "min_q": 50.29924011230469, "mean_td_error": -0.03971302509307861, "td_error": "[-0.00318146 -0.04656982 -0.02443695 -0.06012344 -0.01528168 -0.07017517\n -0.04182434  0.03313446 -0.027771   -0.09534454 -0.04060364 -0.01470184\n -0.11790466  0.03772736 -0.10005188  0.10414886 -0.07787323 -0.05918503\n -0.02867508 -0.065979   -0.0205307  -0.06027985 -0.02792358 -0.08691406\n -0.08015442 -0.150177    0.03186035 -0.06771088  0.05070496 -0.10597229\n  0.06519318  0.02635956 -0.03713989  0.05625916 -0.02386475 -0.09918594\n  0.02634811 -0.15966034 -0.00224686  0.06582642  0.02656555 -0.03212357\n -0.06781769  0.07826233 -0.10168457 -0.02117157 -0.08712769  0.05622864\n  0.04261017 -0.0355072  -0.04190826  0.01594543 -0.1510582  -0.09835052\n -0.02809143 -0.16338348 -0.17111206  0.03475952 -0.06730652 -0.09474945\n -0.12968445 -0.00764465 -0.10023499 -0.08316803]"}}, "num_steps_sampled": 729000, "num_steps_trained": 46464064, "last_target_update_ts": 729000, "num_target_updates": 726001}, "done": false, "episodes_total": 243, "training_iteration": 243, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-46-56", "timestamp": 1609829216, "time_this_iter_s": 55.59602379798889, "time_total_s": 13291.470287799835, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d6a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 13291.470287799835, "timesteps_since_restore": 0, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 9.360759493670884, "ram_util_percent": 37.19999999999998}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2025.780777208374, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2673.3092750322994, 2290.625546838484, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.990953294236089, "mean_processing_ms": 1.331785966180144, "mean_inference_ms": 0.6994817473594224}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 732000, "timers": {"learn_time_ms": 4.413, "learn_throughput": 14503.361, "update_time_ms": 0.628}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -72.95336151123047, "critic_loss": 0.005646728910505772, "mean_q": 72.86988830566406, "max_q": 96.00702667236328, "min_q": 46.35176467895508, "mean_td_error": 0.08002519607543945, "td_error": "[-0.00054169  0.05773926  0.03873444  0.03765106  0.1504898   0.1473465\n  0.07506561  0.03588867  0.21903229  0.18460846  0.05994415  0.07919693\n  0.26509857  0.12599182  0.07818604  0.03977203  0.10205841  0.03567505\n  0.16099548 -0.03861237  0.0117569   0.03141022  0.04979706  0.12485504\n  0.11289978  0.12674713  0.03313065  0.08444214 -0.01478577  0.10057831\n  0.10325623  0.08143616  0.0604248   0.0817337   0.17912292  0.09762192\n  0.09399414  0.12697983  0.08971024  0.10306549  0.0311203   0.06562805\n -0.04680634  0.09233856  0.04563141  0.12137222  0.09065247  0.14585114\n  0.02863312  0.01495361  0.11854553 -0.0806427   0.11398315  0.00270081\n  0.01951599  0.13565826  0.0913353   0.14940262  0.09328842  0.13124084\n -0.07509232  0.149086    0.04345703  0.10726166]"}}, "num_steps_sampled": 732000, "num_steps_trained": 46656064, "last_target_update_ts": 732000, "num_target_updates": 729001}, "done": false, "episodes_total": 244, "training_iteration": 244, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-47-51", "timestamp": 1609829271, "time_this_iter_s": 55.624552488327026, "time_total_s": 13347.094840288162, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54db70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 13347.094840288162, "timesteps_since_restore": 0, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 8.251898734177214, "ram_util_percent": 37.19999999999998}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2018.8634614201842, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1598.893968019466, 1838.938984735375, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.991497574537358, "mean_processing_ms": 1.3318598911155606, "mean_inference_ms": 0.6996513695391227}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 735000, "timers": {"learn_time_ms": 4.327, "learn_throughput": 14789.669, "update_time_ms": 0.735}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -70.26713562011719, "critic_loss": 0.0033367210999131203, "mean_q": 70.18682861328125, "max_q": 98.07489776611328, "min_q": 48.7314453125, "mean_td_error": 0.044017910957336426, "td_error": "[ 0.0292511  -0.00481033 -0.06555557  0.10271072  0.09257507 -0.01185608\n  0.07228851  0.01275635  0.07672119 -0.0627594   0.10791779  0.05725861\n  0.14009857  0.13920593  0.01203918  0.06603241  0.0473671   0.04107666\n -0.06223679  0.01867676 -0.00351715  0.0150032   0.07767868  0.04675293\n  0.05257034  0.04573822  0.06800842  0.02012634  0.09224701  0.20391083\n -0.07643509  0.08321381 -0.13640976  0.08654022 -0.0560379   0.19132233\n  0.04249573 -0.02742004  0.03394318  0.10951996  0.06789398  0.01079559\n  0.06143188  0.0504303   0.02916718  0.03538513  0.10414124  0.10629272\n  0.05244446  0.12882614 -0.0029068   0.08078003  0.07433319  0.00282669\n  0.01150513  0.02883148  0.04945755  0.01116943  0.13824463  0.06497955\n  0.0793457   0.0485611  -0.09167099 -0.00312805]"}}, "num_steps_sampled": 735000, "num_steps_trained": 46848064, "last_target_update_ts": 735000, "num_target_updates": 732001}, "done": false, "episodes_total": 245, "training_iteration": 245, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-48-46", "timestamp": 1609829326, "time_this_iter_s": 54.79656410217285, "time_total_s": 13401.891404390335, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d400>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 13401.891404390335, "timesteps_since_restore": 0, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 9.537179487179486, "ram_util_percent": 37.19999999999998}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2019.7030686720336, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1922.8997099203243, 2591.477636259695, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.992030025782773, "mean_processing_ms": 1.331932407209445, "mean_inference_ms": 0.6998177129412037}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 738000, "timers": {"learn_time_ms": 4.162, "learn_throughput": 15378.714, "update_time_ms": 0.644}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -74.13960266113281, "critic_loss": 0.009853537194430828, "mean_q": 74.06620788574219, "max_q": 95.12506103515625, "min_q": 51.36207962036133, "mean_td_error": 0.04919886589050293, "td_error": "[-0.03031158 -0.01268387 -0.05547333 -0.03514862  0.0400238   0.13578796\n  0.11522675  0.20218658  0.02629089  0.04776764  0.00396347  0.03452301\n  0.01220703  0.04327393 -0.80101013  0.06927872  0.12480164  0.11017609\n  0.08271027  0.05563354  0.07933044  0.09165192  0.05679321  0.04273224\n -0.03948975  0.13558197  0.18078613  0.01480103  0.00235748 -0.0289917\n  0.04364014  0.10245514  0.03704834  0.13330841  0.11255646 -0.05085754\n  0.10839844  0.0993042   0.07280731 -0.01822662  0.09755707  0.15072632\n  0.2037735   0.13408661  0.08011627  0.07305908  0.03903198  0.03508759\n -0.07402802  0.01026154  0.11746597  0.03961182  0.06054688  0.24367523\n -0.11044312 -0.02223969  0.15930176  0.16033554  0.02108002  0.1126709\n  0.02212524  0.15554428  0.03809357  0.05607605]"}}, "num_steps_sampled": 738000, "num_steps_trained": 47040064, "last_target_update_ts": 738000, "num_target_updates": 735001}, "done": false, "episodes_total": 246, "training_iteration": 246, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-49-41", "timestamp": 1609829381, "time_this_iter_s": 55.23342728614807, "time_total_s": 13457.124831676483, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f6a8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 13457.124831676483, "timesteps_since_restore": 0, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 9.173417721518986, "ram_util_percent": 37.20379746835441}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2016.6864496162075, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2289.815730677076, 2240.567844921512, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.992543112055528, "mean_processing_ms": 1.332002709834182, "mean_inference_ms": 0.6999816851594768}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 741000, "timers": {"learn_time_ms": 4.272, "learn_throughput": 14982.834, "update_time_ms": 0.749}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -74.83666229248047, "critic_loss": 0.0028790647629648447, "mean_q": 74.74720764160156, "max_q": 96.73271942138672, "min_q": 48.70317077636719, "mean_td_error": -0.012050330638885498, "td_error": "[-7.24563599e-02  1.58843994e-02 -1.02272034e-02 -7.30209351e-02\n -4.86984253e-02 -1.15013123e-01 -3.21655273e-02 -6.82830811e-03\n -1.76010132e-02  3.03573608e-02 -6.13937378e-02 -9.86785889e-02\n  9.85717773e-03  8.40492249e-02 -2.61993408e-02  4.24270630e-02\n  9.17816162e-03 -4.24804688e-02 -2.05993652e-04  1.61781311e-02\n -1.31080627e-01 -2.56195068e-02 -3.86047363e-02 -3.65715027e-02\n  3.79333496e-02 -3.04336548e-02  2.57453918e-02 -5.39016724e-02\n -2.40592957e-02  3.40251923e-01 -1.35803223e-02 -1.37786865e-02\n -5.90744019e-02 -2.12783813e-02 -1.21536255e-02  2.31781006e-02\n  2.74734497e-02 -3.87878418e-02 -1.59111023e-02 -7.06024170e-02\n  1.06880188e-01 -1.20735168e-02  2.25906372e-02 -1.10923767e-01\n -1.79283142e-01  1.56860352e-02  6.61468506e-02 -1.14822388e-03\n -1.87225342e-02  8.40911865e-02  2.28424072e-02 -3.68270874e-02\n -6.96945190e-02  6.86645508e-04  2.64129639e-02  6.96945190e-02\n -1.39083862e-02 -7.44628906e-02  2.25448608e-03 -7.84301758e-02\n -3.12347412e-02 -4.98504639e-02  9.46578979e-02 -7.87124634e-02]"}}, "num_steps_sampled": 741000, "num_steps_trained": 47232064, "last_target_update_ts": 741000, "num_target_updates": 738001}, "done": false, "episodes_total": 247, "training_iteration": 247, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-50-37", "timestamp": 1609829437, "time_this_iter_s": 55.73283505439758, "time_total_s": 13512.85766673088, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fc80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 13512.85766673088, "timesteps_since_restore": 0, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 9.98, "ram_util_percent": 37.40124999999999}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2013.5681110115909, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1928.7339844598832, 2397.5674737686113, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243, 2289.815730677076], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.993038422872525, "mean_processing_ms": 1.3320720025050616, "mean_inference_ms": 0.7001447110548007}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 744000, "timers": {"learn_time_ms": 4.877, "learn_throughput": 13122.706, "update_time_ms": 0.792}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -72.89832305908203, "critic_loss": 0.006804336793720722, "mean_q": 72.8167495727539, "max_q": 96.65249633789062, "min_q": 37.1192626953125, "mean_td_error": -0.0917978286743164, "td_error": "[-0.06937027 -0.08110809 -0.13131714  0.01799774 -0.13691711  0.05918121\n -0.10430527 -0.09108734 -0.12326813 -0.08551025 -0.08784103 -0.09708405\n -0.13610077 -0.09286499 -0.08566284 -0.16051483 -0.11660767 -0.13710785\n -0.10287476 -0.14785767 -0.08304214 -0.21642303 -0.07115936  0.07058716\n -0.06425476 -0.00272369 -0.05456543 -0.16096497 -0.12142944 -0.06387329\n -0.02005005 -0.17016602 -0.02594376 -0.10181427 -0.08023071  0.09305191\n -0.05159378 -0.09742355 -0.09228516 -0.06333923 -0.21925354 -0.13603973\n -0.15576935  0.11695862 -0.11493683 -0.07293701 -0.08995819 -0.11052704\n -0.15654755  0.00356293  0.00440979 -0.09075165 -0.099617   -0.09102631\n -0.11915588 -0.12591171 -0.090065   -0.15573883 -0.13479614 -0.17596054\n -0.1365509  -0.09139252 -0.1745987  -0.17059326]"}}, "num_steps_sampled": 744000, "num_steps_trained": 47424064, "last_target_update_ts": 744000, "num_target_updates": 741001}, "done": false, "episodes_total": 248, "training_iteration": 248, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-51-34", "timestamp": 1609829494, "time_this_iter_s": 57.1408371925354, "time_total_s": 13569.998503923416, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fd90>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 13569.998503923416, "timesteps_since_restore": 0, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 15.607407407407408, "ram_util_percent": 38.19999999999999}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2007.5368652415107, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1794.442896760602, 1721.296997597343, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243, 2289.815730677076, 1928.7339844598832], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.99351559183011, "mean_processing_ms": 1.332139854950806, "mean_inference_ms": 0.7003058744920181}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 747000, "timers": {"learn_time_ms": 4.337, "learn_throughput": 14755.2, "update_time_ms": 0.786}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -72.99644470214844, "critic_loss": 0.00338308815844357, "mean_q": 72.90357208251953, "max_q": 97.0425033569336, "min_q": 49.352516174316406, "mean_td_error": -0.0013970732688903809, "td_error": "[-0.02213287 -0.07079315  0.01831055  0.0255394  -0.03799438 -0.03557587\n  0.04621124  0.03802109  0.07040024  0.08558273  0.04711533 -0.04676819\n -0.03208542 -0.02481079 -0.13408661  0.10921097 -0.05358124 -0.01790619\n  0.07344818  0.00481415  0.13039398  0.05943298 -0.03647995 -0.03900146\n  0.00202942 -0.12380981  0.15441895  0.03313065  0.11340332  0.11715698\n -0.11450958  0.00174713 -0.01178741 -0.09050751 -0.03894043 -0.01034927\n  0.01472473 -0.02598572 -0.01552582 -0.17946625 -0.03154755  0.07836151\n -0.09055328 -0.01870728  0.01930237  0.18198395  0.06905365 -0.12941742\n -0.09153748 -0.00439453  0.06251526 -0.13137436  0.05418015 -0.06507111\n  0.13706207  0.01529694 -0.13734436 -0.08883667 -0.08044434  0.05934906\n  0.04439926  0.04685974  0.04081726 -0.01235962]"}}, "num_steps_sampled": 747000, "num_steps_trained": 47616064, "last_target_update_ts": 747000, "num_target_updates": 744001}, "done": false, "episodes_total": 249, "training_iteration": 249, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-52-31", "timestamp": 1609829551, "time_this_iter_s": 56.922062158584595, "time_total_s": 13626.920566082, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f598>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 13626.920566082, "timesteps_since_restore": 0, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 16.102469135802465, "ram_util_percent": 38.2604938271605}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2009.6270058796547, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1930.311061411739, 1863.5071008741188, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243, 2289.815730677076, 1928.7339844598832, 1794.442896760602], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.993990875083837, "mean_processing_ms": 1.3322066757622517, "mean_inference_ms": 0.7004656971694959}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 750000, "timers": {"learn_time_ms": 4.459, "learn_throughput": 14352.074, "update_time_ms": 0.793}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -73.60379791259766, "critic_loss": 0.003657034831121564, "mean_q": 73.51598358154297, "max_q": 96.92935943603516, "min_q": 42.27019500732422, "mean_td_error": -0.0195806622505188, "td_error": "[-0.15850067  0.03563309  0.01860046 -0.16532898  0.00536346  0.05028152\n -0.18508911 -0.0133667   0.05451202 -0.01941681 -0.13196564  0.12648773\n  0.13627625 -0.10514832 -0.0483017   0.02348328 -0.056427   -0.11766052\n -0.01348877 -0.00238037  0.06192398  0.14202881 -0.149086   -0.00731659\n -0.05412292 -0.11108398 -0.04064941  0.04970551 -0.03979492 -0.06716919\n  0.06827545  0.07036591  0.02402496 -0.0083313  -0.0909729   0.01131439\n  0.05532837 -0.03479767 -0.11074066 -0.10020828  0.04065704  0.06893158\n  0.08760452 -0.01969147 -0.02216721 -0.06382751  0.02289581 -0.10253906\n  0.03349304 -0.03744507 -0.07019806 -0.13406372 -0.06214905  0.14512634\n -0.04270935 -0.03087616 -0.02542114 -0.07440186 -0.13860321 -0.03484344\n -0.00230408  0.02371597  0.11923981 -0.0358429 ]"}}, "num_steps_sampled": 750000, "num_steps_trained": 47808064, "last_target_update_ts": 750000, "num_target_updates": 747001}, "done": false, "episodes_total": 250, "training_iteration": 250, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-53-28", "timestamp": 1609829608, "time_this_iter_s": 56.72736978530884, "time_total_s": 13683.64793586731, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d510>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 13683.64793586731, "timesteps_since_restore": 0, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 14.958024691358023, "ram_util_percent": 38.30000000000001}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2006.378068850688, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1538.6133979774231, 2282.495692775196, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243, 2289.815730677076, 1928.7339844598832, 1794.442896760602, 1930.311061411739], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.994459537819983, "mean_processing_ms": 1.3322708990278318, "mean_inference_ms": 0.7006240009243969}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 753000, "timers": {"learn_time_ms": 4.272, "learn_throughput": 14982.249, "update_time_ms": 0.704}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -74.62472534179688, "critic_loss": 0.0026241010054945946, "mean_q": 74.5317153930664, "max_q": 95.93181610107422, "min_q": 50.71731185913086, "mean_td_error": -0.0181083083152771, "td_error": "[ 0.02836609 -0.04220581 -0.01749039 -0.06565857  0.05513    -0.09886169\n -0.06161499 -0.09918213 -0.04303741  0.1015358   0.01552582 -0.085289\n -0.04418182 -0.10224152 -0.05469513 -0.09558868 -0.03247833 -0.00447083\n  0.00577545 -0.13957214 -0.0038147   0.01535797 -0.04184341  0.08605194\n -0.00960541 -0.01926422 -0.0821228  -0.06656647  0.04826355 -0.11702728\n  0.05468369 -0.06352234 -0.03501892  0.09925842 -0.08561707 -0.00920105\n  0.07649231  0.08127213  0.07454681 -0.15024567  0.03561401 -0.05596161\n -0.03825378  0.13011932 -0.02497864 -0.00461578  0.08209229 -0.08053589\n  0.02409363 -0.00353241 -0.09702301  0.03244781  0.01529694 -0.11624146\n  0.08327484 -0.01934052  0.02531433 -0.04230118 -0.02335358 -0.03238678\n -0.02256012 -0.06331635  0.04847717 -0.08310318]"}}, "num_steps_sampled": 753000, "num_steps_trained": 48000064, "last_target_update_ts": 753000, "num_target_updates": 750001}, "done": false, "episodes_total": 251, "training_iteration": 251, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-54-25", "timestamp": 1609829665, "time_this_iter_s": 57.39150643348694, "time_total_s": 13741.039442300797, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 13741.039442300797, "timesteps_since_restore": 0, "iterations_since_restore": 251, "perf": {"cpu_util_percent": 14.948780487804877, "ram_util_percent": 38.30609756097562}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2006.6135085715068, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2306.0396648570636, 1674.6516552741286, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243, 2289.815730677076, 1928.7339844598832, 1794.442896760602, 1930.311061411739, 1538.6133979774231], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.994919107712181, "mean_processing_ms": 1.3323332123348832, "mean_inference_ms": 0.7007801297068945}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 756000, "timers": {"learn_time_ms": 4.345, "learn_throughput": 14727.999, "update_time_ms": 0.639}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -71.0755615234375, "critic_loss": 0.003825283609330654, "mean_q": 71.01564025878906, "max_q": 95.84038543701172, "min_q": 39.90363311767578, "mean_td_error": 0.05259263515472412, "td_error": "[ 0.22203064  0.02968597  0.00226593  0.11519623  0.1243782   0.09905243\n  0.02999115  0.03113937  0.08701324  0.00080109 -0.04219818 -0.02313995\n  0.15422821  0.06406403  0.05500793  0.10955048  0.09833527  0.05664062\n  0.11640167  0.03661346  0.13803482  0.03604126 -0.0269928   0.00098419\n -0.00094604  0.10807037 -0.04004288 -0.06816101  0.00210571  0.08766174\n  0.07518387 -0.01821899  0.09801865  0.01112366  0.12071228 -0.02845764\n -0.00811005 -0.06561279  0.08903503  0.03199768 -0.01295471  0.169384\n  0.11125183  0.03594971  0.06759644  0.16806793  0.00601196 -0.03369141\n  0.0353775   0.19836807  0.01272202  0.07013702  0.08900452  0.00575256\n  0.06052399  0.05464554 -0.03759003  0.07740021  0.10790253  0.11956024\n  0.03249359 -0.00885773  0.07379913  0.05358887]"}}, "num_steps_sampled": 756000, "num_steps_trained": 48192064, "last_target_update_ts": 756000, "num_target_updates": 753001}, "done": false, "episodes_total": 252, "training_iteration": 252, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-55-23", "timestamp": 1609829723, "time_this_iter_s": 57.69567012786865, "time_total_s": 13798.735112428665, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d9d8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 13798.735112428665, "timesteps_since_restore": 0, "iterations_since_restore": 252, "perf": {"cpu_util_percent": 14.95421686746988, "ram_util_percent": 38.391566265060234}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2010.6411046071103, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2077.4112588344847, 1658.2489721629365, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243, 2289.815730677076, 1928.7339844598832, 1794.442896760602, 1930.311061411739, 1538.6133979774231, 2306.0396648570636], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.995374973874245, "mean_processing_ms": 1.3323968649502422, "mean_inference_ms": 0.7009348341996784}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 759000, "timers": {"learn_time_ms": 3.77, "learn_throughput": 16973.901, "update_time_ms": 0.726}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -71.32209777832031, "critic_loss": 0.003761759027838707, "mean_q": 71.25833892822266, "max_q": 96.15470886230469, "min_q": 43.505584716796875, "mean_td_error": -0.02853149175643921, "td_error": "[ 0.0495491   0.01171112  0.0073204  -0.0092926  -0.03240967 -0.08094025\n -0.1815567  -0.02508545  0.04866791 -0.01987457 -0.07647705 -0.02737045\n -0.03842163 -0.01700592 -0.03741837 -0.06723785  0.19535828  0.01455688\n  0.02910614 -0.1036377  -0.02359772 -0.06522369 -0.08197784 -0.0424881\n -0.04311371  0.08909607 -0.03260803 -0.11475754 -0.03643036 -0.06652832\n  0.12064362 -0.10925293  0.05679321  0.028862   -0.02950287  0.02377319\n  0.06819153 -0.01490784 -0.00433731 -0.17263031 -0.04548264 -0.00672913\n -0.07141113 -0.09786224 -0.14216614  0.11494064 -0.03369141  0.02910614\n -0.10309601 -0.00728607 -0.00292969 -0.18554688 -0.07779694  0.02810669\n  0.184021   -0.20762634 -0.0253067  -0.06845856 -0.05643845 -0.07501221\n -0.12721634  0.00473785 -0.00317764 -0.03923798]"}}, "num_steps_sampled": 759000, "num_steps_trained": 48384064, "last_target_update_ts": 759000, "num_target_updates": 756001}, "done": false, "episodes_total": 253, "training_iteration": 253, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-56-20", "timestamp": 1609829780, "time_this_iter_s": 57.028116941452026, "time_total_s": 13855.763229370117, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a27b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 13855.763229370117, "timesteps_since_restore": 0, "iterations_since_restore": 253, "perf": {"cpu_util_percent": 14.779012345679014, "ram_util_percent": 38.4}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2011.3063250689113, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1724.771018343064, 1914.1415425994983, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243, 2289.815730677076, 1928.7339844598832, 1794.442896760602, 1930.311061411739, 1538.6133979774231, 2306.0396648570636, 2077.4112588344847], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.995829774096035, "mean_processing_ms": 1.3324614294491977, "mean_inference_ms": 0.7010901472634073}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 762000, "timers": {"learn_time_ms": 4.484, "learn_throughput": 14272.181, "update_time_ms": 0.77}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -70.652099609375, "critic_loss": 0.014466574415564537, "mean_q": 70.58035278320312, "max_q": 98.47618103027344, "min_q": 36.60844802856445, "mean_td_error": -0.15432918071746826, "td_error": "[-0.15350342 -0.14028168 -0.14284515 -0.292305   -0.14666748 -0.13960266\n  0.04483032 -0.15390778 -0.25674438 -0.29971313 -0.19221878 -0.2135849\n -0.1160202  -0.13697815 -0.12561798 -0.19384766 -0.11808777 -0.170578\n -0.02019119 -0.0994873  -0.09633636 -0.08321381 -0.02632141 -0.19987106\n -0.25819397 -0.14916992 -0.10395432 -0.16446686 -0.1669693  -0.24465942\n -0.18843842 -0.24699402 -0.02968597 -0.25305176 -0.20992279 -0.17655945\n -0.11752319 -0.15003204 -0.15471649 -0.12342834 -0.18588638 -0.22969818\n -0.05085754 -0.13976288 -0.17738342 -0.18511963 -0.13113403 -0.0724411\n -0.03734207 -0.11409378 -0.26220703 -0.16973114 -0.13688278 -0.19548035\n -0.1374321  -0.21494293 -0.11302185 -0.15489197 -0.19512558 -0.15906525\n -0.15549469 -0.13076782 -0.11412048 -0.20332336]"}}, "num_steps_sampled": 762000, "num_steps_trained": 48576064, "last_target_update_ts": 762000, "num_target_updates": 759001}, "done": false, "episodes_total": 254, "training_iteration": 254, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-57-17", "timestamp": 1609829837, "time_this_iter_s": 57.05162525177002, "time_total_s": 13912.814854621887, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2c80>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 13912.814854621887, "timesteps_since_restore": 0, "iterations_since_restore": 254, "perf": {"cpu_util_percent": 15.081481481481482, "ram_util_percent": 38.4}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2018.8657294436512, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2670.081980073485, 1849.2993889388276, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243, 2289.815730677076, 1928.7339844598832, 1794.442896760602, 1930.311061411739, 1538.6133979774231, 2306.0396648570636, 2077.4112588344847, 1724.771018343064], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.996290428165439, "mean_processing_ms": 1.3325272340088035, "mean_inference_ms": 0.7012468016115068}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 765000, "timers": {"learn_time_ms": 4.541, "learn_throughput": 14092.95, "update_time_ms": 0.699}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -69.03120422363281, "critic_loss": 0.002661964390426874, "mean_q": 68.94624328613281, "max_q": 93.43228149414062, "min_q": 44.572349548339844, "mean_td_error": -0.007892370223999023, "td_error": "[-0.05036163  0.11265182 -0.0256424   0.07657623 -0.16745377 -0.057621\n -0.02072906 -0.06055832  0.00945663 -0.06762695 -0.01957703 -0.12317657\n  0.0112648   0.01815033  0.08246613 -0.00460052  0.02231598  0.09301376\n -0.02304077  0.0743103   0.03942871 -0.02287674  0.06629181 -0.02186203\n -0.08420181  0.00971222 -0.04808807 -0.04641724  0.02715302  0.03731537\n -0.10171509 -0.00733948  0.01620865 -0.09592438  0.05280304 -0.16579437\n -0.04689789 -0.04165268 -0.00580597 -0.033535   -0.05888748  0.01898575\n  0.13306046  0.03302002  0.05192566 -0.02962875  0.06684113 -0.05710602\n -0.02909088 -0.09729767 -0.09093094  0.03843689  0.07885742 -0.0625\n  0.07337952 -0.06774902  0.16662598 -0.0580368   0.015625    0.0632782\n -0.04639435 -0.05356598 -0.03607178  0.03549194]"}}, "num_steps_sampled": 765000, "num_steps_trained": 48768064, "last_target_update_ts": 765000, "num_target_updates": 762001}, "done": false, "episodes_total": 255, "training_iteration": 255, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-58-15", "timestamp": 1609829895, "time_this_iter_s": 57.85414528846741, "time_total_s": 13970.668999910355, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 13970.668999910355, "timesteps_since_restore": 0, "iterations_since_restore": 255, "perf": {"cpu_util_percent": 15.184337349397593, "ram_util_percent": 38.475903614457835}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2017.867349212487, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1749.4613658224064, 1466.7498285117438, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243, 2289.815730677076, 1928.7339844598832, 1794.442896760602, 1930.311061411739, 1538.6133979774231, 2306.0396648570636, 2077.4112588344847, 1724.771018343064, 2670.081980073485], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.996742109932265, "mean_processing_ms": 1.33259429014673, "mean_inference_ms": 0.7014045065679393}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 768000, "timers": {"learn_time_ms": 4.49, "learn_throughput": 14252.706, "update_time_ms": 0.82}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -74.44678497314453, "critic_loss": 0.022757576778531075, "mean_q": 74.34490966796875, "max_q": 98.52651977539062, "min_q": 44.611480712890625, "mean_td_error": 0.017763257026672363, "td_error": "[ 7.85217285e-02 -9.07897949e-03  8.56475830e-02  1.28326416e-02\n  5.34744263e-02  2.03971863e-01 -1.98211670e-02 -2.00500488e-02\n  9.13162231e-02  3.65638733e-02  4.45899963e-02  2.81524658e-03\n  4.51950073e-01  2.32067108e-01  5.18798828e-04  9.13848877e-02\n  7.96051025e-02  1.05316162e-01  8.40148926e-02  1.16859436e-01\n -7.20710754e-02  2.13912964e-01 -8.79974365e-02  1.42501831e-01\n -2.29568481e-02 -2.42996216e-02  6.60057068e-02 -1.09024048e-02\n  2.20718384e-02  1.18789673e-02 -9.54055786e-02  1.02020264e-01\n -4.34112549e-03  1.06422424e-01  1.15394592e-01 -1.51580811e-01\n -1.45553589e-01  3.98635864e-02 -8.31604004e-04  1.51969910e-01\n -1.11854553e-01 -5.90515137e-03 -3.48892212e-02  1.54190063e-02\n  1.02657318e-01 -1.36383057e-01  5.08270264e-02  1.21688843e-02\n -4.03366089e-02  2.40325928e-03  1.55212402e-01  8.93554688e-02\n -1.47222900e+00  1.32789612e-02  1.62811279e-02  4.17556763e-02\n  4.05273438e-02  6.93130493e-02  6.08444214e-02  2.73818970e-02\n  1.49433136e-01 -4.94041443e-02  8.01429749e-02 -1.77536011e-02]"}}, "num_steps_sampled": 768000, "num_steps_trained": 48960064, "last_target_update_ts": 768000, "num_target_updates": 765001}, "done": false, "episodes_total": 256, "training_iteration": 256, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_15-59-13", "timestamp": 1609829953, "time_this_iter_s": 57.444891691207886, "time_total_s": 14028.113891601562, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a22f0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 14028.113891601562, "timesteps_since_restore": 0, "iterations_since_restore": 256, "perf": {"cpu_util_percent": 16.39390243902439, "ram_util_percent": 38.5}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2029.8534510067395, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2665.3600079370267, 1638.3397662920434, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243, 2289.815730677076, 1928.7339844598832, 1794.442896760602, 1930.311061411739, 1538.6133979774231, 2306.0396648570636, 2077.4112588344847, 1724.771018343064, 2670.081980073485, 1749.4613658224064], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.997205388549276, "mean_processing_ms": 1.332663678603567, "mean_inference_ms": 0.7015633348669758}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 771000, "timers": {"learn_time_ms": 4.005, "learn_throughput": 15980.774, "update_time_ms": 0.738}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -76.23954772949219, "critic_loss": 0.0037995835300534964, "mean_q": 76.16077423095703, "max_q": 96.2618179321289, "min_q": 49.27735900878906, "mean_td_error": 0.00826406478881836, "td_error": "[-9.50622559e-03  5.59921265e-02 -1.76570892e-01 -9.41238403e-02\n -1.41983032e-02  7.66601562e-02  1.07658386e-01 -9.84191895e-03\n  2.64129639e-02  3.06320190e-02  1.38542175e-01 -7.24029541e-03\n  9.57870483e-02 -9.13696289e-02  1.98364258e-04  3.36990356e-02\n -3.00292969e-02  4.07867432e-02  6.71005249e-02 -8.04672241e-02\n  8.00399780e-02  2.03170776e-02  2.04658508e-01  1.36367798e-01\n  8.95385742e-02  1.97448730e-02  6.92749023e-03  8.58306885e-02\n -5.91583252e-02 -9.71412659e-02  3.10211182e-02 -1.12609863e-02\n  1.51138306e-02 -9.59892273e-02  1.67625427e-01 -4.78210449e-02\n  7.48748779e-02  1.01470947e-03  1.03736877e-01  6.89010620e-02\n -1.69067383e-02 -3.09829712e-02  1.83906555e-01 -4.58450317e-02\n -7.15408325e-02 -1.26689911e-01 -7.40242004e-02 -1.32812500e-01\n -3.79447937e-02  3.25622559e-02  1.75247192e-02  9.39331055e-02\n -7.35473633e-02  1.75323486e-02 -7.16705322e-02  1.29142761e-01\n  5.02471924e-02  4.85229492e-03 -2.31170654e-02 -8.20655823e-02\n -1.60583496e-01 -7.32154846e-02  6.85119629e-02 -2.83050537e-03]"}}, "num_steps_sampled": 771000, "num_steps_trained": 49152064, "last_target_update_ts": 771000, "num_target_updates": 768001}, "done": false, "episodes_total": 257, "training_iteration": 257, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_16-00-11", "timestamp": 1609830011, "time_this_iter_s": 58.49262475967407, "time_total_s": 14086.606516361237, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d9d8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 14086.606516361237, "timesteps_since_restore": 0, "iterations_since_restore": 257, "perf": {"cpu_util_percent": 16.353012048192774, "ram_util_percent": 38.5}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2034.54711216307, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2107.7058819250797, 2142.1859182439935, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243, 2289.815730677076, 1928.7339844598832, 1794.442896760602, 1930.311061411739, 1538.6133979774231, 2306.0396648570636, 2077.4112588344847, 1724.771018343064, 2670.081980073485, 1749.4613658224064, 2665.3600079370267], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.997666694490116, "mean_processing_ms": 1.332736823434758, "mean_inference_ms": 0.701720918317124}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 774000, "timers": {"learn_time_ms": 4.615, "learn_throughput": 13867.76, "update_time_ms": 0.753}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -74.69476318359375, "critic_loss": 0.0037902018520981073, "mean_q": 74.62881469726562, "max_q": 96.52571868896484, "min_q": 45.02143478393555, "mean_td_error": -0.05446314811706543, "td_error": "[-0.1555481  -0.07095337 -0.08399963 -0.10657501 -0.00444794 -0.03860474\n -0.04238129 -0.09015656 -0.09516144 -0.07651901 -0.12446594 -0.1647377\n  0.03343201 -0.08665466 -0.09711456 -0.08587265 -0.0921936  -0.03404999\n -0.10074234 -0.058815   -0.01197052 -0.14395142 -0.11662292 -0.08148956\n -0.03642273  0.03801727 -0.03974152  0.03282166 -0.17677307 -0.11080551\n -0.13471222 -0.01590729  0.04263306 -0.01443481  0.01853561 -0.10205841\n -0.01102448 -0.04688263  0.02519226  0.03697968  0.08383942 -0.10838699\n -0.10115814 -0.07403946 -0.05662918  0.00654221 -0.07848358 -0.06111908\n -0.17045593 -0.08074951 -0.05168152 -0.05148697  0.00501251  0.00060272\n -0.07142639  0.02895355 -0.11898422 -0.02145386 -0.0308609  -0.15502167\n  0.02110291  0.07691956  0.02119446 -0.07369232]"}}, "num_steps_sampled": 774000, "num_steps_trained": 49344064, "last_target_update_ts": 774000, "num_target_updates": 771001}, "done": false, "episodes_total": 258, "training_iteration": 258, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_16-01-08", "timestamp": 1609830068, "time_this_iter_s": 57.325146436691284, "time_total_s": 14143.931662797928, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54da60>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 14143.931662797928, "timesteps_since_restore": 0, "iterations_since_restore": 258, "perf": {"cpu_util_percent": 14.87439024390244, "ram_util_percent": 38.5219512195122}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2030.4274448677666, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1730.2191887136278, 2426.883193472711, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243, 2289.815730677076, 1928.7339844598832, 1794.442896760602, 1930.311061411739, 1538.6133979774231, 2306.0396648570636, 2077.4112588344847, 1724.771018343064, 2670.081980073485, 1749.4613658224064, 2665.3600079370267, 2107.7058819250797], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.998117375146198, "mean_processing_ms": 1.3328106282753682, "mean_inference_ms": 0.7018765458670374}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 777000, "timers": {"learn_time_ms": 4.255, "learn_throughput": 15042.446, "update_time_ms": 0.658}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -70.76749420166016, "critic_loss": 0.006202092859894037, "mean_q": 70.69697570800781, "max_q": 96.28833770751953, "min_q": 46.22175216674805, "mean_td_error": 0.05774205923080444, "td_error": "[ 0.0484314  -0.01101685  0.1405716   0.10169983 -0.04220581  0.13343048\n  0.03614044 -0.02479553  0.10436249 -0.01648712  0.01859283  0.07111359\n  0.11316299  0.083992    0.10145569  0.1354065  -0.02999878  0.09936523\n -0.01940918  0.22094727  0.15689468 -0.05473328 -0.0819397  -0.09138489\n  0.01217651 -0.00914001  0.04431915 -0.01807404  0.06304169  0.04406738\n -0.01778793  0.2496643   0.0651741   0.01354218  0.05139923 -0.08891296\n  0.00153732  0.03813171  0.07453156  0.04663849  0.14625931  0.15465546\n  0.05599213  0.11155701  0.22070312  0.2392044   0.17517853  0.01947403\n -0.05099106  0.07133484  0.00245285  0.06393433 -0.00747681  0.05316925\n  0.14897537 -0.01947021  0.05252838  0.42664337 -0.05834579  0.03658295\n  0.03948212  0.03431702  0.03417206 -0.01874542]"}}, "num_steps_sampled": 777000, "num_steps_trained": 49536064, "last_target_update_ts": 777000, "num_target_updates": 774001}, "done": false, "episodes_total": 259, "training_iteration": 259, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_16-02-06", "timestamp": 1609830126, "time_this_iter_s": 57.08110308647156, "time_total_s": 14201.0127658844, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54df28>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 14201.0127658844, "timesteps_since_restore": 0, "iterations_since_restore": 259, "perf": {"cpu_util_percent": 14.633333333333333, "ram_util_percent": 38.580246913580254}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2024.9851816748424, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1882.6568741802942, 2406.8580450935324, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243, 2289.815730677076, 1928.7339844598832, 1794.442896760602, 1930.311061411739, 1538.6133979774231, 2306.0396648570636, 2077.4112588344847, 1724.771018343064, 2670.081980073485, 1749.4613658224064, 2665.3600079370267, 2107.7058819250797, 1730.2191887136278], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.998553453446132, "mean_processing_ms": 1.3328859687258872, "mean_inference_ms": 0.7020306966498683}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 780000, "timers": {"learn_time_ms": 4.018, "learn_throughput": 15930.037, "update_time_ms": 0.737}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -71.40811920166016, "critic_loss": 0.002426401013508439, "mean_q": 71.33094787597656, "max_q": 96.3589859008789, "min_q": 50.171382904052734, "mean_td_error": -0.01145869493484497, "td_error": "[-0.02908707 -0.01541901  0.01314545 -0.0006752   0.06926727 -0.06908035\n -0.07308197  0.04083252  0.11568451 -0.01193237  0.12454224 -0.01501465\n  0.01643372 -0.01948547  0.03069305 -0.10676575 -0.0457077   0.02573395\n  0.01695251  0.04291534  0.03486252 -0.02168274 -0.04169464  0.0409317\n -0.07133865 -0.14009857 -0.0844574   0.08877563 -0.09934998 -0.03289032\n  0.02161026  0.05855179  0.04701233 -0.07697296 -0.13442993 -0.08122253\n -0.00651932 -0.09467316  0.00619125  0.05893707 -0.09514999 -0.02801514\n -0.07569122 -0.00350952  0.00074005 -0.0689621   0.0276413   0.02294159\n  0.00343323 -0.04346466  0.03190613  0.05643463  0.04464722 -0.00552368\n  0.02817535 -0.17650986 -0.00479507 -0.11612701  0.04854584 -0.0331955\n  0.0574646   0.06193924  0.0290451  -0.07682037]"}}, "num_steps_sampled": 780000, "num_steps_trained": 49728064, "last_target_update_ts": 780000, "num_target_updates": 777001}, "done": false, "episodes_total": 260, "training_iteration": 260, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_16-03-03", "timestamp": 1609830183, "time_this_iter_s": 57.79985857009888, "time_total_s": 14258.812624454498, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f048>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 14258.812624454498, "timesteps_since_restore": 0, "iterations_since_restore": 260, "perf": {"cpu_util_percent": 15.872289156626508, "ram_util_percent": 38.549397590361444}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2027.7779396684114, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2686.1338444504413, 1552.4010648935734, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243, 2289.815730677076, 1928.7339844598832, 1794.442896760602, 1930.311061411739, 1538.6133979774231, 2306.0396648570636, 2077.4112588344847, 1724.771018343064, 2670.081980073485, 1749.4613658224064, 2665.3600079370267, 2107.7058819250797, 1730.2191887136278, 1882.6568741802942], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.998979132151935, "mean_processing_ms": 1.3329592929892835, "mean_inference_ms": 0.7021833942104785}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 783000, "timers": {"learn_time_ms": 4.57, "learn_throughput": 14005.888, "update_time_ms": 0.751}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -71.6390609741211, "critic_loss": 0.004455380141735077, "mean_q": 71.5531997680664, "max_q": 97.48656463623047, "min_q": 48.47647476196289, "mean_td_error": -0.04341787099838257, "td_error": "[-0.12399292 -0.02820587 -0.01213074 -0.01757812 -0.16396332 -0.08613968\n  0.21986389 -0.07542419 -0.15644073 -0.12001038 -0.02152252 -0.07566833\n -0.0642395  -0.05807495  0.0171051  -0.14501953  0.01951599 -0.06278992\n -0.00268173 -0.07783508 -0.01156616 -0.09976578 -0.01741791  0.07061768\n -0.06334686 -0.00258255 -0.13964081 -0.10934448 -0.06246185  0.01460266\n -0.11595154 -0.07682037 -0.06382751 -0.00550842 -0.05208588  0.06542969\n -0.03067017  0.01515961 -0.08444977 -0.03980255 -0.03928375  0.11716843\n -0.16727448  0.10538483 -0.08194351 -0.0758667   0.07034302 -0.05744171\n -0.13197327 -0.05952454 -0.17172241 -0.08185196 -0.1199646   0.09541321\n -0.22998047  0.04595184 -0.07171631  0.02178192  0.05513382 -0.00976562\n  0.02203369 -0.11899948  0.00861359 -0.05859375]"}}, "num_steps_sampled": 783000, "num_steps_trained": 49920064, "last_target_update_ts": 783000, "num_target_updates": 780001}, "done": false, "episodes_total": 261, "training_iteration": 261, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_16-04-02", "timestamp": 1609830242, "time_this_iter_s": 58.19043207168579, "time_total_s": 14317.003056526184, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f840>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 14317.003056526184, "timesteps_since_restore": 0, "iterations_since_restore": 261, "perf": {"cpu_util_percent": 15.581927710843376, "ram_util_percent": 38.50481927710843}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2031.672930165335, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1941.9001145859506, 2052.365264778214, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243, 2289.815730677076, 1928.7339844598832, 1794.442896760602, 1930.311061411739, 1538.6133979774231, 2306.0396648570636, 2077.4112588344847, 1724.771018343064, 2670.081980073485, 1749.4613658224064, 2665.3600079370267, 2107.7058819250797, 1730.2191887136278, 1882.6568741802942, 2686.1338444504413], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.999402573892511, "mean_processing_ms": 1.333032208780941, "mean_inference_ms": 0.7023348553866293}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 786000, "timers": {"learn_time_ms": 3.668, "learn_throughput": 17448.095, "update_time_ms": 0.654}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -73.72428131103516, "critic_loss": 0.0068047018721699715, "mean_q": 73.62614440917969, "max_q": 97.41343688964844, "min_q": 49.52256774902344, "mean_td_error": -0.0750659704208374, "td_error": "[-0.07389832 -0.23285675 -0.10263824  0.05173874 -0.14891052 -0.0489502\n -0.08680725 -0.04975128 -0.11479187 -0.16938019  0.01716232 -0.03510284\n -0.02773666  0.02057648 -0.12389374  0.03990173 -0.11294556 -0.19681549\n -0.12870026 -0.0970192  -0.10452271 -0.06258392 -0.16792297 -0.03275299\n  0.07028961 -0.07925415 -0.11497498 -0.12288666 -0.00980377 -0.31776428\n -0.08404541 -0.18817139 -0.14685822 -0.03551102 -0.01846313 -0.02069092\n  0.0334053  -0.06386566  0.06112671 -0.17313385  0.02696609 -0.08123779\n -0.17000961 -0.06913757 -0.11617279 -0.12632751 -0.11463165 -0.14194489\n -0.03285599 -0.12631226  0.10048294 -0.10734558  0.02487183 -0.05393219\n  0.0726738  -0.08146667 -0.06320953 -0.12496948 -0.11215591 -0.0460434\n -0.02974701 -0.05275726 -0.2831955   0.10343933]"}}, "num_steps_sampled": 786000, "num_steps_trained": 50112064, "last_target_update_ts": 786000, "num_target_updates": 783001}, "done": false, "episodes_total": 262, "training_iteration": 262, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_16-04-59", "timestamp": 1609830299, "time_this_iter_s": 57.087868452072144, "time_total_s": 14374.090924978256, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004fea0>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 14374.090924978256, "timesteps_since_restore": 0, "iterations_since_restore": 262, "perf": {"cpu_util_percent": 15.562962962962965, "ram_util_percent": 38.592592592592595}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2034.4331706781138, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2328.389316056091, 1662.3163375378392, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243, 2289.815730677076, 1928.7339844598832, 1794.442896760602, 1930.311061411739, 1538.6133979774231, 2306.0396648570636, 2077.4112588344847, 1724.771018343064, 2670.081980073485, 1749.4613658224064, 2665.3600079370267, 2107.7058819250797, 1730.2191887136278, 1882.6568741802942, 2686.1338444504413, 1941.9001145859506], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 5.99982292913732, "mean_processing_ms": 1.3331042998569924, "mean_inference_ms": 0.7024853994367265}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 789000, "timers": {"learn_time_ms": 3.993, "learn_throughput": 16026.476, "update_time_ms": 0.724}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -70.26303100585938, "critic_loss": 0.01373552531003952, "mean_q": 70.1933364868164, "max_q": 97.70838928222656, "min_q": 39.17036437988281, "mean_td_error": -0.13624072074890137, "td_error": "[-0.07974243 -0.02571106 -0.16618347 -0.24262238 -0.11522293 -0.00042725\n -0.08847809 -0.22839355 -0.04808426 -0.09687042 -0.16197968 -0.11026764\n -0.02338791 -0.00357056 -0.16233063 -0.26717377 -0.20515442 -0.04903412\n -0.06541443 -0.19604492 -0.21403503 -0.0171814  -0.3021736  -0.17884827\n -0.3035965   0.2019577  -0.1232872  -0.02549362 -0.23220825 -0.12256622\n -0.22866821 -0.13196945 -0.31261444 -0.19052887 -0.12876129 -0.24195099\n -0.12353897 -0.19960785 -0.11430359 -0.18049622 -0.06074905 -0.10630798\n -0.17856598 -0.21811676 -0.15395737 -0.13343811 -0.1693039  -0.12688446\n -0.10823059 -0.13642502 -0.17345428 -0.07134628 -0.18120575  0.09404755\n -0.15786362 -0.01729584 -0.15867996 -0.15468597 -0.22219086 -0.14915848\n -0.18323135 -0.20560074 -0.0870018  -0.15379333]"}}, "num_steps_sampled": 789000, "num_steps_trained": 50304064, "last_target_update_ts": 789000, "num_target_updates": 786001}, "done": false, "episodes_total": 263, "training_iteration": 263, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_16-05-56", "timestamp": 1609830356, "time_this_iter_s": 57.12064719200134, "time_total_s": 14431.211572170258, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff60004f7b8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 14431.211572170258, "timesteps_since_restore": 0, "iterations_since_restore": 263, "perf": {"cpu_util_percent": 14.571951219512194, "ram_util_percent": 38.21951219512194}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2044.1944851034632, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2638.4477800727504, 2425.8755853401203, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243, 2289.815730677076, 1928.7339844598832, 1794.442896760602, 1930.311061411739, 1538.6133979774231, 2306.0396648570636, 2077.4112588344847, 1724.771018343064, 2670.081980073485, 1749.4613658224064, 2665.3600079370267, 2107.7058819250797, 1730.2191887136278, 1882.6568741802942, 2686.1338444504413, 1941.9001145859506, 2328.389316056091], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 6.000245293899485, "mean_processing_ms": 1.333176525967069, "mean_inference_ms": 0.7026342557686673}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 792000, "timers": {"learn_time_ms": 4.131, "learn_throughput": 15493.484, "update_time_ms": 0.709}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -70.58719635009766, "critic_loss": 0.003185580251738429, "mean_q": 70.50182342529297, "max_q": 96.99063110351562, "min_q": 36.985816955566406, "mean_td_error": 0.028174877166748047, "td_error": "[ 0.1698761  -0.0623436   0.13428497 -0.04294968  0.00732422  0.00371552\n -0.02430725  0.01555634 -0.05895996 -0.08475494 -0.01539612 -0.06161118\n  0.01139069 -0.02518463  0.06274414 -0.01186371  0.2813797   0.11200714\n  0.07592773  0.01597595  0.03935242  0.02542114  0.04277039 -0.00203705\n  0.03856277  0.00479507  0.12654114  0.04123688  0.11236572 -0.02033234\n -0.04624939  0.02150726 -0.03038788 -0.06784821  0.025177   -0.04825211\n  0.06245041  0.06481171  0.0248642   0.04100418  0.03056717 -0.09217834\n  0.0217514   0.05102539  0.08332825  0.06110001  0.03408051  0.04557037\n -0.09593582 -0.02332306  0.15657043  0.00249481  0.14988708  0.09387589\n -0.00379944  0.0562973   0.0255127   0.06302643  0.05252838  0.0710144\n -0.04910278  0.04511261  0.12439728 -0.05917358]"}}, "num_steps_sampled": 792000, "num_steps_trained": 50496064, "last_target_update_ts": 792000, "num_target_updates": 789001}, "done": false, "episodes_total": 264, "training_iteration": 264, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_16-06-54", "timestamp": 1609830414, "time_this_iter_s": 57.98645901679993, "time_total_s": 14489.198031187057, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d268>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 14489.198031187057, "timesteps_since_restore": 0, "iterations_since_restore": 264, "perf": {"cpu_util_percent": 16.21325301204819, "ram_util_percent": 38.52048192771084}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2038.3688436486475, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1843.31143985858, 1450.5764847050748, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243, 2289.815730677076, 1928.7339844598832, 1794.442896760602, 1930.311061411739, 1538.6133979774231, 2306.0396648570636, 2077.4112588344847, 1724.771018343064, 2670.081980073485, 1749.4613658224064, 2665.3600079370267, 2107.7058819250797, 1730.2191887136278, 1882.6568741802942, 2686.1338444504413, 1941.9001145859506, 2328.389316056091, 2638.4477800727504], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 6.000656942733801, "mean_processing_ms": 1.3332471836782596, "mean_inference_ms": 0.7027828960361181}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 795000, "timers": {"learn_time_ms": 4.469, "learn_throughput": 14320.376, "update_time_ms": 0.796}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -72.76519012451172, "critic_loss": 0.012894881889224052, "mean_q": 72.70271301269531, "max_q": 96.36357879638672, "min_q": 44.364959716796875, "mean_td_error": -0.021884918212890625, "td_error": "[ 2.4429321e-02  4.3319702e-02 -1.6487122e-02 -1.1294594e+00\n -3.8818359e-02 -2.7194977e-02  5.8517456e-03 -7.6282501e-02\n  2.9960632e-02 -1.9332886e-02  3.3585358e-01 -6.6436768e-02\n  1.7084503e-01  8.3892822e-02  4.5356750e-02 -1.0612488e-02\n  6.3865662e-02  3.8833618e-03 -5.9692383e-02 -5.3653717e-02\n  5.8494568e-02 -4.5394897e-02  7.0533752e-02 -2.0374298e-02\n  1.4732361e-02 -8.4312439e-02  1.9302368e-03  4.6100616e-02\n -6.7672729e-03  2.0523071e-03  5.2833557e-02  7.5531006e-04\n  7.2135925e-02 -3.9150238e-02 -5.8959961e-02  3.1997681e-02\n -6.3880920e-02  1.3504028e-02 -4.7306061e-02 -5.8975220e-02\n -6.3606262e-02 -1.0077667e-01  3.1700134e-03 -4.4609070e-02\n  4.6119690e-02  7.3722839e-02  1.1203766e-02 -9.9182129e-03\n -1.3735199e-01 -9.0965271e-02 -6.4109802e-02 -1.9172668e-02\n -3.6010742e-03 -9.8876953e-03 -8.5674286e-02  9.8377228e-02\n -7.4745178e-02 -5.5946350e-02 -1.0292816e-01  5.0788879e-02\n  2.1194458e-02  1.8310547e-03  1.3732910e-03 -9.4360352e-02]"}}, "num_steps_sampled": 795000, "num_steps_trained": 50688064, "last_target_update_ts": 795000, "num_target_updates": 792001}, "done": false, "episodes_total": 265, "training_iteration": 265, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_16-07-52", "timestamp": 1609830472, "time_this_iter_s": 57.6275749206543, "time_total_s": 14546.825606107712, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54d730>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 14546.825606107712, "timesteps_since_restore": 0, "iterations_since_restore": 265, "perf": {"cpu_util_percent": 16.01707317073171, "ram_util_percent": 38.767073170731706}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2040.6806269927836, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1681.7548191186618, 2012.5532326210455, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243, 2289.815730677076, 1928.7339844598832, 1794.442896760602, 1930.311061411739, 1538.6133979774231, 2306.0396648570636, 2077.4112588344847, 1724.771018343064, 2670.081980073485, 1749.4613658224064, 2665.3600079370267, 2107.7058819250797, 1730.2191887136278, 1882.6568741802942, 2686.1338444504413, 1941.9001145859506, 2328.389316056091, 2638.4477800727504, 1843.31143985858], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 6.001063942036926, "mean_processing_ms": 1.333318362300698, "mean_inference_ms": 0.7029302495232499}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 798000, "timers": {"learn_time_ms": 4.181, "learn_throughput": 15308.465, "update_time_ms": 0.774}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -73.88477325439453, "critic_loss": 0.005201377905905247, "mean_q": 73.83100891113281, "max_q": 95.77071380615234, "min_q": 48.42769241333008, "mean_td_error": 0.05619746446609497, "td_error": "[ 0.03125381 -0.0426712   0.12065125 -0.00198364  0.05513763  0.06386185\n  0.20713806  0.06604004 -0.0594101   0.08094406  0.07925415 -0.03069305\n -0.00374603  0.1065979   0.18036652  0.01229095  0.09022522 -0.05088043\n  0.06243896  0.12267303 -0.03995514  0.01789093  0.06973267 -0.05767059\n -0.0103302  -0.07171631  0.0304184   0.11499786  0.07538605 -0.06038666\n  0.11289978  0.13925171  0.25083923  0.00824738  0.11420441  0.11942291\n  0.18006134  0.04499054  0.0290451   0.08895874  0.06440735  0.10887909\n -0.01110458  0.04974365  0.12617493  0.0770874   0.04987335 -0.00482941\n  0.02166748 -0.01184845  0.13287354  0.23186493  0.05184937 -0.03263855\n  0.03984833  0.08755493 -0.00805283 -0.08895111  0.24783325 -0.04690552\n  0.21588898  0.02350616  0.05233765 -0.02619934]"}}, "num_steps_sampled": 798000, "num_steps_trained": 50880064, "last_target_update_ts": 798000, "num_target_updates": 795001}, "done": false, "episodes_total": 266, "training_iteration": 266, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_16-08-49", "timestamp": 1609830529, "time_this_iter_s": 57.46885085105896, "time_total_s": 14604.29445695877, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc54db70>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 14604.29445695877, "timesteps_since_restore": 0, "iterations_since_restore": 266, "perf": {"cpu_util_percent": 16.092682926829266, "ram_util_percent": 38.296341463414635}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2044.1868848924653, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2363.179022589227, 1910.1732615954527, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243, 2289.815730677076, 1928.7339844598832, 1794.442896760602, 1930.311061411739, 1538.6133979774231, 2306.0396648570636, 2077.4112588344847, 1724.771018343064, 2670.081980073485, 1749.4613658224064, 2665.3600079370267, 2107.7058819250797, 1730.2191887136278, 1882.6568741802942, 2686.1338444504413, 1941.9001145859506, 2328.389316056091, 2638.4477800727504, 1843.31143985858, 1681.7548191186618], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 6.0014682131975965, "mean_processing_ms": 1.3333878567950734, "mean_inference_ms": 0.7030772996165072}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 801000, "timers": {"learn_time_ms": 4.359, "learn_throughput": 14680.718, "update_time_ms": 0.81}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -73.68806457519531, "critic_loss": 0.0030121016316115856, "mean_q": 73.60885620117188, "max_q": 94.78800964355469, "min_q": 55.09859848022461, "mean_td_error": 0.007430732250213623, "td_error": "[ 0.08679962 -0.01239777  0.0594101   0.13886261 -0.07624054  0.04174042\n  0.04405212 -0.0293808  -0.13968658 -0.0175705   0.06730652 -0.02494049\n -0.00281906  0.02098083  0.10207748  0.09493256  0.04812622 -0.10393524\n -0.00685883 -0.04156494 -0.10462189  0.01410675 -0.05531311  0.12215424\n  0.01383972 -0.00810242  0.0335083  -0.02803421  0.00047302  0.00421143\n -0.04434204  0.03079987 -0.00951385 -0.07276917  0.05164337  0.01356888\n  0.04328918  0.11508179 -0.08388138  0.03439331  0.01805115  0.0977478\n  0.00465393 -0.03257751 -0.00141525 -0.16118622 -0.02642822  0.06943512\n -0.03646851  0.00363159 -0.09629822 -0.01642609  0.03717041  0.0852356\n -0.06856155 -0.04769135 -0.09036255  0.11532593  0.15210724  0.07753754\n  0.01301575 -0.10221863  0.19819641 -0.03629303]"}}, "num_steps_sampled": 801000, "num_steps_trained": 51072064, "last_target_update_ts": 801000, "num_target_updates": 798001}, "done": false, "episodes_total": 267, "training_iteration": 267, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_16-09-47", "timestamp": 1609830587, "time_this_iter_s": 58.236467123031616, "time_total_s": 14662.530924081802, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a29d8>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 14662.530924081802, "timesteps_since_restore": 0, "iterations_since_restore": 267, "perf": {"cpu_util_percent": 16.50722891566265, "ram_util_percent": 38.7421686746988}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2766.57491761004, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2050.157890490126, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2507.273821361547, 1580.2618559804143, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243, 2289.815730677076, 1928.7339844598832, 1794.442896760602, 1930.311061411739, 1538.6133979774231, 2306.0396648570636, 2077.4112588344847, 1724.771018343064, 2670.081980073485, 1749.4613658224064, 2665.3600079370267, 2107.7058819250797, 1730.2191887136278, 1882.6568741802942, 2686.1338444504413, 1941.9001145859506, 2328.389316056091, 2638.4477800727504, 1843.31143985858, 1681.7548191186618, 2363.179022589227], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 6.001869565206764, "mean_processing_ms": 1.3334566056955968, "mean_inference_ms": 0.7032235980364503}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 804000, "timers": {"learn_time_ms": 4.722, "learn_throughput": 13554.471, "update_time_ms": 0.747}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -71.20449829101562, "critic_loss": 0.003388661425560713, "mean_q": 71.11736297607422, "max_q": 96.48754119873047, "min_q": 44.651798248291016, "mean_td_error": 0.033866941928863525, "td_error": "[-0.00501251 -0.05331421 -0.03285217 -0.00202942 -0.08131409  0.14403534\n  0.17180252  0.01577377 -0.07439423  0.07276917  0.06472015  0.14868927\n  0.1054306   0.04906464  0.00237656  0.00521088  0.09101105 -0.00754547\n  0.24754333  0.07944107  0.08233643  0.03425217 -0.04608154  0.04009247\n -0.01967621 -0.02309799  0.05622101 -0.0769043  -0.04341888  0.08122253\n  0.06957245  0.05028534  0.13574982 -0.04273224  0.02349854  0.0067215\n  0.05032349  0.0118866   0.06163025 -0.03287125  0.06415558  0.09654236\n  0.01908875  0.2640381   0.03357697 -0.01448441 -0.00687408  0.05638123\n  0.06310272  0.01296616  0.01597595  0.06299591  0.02850342 -0.03096008\n -0.01037979  0.08100128 -0.06472015  0.11750031  0.03293228  0.04148865\n  0.02619171  0.01112747 -0.06672287 -0.02635956]"}}, "num_steps_sampled": 804000, "num_steps_trained": 51264064, "last_target_update_ts": 804000, "num_target_updates": 801001}, "done": false, "episodes_total": 268, "training_iteration": 268, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_16-10-45", "timestamp": 1609830645, "time_this_iter_s": 57.94188737869263, "time_total_s": 14720.472811460495, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2400>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 14720.472811460495, "timesteps_since_restore": 0, "iterations_since_restore": 268, "perf": {"cpu_util_percent": 15.644578313253016, "ram_util_percent": 38.50240963855422}, "trial_id": "d6219_00000", "experiment_tag": "0"}
{"episode_reward_max": 2815.2377601000157, "episode_reward_min": 1118.2917597820328, "episode_reward_mean": 2062.507649531322, "episode_len_mean": 3000.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2815.2377601000157, 2700.595681591929, 1763.3269543125884, 1597.1415633550193, 1374.8410070935004, 1501.5094897592573, 1986.5605848747514, 2174.9380644644257, 2158.1352681857556, 1412.7117847248792, 2380.6774802743266, 1767.7945126588838, 2239.8981123878475, 1583.0536355639692, 1294.6606296259556, 1334.685540059263, 1982.56769474058, 2366.4893526065944, 2624.0242537882987, 1497.9460173867494, 2153.691893154037, 1501.3811986451758, 2150.9491000131643, 2624.737192013852, 2167.8869318002257, 2606.7006939597627, 2289.101535873718, 2148.8503807540537, 1640.1077027257454, 2298.2805747324824, 1930.00691004212, 2642.7212660860387, 1698.3393396429403, 2139.399592575111, 2192.6125133165697, 2719.1968736108493, 1881.7208906582616, 1118.2917597820328, 1874.84077017914, 2726.602781874578, 2682.955825751686, 2051.0605699124058, 1786.9395076166045, 1892.096824756025, 2432.639672812784, 2581.8882209391063, 2766.57491761004, 2655.1766976199006, 2529.8961750979374, 1516.0925849057278, 2351.8519662577087, 2083.805555709208, 2341.387297971071, 2200.8498764079895, 1723.025561856211, 1474.367807167513, 2078.543106742795, 1917.6833899104238, 1893.3011098458885, 1651.4468000143213, 1724.7492534363578, 2464.1574425603785, 1510.173811351318, 1607.226004100511, 2472.619738909729, 1919.2575560394316, 2029.7820332621882, 1743.0927535759215, 2026.3101418586573, 1774.8896040099157, 2743.4673782214154, 1846.1780016192542, 2407.524058869236, 1569.7028291943654, 2156.7181651851515, 2673.3092750322994, 1598.893968019466, 1922.8997099203243, 2289.815730677076, 1928.7339844598832, 1794.442896760602, 1930.311061411739, 1538.6133979774231, 2306.0396648570636, 2077.4112588344847, 1724.771018343064, 2670.081980073485, 1749.4613658224064, 2665.3600079370267, 2107.7058819250797, 1730.2191887136278, 1882.6568741802942, 2686.1338444504413, 1941.9001145859506, 2328.389316056091, 2638.4477800727504, 1843.31143985858, 1681.7548191186618, 2363.179022589227, 2507.273821361547], "episode_lengths": [3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000, 3000]}, "sampler_perf": {"mean_env_wait_ms": 6.002281083448233, "mean_processing_ms": 1.3335250861684924, "mean_inference_ms": 0.7033694603893136}, "off_policy_estimator": {}, "num_healthy_workers": 1, "timesteps_total": 807000, "timers": {"learn_time_ms": 4.188, "learn_throughput": 15280.753, "update_time_ms": 0.699}, "info": {"learner": {"default_policy": {"allreduce_latency": 0.0, "actor_loss": -74.26912689208984, "critic_loss": 0.005155645776540041, "mean_q": 74.20487976074219, "max_q": 97.47303771972656, "min_q": 46.2241096496582, "mean_td_error": 0.058801233768463135, "td_error": "[ 0.05610657  0.23099518  0.10413361  0.050354    0.16218567 -0.09273529\n  0.10145569 -0.02239227 -0.07933044  0.06053925  0.07671356 -0.00767899\n  0.15909576  0.15938568  0.0195694   0.00917053 -0.0444603   0.05419159\n -0.01303864  0.07791138 -0.01424408  0.07189178  0.14492798  0.01235199\n -0.01136017  0.06175995 -0.02531815 -0.05223846  0.16324615  0.05225372\n  0.02701569  0.11790848  0.02833557 -0.0869751   0.05808258  0.1317749\n  0.02811432  0.06488037  0.10732269  0.09346008  0.04290771  0.11114502\n -0.04323578  0.00089645  0.19760895  0.19199371  0.10846329  0.01035309\n  0.05285645  0.06227112  0.15763474  0.09519958  0.1701088   0.01966095\n  0.00229645  0.18749237  0.04969025  0.17777252  0.08171082  0.08657837\n -0.00174332 -0.14403152  0.08086014  0.02942657]"}}, "num_steps_sampled": 807000, "num_steps_trained": 51456064, "last_target_update_ts": 807000, "num_target_updates": 804001}, "done": false, "episodes_total": 269, "training_iteration": 269, "experiment_id": "a1ded11281c34667bd152acacddf4e10", "date": "2021-01-05_16-11-43", "timestamp": 1609830703, "time_this_iter_s": 57.83620095252991, "time_total_s": 14778.309012413025, "pid": 3463, "hostname": "bmil-X570-AORUS-ELITE-WIFI", "node_ip": "220.149.82.56", "config": {"num_workers": 1, "num_envs_per_worker": 1, "rollout_fragment_length": 1, "sample_batch_size": -1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 64, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "custom_options": -1}, "optimizer": {}, "gamma": 0.99, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"ring_length\": [\n                220,\n                270\n            ]\n        },\n        \"clip_actions\": false,\n        \"evaluate\": true,\n        \"horizon\": 3000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 750\n    },\n    \"env_name\": \"flow.envs.ring.wave_attenuation.WaveAttenuationPOEnv\",\n    \"exp_tag\": \"singleagent_ring\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"lanes\": 1,\n            \"length\": 260,\n            \"resolution\": 40,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.ring.RingNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": null,\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {\n                    \"noise\": 0.2\n                }\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 0,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 21,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "WaveAttenuationPOEnv-v0", "normalize_actions": false, "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": "<function Trainer.merge_trainer_configs.<locals>.make_callbacks at 0x7ff5dc5a2d08>", "ignore_worker_failures": false, "log_sys_usage": true, "fake_sampler": false, "framework": "torch", "eager_tracing": false, "no_eager_on_workers": false, "explore": true, "exploration_config": {"type": "OrnsteinUhlenbeckNoise", "random_timesteps": 1000, "ou_base_scale": 0.1, "ou_theta": 0.15, "ou_sigma": 0.2, "initial_scale": 1.0, "final_scale": 0.05, "scale_timesteps": 1500000}, "evaluation_interval": null, "evaluation_num_episodes": 10, "in_evaluation": false, "evaluation_config": {"explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "_use_trajectory_view_api": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 3000, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent"}, "replay_sequence_length": 1, "use_pytorch": -1, "eager": -1, "twin_q": false, "policy_delay": 1, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "buffer_size": 300000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "prioritized_replay_beta_annealing_timesteps": 20000, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "training_intensity": null, "critic_lr": 0.0001, "actor_lr": 0.0001, "target_network_update_freq": 0, "tau": 0.001, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_clip": null, "learning_starts": 3000, "worker_side_prioritization": false, "grad_norm_clipping": -1}, "time_since_restore": 14778.309012413025, "timesteps_since_restore": 0, "iterations_since_restore": 269, "perf": {"cpu_util_percent": 16.0109756097561, "ram_util_percent": 38.670731707317074}, "trial_id": "d6219_00000", "experiment_tag": "0"}
